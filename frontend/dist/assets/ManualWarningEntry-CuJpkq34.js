const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/business-owner-dashboard-oCuuJgk5.js","assets/pdf-vendor-CbrIsI36.js","assets/react-vendor-BMk1H4su.js","assets/firebase-vendor-BIBOIkWK.js","assets/ui-vendor-DjDr2yFV.js"])))=>i.map(i=>d[i]);
import{a as e}from"./pdf-vendor-CbrIsI36.js";import{j as a,f as r,L as t,T as s,y as i,v as l}from"./business-owner-dashboard-oCuuJgk5.js";import{r as n}from"./react-vendor-BMk1H4su.js";import{U as d}from"./dashboard-router-DThNUfZj.js";import{T as o,S as c,F as x,h as m,X as g,i as h,af as y,C as u,n as p,c as b,aY as j,p as f,ah as v,aO as N}from"./ui-vendor-DjDr2yFV.js";import{C as k}from"./CustomDatePicker-BW2gU2AG.js";import"./firebase-vendor-BIBOIkWK.js";import"./hr-dashboard-Cw3YGy6A.js";import"./hod-dashboard-BeQAtva5.js";const w=({physicalCopyLocation:e,className:t=""})=>a.jsx(r,{className:`bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-500 ${t}`,children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-amber-500 flex items-center justify-center",children:a.jsx(o,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-base font-semibold text-amber-900 dark:text-amber-100",children:"⚠️ IMPORTANT: Physical Copy Required"}),a.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 mt-1",children:"This warning was entered manually from a physical document"})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-amber-300 dark:border-amber-700",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"The system does NOT have:"}),a.jsxs("ul",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),a.jsx("span",{children:"Digital signatures from manager and employee"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),a.jsx("span",{children:"Audio recording of the disciplinary meeting"})]}),a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),a.jsx("span",{children:"PDF document with QR code verification"})]})]})]}),a.jsxs("div",{className:"bg-amber-100 dark:bg-amber-900/40 rounded-lg p-4 border border-amber-400 dark:border-amber-600",children:[a.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[a.jsx(c,{className:"w-5 h-5 text-amber-700 dark:text-amber-300 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm font-semibold text-amber-900 dark:text-amber-100",children:"Legal Compliance Requirement:"})]}),a.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200 ml-7",children:["You ",a.jsx("strong",{children:"MUST"})," keep the original signed physical document safe and accessible for potential legal proceedings or CCMA hearings. This digital record is supplementary only."]})]}),e&&a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-amber-300 dark:border-amber-700",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(x,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:"Physical Copy Location:"}),a.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 font-mono bg-gray-50 dark:bg-gray-900 px-3 py-2 rounded border border-gray-200 dark:border-gray-700",children:e})]})]})}),a.jsx("div",{className:"text-xs text-amber-700 dark:text-amber-300 italic border-t border-amber-300 dark:border-amber-700 pt-3",children:a.jsxs("p",{children:[a.jsx("strong",{children:"Note:"})," Historical entries are fully integrated with the escalation system and will count toward the employee's progressive discipline record."]})})]})}),C=["Select Employee & Category","Enter Dates & Details","Physical Copy Confirmation","Review & Save"],D={counselling:"Counselling Session",verbal:"Verbal Warning",first_written:"Written Warning",second_written:"Second Written Warning",final_written:"Final Written Warning"},P=({isOpen:c,onClose:P,onSuccess:I,employees:S,categories:L,preSelectedEmployeeId:T,currentUserId:V,organizationId:W})=>{const[E,O]=n.useState(0),[A,M]=n.useState(!1),[_,R]=n.useState(null),[q,F]=n.useState({employeeId:T||"",categoryId:"",level:"",incidentDate:null,incidentTime:"09:00",issueDate:null,expiryDate:null,validityPeriod:6,title:"",description:"",incidentLocation:"",additionalNotes:"",hasPhysicalCopy:!1,physicalCopyLocation:"",historicalNotes:""}),H=n.useMemo(()=>S.find(e=>e.id===q.employeeId),[S,q.employeeId]),z=n.useMemo(()=>L.find(e=>e.id===q.categoryId),[L,q.categoryId]),B=n.useMemo(()=>z?.escalationPath?z.escalationPath:["counselling","verbal","first_written","second_written","final_written"],[z]),U=n.useCallback((e,a)=>{if(!e)return null;const r=new Date(e);return r.setMonth(r.getMonth()+a),r},[]),Y=n.useCallback((e,a)=>{F(r=>{const t={...r,[e]:a};if("issueDate"===e||"validityPeriod"===e){const s="issueDate"===e?a:r.issueDate,i="validityPeriod"===e?a:r.validityPeriod;t.expiryDate=U(s,i)}return t})},[U]),Q=n.useCallback(e=>{switch(e){case 0:return q.employeeId?q.categoryId?q.level?{isValid:!0}:{isValid:!1,error:"Please select a warning level"}:{isValid:!1,error:"Please select a category"}:{isValid:!1,error:"Please select an employee"};case 1:return q.incidentDate?q.issueDate?q.title.trim()?q.description.trim()?q.incidentLocation.trim()?q.issueDate>new Date?{isValid:!1,error:"Issue date cannot be in the future"}:q.expiryDate&&q.expiryDate<=q.issueDate?{isValid:!1,error:"Expiry date must be after issue date"}:{isValid:!0}:{isValid:!1,error:"Please enter incident location"}:{isValid:!1,error:"Please enter incident description"}:{isValid:!1,error:"Please enter a warning title"}:{isValid:!1,error:"Please enter issue date"}:{isValid:!1,error:"Please enter incident date"};case 2:return q.hasPhysicalCopy?{isValid:!0}:{isValid:!1,error:"You must confirm that a physical signed copy exists"};case 3:return{isValid:!0};default:return{isValid:!1}}},[q]),$=n.useCallback(()=>{const e=Q(E);e.isValid?(R(null),O(e=>Math.min(e+1,3))):R(e.error||"Please complete all required fields")},[E,Q]),G=n.useCallback(()=>{R(null),O(e=>Math.max(e-1,0))},[]),J=n.useCallback(async()=>{const a=Q(2);if(a.isValid){M(!0),R(null);try{const{ShardedDataService:a}=await e(async()=>{const{ShardedDataService:e}=await import("./business-owner-dashboard-oCuuJgk5.js").then(e=>e.H);return{ShardedDataService:e}},__vite__mapDeps([0,1,2,3,4])),r={employeeId:q.employeeId,categoryId:q.categoryId,level:q.level,incidentDate:q.incidentDate,incidentTime:q.incidentTime,issueDate:q.issueDate,expiryDate:q.expiryDate,validityPeriod:q.validityPeriod,title:q.title,description:q.description,incidentLocation:q.incidentLocation,additionalNotes:q.additionalNotes,isHistoricalEntry:!0,hasPhysicalCopy:q.hasPhysicalCopy,physicalCopyLocation:q.physicalCopyLocation,historicalNotes:q.historicalNotes,enteredBy:V,enteredAt:new Date,issuedBy:V,status:"issued",isActive:!0,deliveryStatus:"delivered",followUpActions:[]};await a.createWarning(r,W),I(),P()}catch(r){t.error("Error creating historical warning:",r),R(r instanceof Error?r.message:"Failed to create warning")}finally{M(!1)}}else R(a.error||"Please complete all required fields")},[q,V,W,I,P,Q]),K=n.useCallback(()=>{A||(O(0),R(null),F({employeeId:T||"",categoryId:"",level:"",incidentDate:null,incidentTime:"09:00",issueDate:null,expiryDate:null,validityPeriod:6,title:"",description:"",incidentLocation:"",additionalNotes:"",hasPhysicalCopy:!1,physicalCopyLocation:"",historicalNotes:""}),P())},[A,P,T]);return a.jsxs(d,{isOpen:c,onClose:K,title:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-amber-100 to-amber-50 dark:from-amber-900/40 dark:to-amber-900/20 flex items-center justify-center shadow-sm",children:a.jsx(x,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"Manual Warning Entry"}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:C[E]})]})]}),size:"lg",children:[a.jsx("div",{className:"flex items-center justify-between mb-4 px-4",children:[0,1,2,3].map(e=>a.jsxs("div",{className:"flex items-center flex-1",children:[a.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-xs font-semibold transition-all duration-200\n                "+(e<=E?"bg-blue-600 text-white shadow-sm":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400"),children:e<E?a.jsx(m,{className:"w-3.5 h-3.5"}):e+1}),e<3&&a.jsx("div",{className:"flex-1 h-0.5 mx-2 transition-all duration-200\n                  "+(e<E?"bg-blue-600":"bg-gray-200 dark:bg-gray-700")})]},e))}),_&&a.jsx("div",{className:"mb-4 px-4",children:a.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg p-3 flex items-start gap-2",children:[a.jsx(o,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:_})]})}),a.jsx("div",{className:"px-4 pb-4 max-h-[calc(100vh-300px)] overflow-y-auto",children:(()=>{switch(E){case 0:return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(l,{icon:v,title:"Select Employee",subtitle:"Choose the employee who received this warning"}),a.jsxs("select",{value:q.employeeId,onChange:e=>Y("employeeId",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[a.jsx("option",{value:"",children:"Select an employee..."}),S.map(e=>a.jsxs("option",{value:e.id,children:[e.profile.firstName," ",e.profile.lastName," (",e.profile.employeeNumber,")"]},e.id))]})]}),a.jsxs("div",{children:[a.jsx(l,{icon:N,title:"Select Category",subtitle:"Choose the violation category"}),a.jsxs("select",{value:q.categoryId,onChange:e=>Y("categoryId",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[a.jsx("option",{value:"",children:"Select a category..."}),L.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),q.categoryId&&a.jsxs("div",{children:[a.jsx(l,{icon:o,title:"Warning Level",subtitle:"Select the severity level given in the original warning"}),a.jsxs("select",{value:q.level,onChange:e=>Y("level",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[a.jsx("option",{value:"",children:"Select warning level..."}),B.map(e=>a.jsx("option",{value:e,children:D[e]||e},e))]})]})]});case 1:return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(k,{label:"Incident Date",value:q.incidentDate?q.incidentDate.toISOString().split("T")[0]:"",onChange:e=>Y("incidentDate",e?new Date(e):null),icon:p,required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When did the incident occur?"})]}),a.jsx(i,{icon:b,label:"Incident Time",type:"time",value:q.incidentTime,onChange:e=>Y("incidentTime",e)}),a.jsxs("div",{children:[a.jsx(k,{label:"Issue Date",value:q.issueDate?q.issueDate.toISOString().split("T")[0]:"",onChange:e=>Y("issueDate",e?new Date(e):null),icon:j,required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When was the warning issued?"})]}),a.jsxs("div",{children:[a.jsx(l,{icon:b,title:"Validity Period",subtitle:"How long is this warning active?"}),a.jsxs("select",{value:q.validityPeriod,onChange:e=>Y("validityPeriod",parseInt(e.target.value)),className:"w-full h-11 px-4 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent",children:[a.jsx("option",{value:3,children:"3 months"}),a.jsx("option",{value:6,children:"6 months"}),a.jsx("option",{value:12,children:"12 months"})]}),q.expiryDate&&a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Will expire on: ",q.expiryDate.toLocaleDateString()]})]}),a.jsx(i,{icon:x,label:"Warning Title",placeholder:"Brief summary of the warning",value:q.title,onChange:e=>Y("title",e)}),a.jsx(i,{icon:f,label:"Incident Location",placeholder:"Where did the incident occur?",value:q.incidentLocation,onChange:e=>Y("incidentLocation",e)}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Incident Description *"}),a.jsx("textarea",{value:q.description,onChange:e=>Y("description",e.target.value),rows:4,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Describe what happened in detail..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Additional Notes (Optional)"}),a.jsx("textarea",{value:q.additionalNotes,onChange:e=>Y("additionalNotes",e.target.value),rows:3,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Any additional context or notes..."})]})]});case 2:return a.jsxs("div",{className:"space-y-4",children:[a.jsx(r,{children:a.jsx("div",{className:"space-y-4",children:a.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:q.hasPhysicalCopy,onChange:e=>Y("hasPhysicalCopy",e.target.checked),className:"w-5 h-5 mt-0.5 rounded border-gray-300 text-primary focus:ring-primary"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"I confirm the physical signed copy exists"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Required: You must have access to the original signed warning document"})]})]})})}),q.hasPhysicalCopy&&a.jsx(i,{icon:x,label:"Physical Copy Location (Optional)",placeholder:"e.g., Filing Cabinet A3, HR Office",value:q.physicalCopyLocation,onChange:e=>Y("physicalCopyLocation",e)}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Historical Entry Notes (Optional)"}),a.jsx("textarea",{value:q.historicalNotes,onChange:e=>Y("historicalNotes",e.target.value),rows:3,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Any additional context about this historical entry..."})]}),a.jsx(w,{physicalCopyLocation:q.physicalCopyLocation||void 0})]});case 3:return a.jsxs("div",{className:"space-y-4",children:[a.jsx(r,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2",children:"Warning Summary"}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Employee:"}),a.jsxs("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:[H?.profile.firstName," ",H?.profile.lastName]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Category:"}),a.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:z?.name})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Level:"}),a.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:D[q.level]||q.level})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Validity:"}),a.jsxs("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:[q.validityPeriod," months"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Incident Date:"}),a.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:q.incidentDate?.toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Issue Date:"}),a.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:q.issueDate?.toLocaleDateString()})]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Title:"}),a.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:q.title})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Description:"}),a.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:q.description})]})]})]})}),a.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(o,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-semibold text-red-900 dark:text-red-100 mb-1",children:"This warning has NO digital signatures or audio recording"}),a.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:"Ensure the physical signed document is kept safe for legal compliance"})]})]})})]});default:return null}})()}),a.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-4 py-4 flex items-center justify-between",children:[a.jsx(s,{variant:"outline",onClick:0===E?K:G,disabled:A,icon:0===E?g:h,children:0===E?"Cancel":"Back"}),a.jsx(s,{onClick:3===E?J:$,disabled:A,className:"flex items-center justify-center gap-2",children:A?"Saving...":3===E?a.jsxs(a.Fragment,{children:["Save Historical Warning ",a.jsx(y,{className:"w-4 h-4"})]}):a.jsxs(a.Fragment,{children:["Next ",a.jsx(u,{className:"w-4 h-4"})]})})]})]})};export{P as ManualWarningEntry,P as default};
