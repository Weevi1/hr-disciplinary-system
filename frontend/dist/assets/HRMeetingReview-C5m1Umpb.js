import{u as A,j as e,L as u,F as D}from"./dashboard-components-fvKPXzEF.js";import{u as q,r}from"./react-vendor-DrdoFN08.js";import{i as E,R as O,X as M,c as P,b as $,h as G,aR as Q,C as B,o as Y,F as X,a5 as J,q as K,ap as V}from"./ui-vendor-X12rCvv3.js";import"./firebase-vendor-Cz3N8Xg7.js";import"./pdf-vendor-Bp5yZ91a.js";import"./warning-components-DfE_qdbY.js";const k={HR_MEETING_REQUESTS:"hr_meeting_requests"},j=[{id:"pending",label:"Pending Review",color:"yellow",icon:"‚è≥"},{id:"scheduled",label:"Scheduled",color:"blue",icon:"üìÖ"},{id:"completed",label:"Completed",color:"green",icon:"‚úÖ"},{id:"cancelled",label:"Cancelled",color:"red",icon:"‚ùå"}],re=()=>{const S=q(),{user:n}=A(),[d,N]=r.useState([]),[f,y]=r.useState([]),[U,v]=r.useState(!0),[R,h]=r.useState(null),[i,C]=r.useState(null),[F,c]=r.useState(!1),[g,I]=r.useState(""),[b,L]=r.useState("all"),[l,o]=r.useState({status:"",scheduledDate:"",scheduledTime:"",hrNotes:""}),[w,T]=r.useState(!1);r.useEffect(()=>{(async()=>{if(!n?.organizationId){v(!1);return}try{v(!0),h(null),u.debug("üìã Loading HR meeting requests for organization:",n.organizationId);const t=await D.queryDocuments(k.HR_MEETING_REQUESTS,[{field:"organizationId",operator:"==",value:n.organizationId}],"createdAt",50);u.success(3346),N(t),y(t)}catch(t){u.error("‚ùå Error loading meeting requests:",t),h("Failed to load meeting requests. Please try again."),N([]),y([])}finally{v(!1)}})()},[n?.organizationId]),r.useEffect(()=>{let s=d;if(g){const t=g.toLowerCase();s=s.filter(a=>a.employeeName.toLowerCase().includes(t)||a.managerName.toLowerCase().includes(t)||a.context.toLowerCase().includes(t))}b!=="all"&&(s=s.filter(t=>t.status===b)),y(s)},[d,g,b]);const z=s=>{C(s),o({status:s.status,scheduledDate:s.scheduledDate||"",scheduledTime:s.scheduledTime||"",hrNotes:s.hrNotes||""}),c(!0)},H=async()=>{if(!(!i||!n))try{T(!0),h(null);const s={status:l.status,scheduledDate:l.scheduledDate||void 0,scheduledTime:l.scheduledTime||void 0,hrNotes:l.hrNotes.trim()||void 0,hrReviewedBy:n.id,hrReviewedAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await D.updateDocument(k.HR_MEETING_REQUESTS,i.id,s),N(t=>t.map(a=>a.id===i.id?{...a,...s}:a)),c(!1),C(null),u.success(5953)}catch(s){u.error("‚ùå Error updating meeting request:",s),h("Failed to update meeting request. Please try again.")}finally{T(!1)}},_=s=>{const t=j.find(x=>x.id===s);if(!t)return{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-200"};const a={yellow:{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-200"},blue:{bg:"bg-blue-100",text:"text-blue-800",border:"border-blue-200"},green:{bg:"bg-green-100",text:"text-green-800",border:"border-green-200"},red:{bg:"bg-red-100",text:"text-red-800",border:"border-red-200"}};return a[t.color]||a.yellow},p=(()=>{const s=d.length,t=d.filter(m=>m.status==="pending").length,a=d.filter(m=>m.status==="scheduled").length,x=d.filter(m=>m.status==="completed").length;return{total:s,pending:t,scheduled:a,completed:x}})();return U?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Meeting Requests..."}),e.jsx("p",{className:"text-gray-600",children:"Preparing HR review interface..."})]})}):n?.organizationId?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-700 rounded-2xl p-6 text-white shadow-xl mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(E,{className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"HR Meeting Review"}),e.jsx("p",{className:"text-blue-100",children:"Manage and schedule employee meetings"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"p-2 rounded-lg bg-white/20 hover:bg-white/30 transition-colors",title:"Refresh",children:e.jsx(O,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>S("/dashboard"),className:"p-2 rounded-lg bg-white/20 hover:bg-white/30 transition-colors",children:e.jsx(M,{className:"w-6 h-6"})})]})]})}),R&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-red-800 font-medium",children:"Error"})]}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:R})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Requests"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.total})]}),e.jsx($,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:p.pending})]}),e.jsx(G,{className:"w-8 h-8 text-yellow-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Scheduled"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p.scheduled})]}),e.jsx(Q,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:p.completed})]}),e.jsx(B,{className:"w-8 h-8 text-green-500"})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by employee, manager, or context...",value:g,onChange:s=>I(s.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"md:w-64",children:e.jsxs("select",{value:b,onChange:s=>L(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Statuses"}),j.map(s=>e.jsxs("option",{value:s.id,children:[s.icon," ",s.label]},s.id))]})})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600"}),"Meeting Requests (",f.length,")"]})}),f.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(E,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:d.length===0?"No Meeting Requests":"No Matching Requests"}),e.jsx("p",{className:"text-gray-600",children:d.length===0?"No managers have submitted meeting requests yet.":"Try adjusting your search or filter criteria."})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:f.map(s=>{const t=_(s.status),a=j.find(x=>x.id===s.status);return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.employeeName})]}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium border ${t.bg} ${t.text} ${t.border}`,children:[a?.icon," ",a?.label]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Requested by:"})," ",s.managerName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Date:"})," ",new Date(s.requestDate).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Employee Consent:"}),e.jsx("span",{className:s.employeeConsent?"text-green-600":"text-red-600",children:s.employeeConsent?" ‚úÖ Yes":" ‚ùå No"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Context:"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:['"',s.context,'"']})]}),s.scheduledDate&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("span",{className:"font-medium text-blue-700",children:"Scheduled:"}),e.jsxs("p",{className:"text-blue-600",children:[new Date(s.scheduledDate).toLocaleDateString(),s.scheduledTime&&` at ${s.scheduledTime}`]})]}),s.hrNotes&&e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"HR Notes:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:s.hrNotes})]})]}),e.jsx("div",{className:"flex items-center gap-2 ml-4",children:e.jsxs("button",{onClick:()=>z(s),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Update"]})})]})},s.id)})})]}),F&&i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:()=>c(!1)}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Update Meeting Request"}),e.jsx("button",{onClick:()=>c(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:e.jsx(M,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Meeting Request Details"}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Employee:"})," ",i.employeeName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Manager:"})," ",i.managerName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Context:"}),' "',i.context,'"']})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:l.status,onChange:s=>o(t=>({...t,status:s.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:j.map(s=>e.jsxs("option",{value:s.id,children:[s.icon," ",s.label]},s.id))})]}),(l.status==="scheduled"||l.status==="completed")&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Date"}),e.jsx("input",{type:"date",value:l.scheduledDate,onChange:s=>o(t=>({...t,scheduledDate:s.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Time"}),e.jsx("input",{type:"time",value:l.scheduledTime,onChange:s=>o(t=>({...t,scheduledTime:s.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"HR Notes"}),e.jsx("textarea",{value:l.hrNotes,onChange:s=>o(t=>({...t,hrNotes:s.target.value})),placeholder:"Add any HR notes or meeting details...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:4})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>c(!1),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:H,disabled:!l.status||w,className:`px-6 py-3 rounded-lg font-semibold transition-colors flex items-center gap-2 ${l.status&&!w?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-4 h-4"}),"Update Request"]})})]})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",children:"‚ö†Ô∏è"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Organization Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You don't seem to be associated with an organization."}),e.jsx("button",{onClick:()=>S("/dashboard"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Return to Dashboard"})]})})};export{re as HRMeetingReview};
