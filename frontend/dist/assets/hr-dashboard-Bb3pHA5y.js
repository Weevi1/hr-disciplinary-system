const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PDFGenerationService-B6AQFPAq.js","assets/pdf-vendor-tUwojRr6.js","assets/business-owner-dashboard-C90qwqPE.js","assets/react-vendor-CWjEGAcE.js","assets/firebase-vendor-BQc9GSQK.js","assets/ui-vendor-DTBvTbg1.js"])))=>i.map(i=>d[i]);
import{u as e,a as t,L as s,d as r,D as a,b as n,s as i,j as l,T as o,c,e as d,f as m,g as x,U as h,h as u,i as g,k as p,l as y,E as f,m as v}from"./business-owner-dashboard-C90qwqPE.js";import{r as j,R as b,b as N,u as w}from"./react-vendor-CWjEGAcE.js";import{q as k,l as C,t as S,C as D,E as T,G as E,H as I,x as P,p as A,L as M,I as R,_,J as F,K as L,M as z,N as U,O as W,P as O,Q as $,R as q,S as H}from"./firebase-vendor-BQc9GSQK.js";import{WarningsReviewDashboard as B}from"./warning-components-BM0e8CZe.js";import{a as V}from"./pdf-vendor-tUwojRr6.js";import{Q as G,X as K,D as Q,b as Y,R as J,V as X,Y as Z,a as ee,Z as te,i as se,N as re,L as ae,F as ne,_ as ie,$ as le,w as oe,C as ce,p as de,a0 as me,k as xe,a1 as he,a2 as ue,U as ge,a3 as pe,a4 as ye,v as fe,e as ve,y as je,a5 as be,M as Ne,a6 as we,a7 as ke,a8 as Ce,a9 as Se,aa as De,ab as Te,ac as Ee,G as Ie,K as Pe}from"./ui-vendor-DTBvTbg1.js";class Ae{static{this.EXPIRY_HOURS=1}static async generateTemporaryLink(e){e.filename,e.pdfBlob.size,e.employeeId,e.warningId,e.organizationId;try{const t=n.currentUser;if(!t)throw s.error("❌ [TemporaryLinkService] User not authenticated"),new Error("User not authenticated");s.success(2228);const r=this.generateTokenId(),a=Date.now(),l=Math.random().toString(36).substr(2,12),o=e.filename.replace(/[^a-zA-Z0-9.-]/g,"_"),c=`temp-downloads/${e.organizationId||"default"}/${a}_${l}_${o}`,d=T(i,c),m={contentType:"application/pdf",customMetadata:{organizationId:e.organizationId||"",employeeId:e.employeeId||"",warningId:e.warningId||"",filename:e.filename,tokenId:r,createdAt:(new Date).toISOString(),size:e.pdfBlob.size.toString(),uploadedBy:t.uid,purpose:"temporary-download"}};await E(d,e.pdfBlob,m);const x=await I(d),h=new Date(Date.now()+60*this.EXPIRY_HOURS*60*1e3);await this.trackTemporaryFile({tokenId:r,storagePath:c,downloadUrl:x,filename:e.filename,organizationId:e.organizationId,employeeId:e.employeeId,warningId:e.warningId,uploadedBy:t.uid,expiresAt:h,createdAt:new Date}),s.success(4558);const u=await this.generateQRCode(x),g=new Date(Date.now()+60*this.EXPIRY_HOURS*60*1e3);return g.toISOString(),x.substring(0,60),{downloadUrl:x,qrCodeData:u,expiresAt:g.toISOString(),tokenId:r,filename:e.filename}}catch(t){throw s.error("❌ [TemporaryLinkService] Failed to generate temporary link:",t),new Error(`Failed to generate temporary link: ${t instanceof Error?t.message:"Unknown error"}`)}}static async validateTemporaryToken(e){return!0}static async revokeTemporaryToken(e){return!0}static generateTokenId(){return`tmp_${Date.now()}_${Math.random().toString(36).substr(2,12)}`}static async blobToBase64(e){return new Promise((t,s)=>{const r=new FileReader;r.onload=()=>{const e=r.result;t(e.split(",")[1])},r.onerror=s,r.readAsDataURL(e)})}static async generateQRCode(e){try{const t=`${"https://api.qrserver.com/v1/create-qr-code/"}?${new URLSearchParams({size:"300x300",data:e,format:"png",ecc:"M",margin:"10"}).toString()}`,s=await fetch(t);if(!s.ok)throw new Error("QR code generation failed");const r=await s.blob();return new Promise((e,t)=>{const s=new FileReader;s.onload=()=>e(s.result),s.onerror=t,s.readAsDataURL(r)})}catch(t){return s.error("❌ QR Code generation failed:",t),`data:text/plain;base64,${btoa(e)}`}}static formatExpiryTime(e){const t=new Date(e),s=new Date,r=t.getTime()-s.getTime();if(r<=0)return"Expired";const a=Math.floor(r/6e4),n=Math.floor(a/60),i=a%60;return n>0?`${n}h ${i}m remaining`:`${i}m remaining`}static isExpired(e){return new Date(e).getTime()<=Date.now()}static async trackTemporaryFile(e){try{await P(C(r,"temporaryFiles"),{tokenId:e.tokenId,storagePath:e.storagePath,downloadUrl:e.downloadUrl,filename:e.filename,fileType:"pdf",organizationId:e.organizationId||"",employeeId:e.employeeId||"",warningId:e.warningId||"",uploadedBy:e.uploadedBy,expiresAt:e.expiresAt,createdAt:A(),isExpired:!1,fileSize:0}),s.success(10578)}catch(t){s.error("❌ [TemporaryLinkService] Failed to track temporary file:",t)}}}const Me=({isOpen:e,onClose:t,pdfBlob:r,filename:a,employeeId:n,warningId:i,organizationId:m,employeeName:x,onLinkGenerated:h})=>{const[u,g]=j.useState(!1),[p,y]=j.useState(null),[f,v]=j.useState(null),[N,w]=j.useState({hours:0,minutes:0,seconds:0,expired:!1}),[k,C]=j.useState(!1),S=b.useRef(!1),D=j.useCallback(async()=>{if(r&&(r.size/1024).toFixed(1),r)try{g(!0),v(null);const e=await Ae.generateTemporaryLink({pdfBlob:r,filename:a,employeeId:n,warningId:i,organizationId:m});s.success(2764),y(e),h?.(e)}catch(e){s.error("❌ QR link generation failed:",e),v(e.message||"Failed to generate QR code")}finally{g(!1)}else s.error("❌ [QRCodeDownloadModal] No PDF blob provided")},[r,a,n,i,m,h]);j.useEffect(()=>{if(!p?.expiresAt)return;const e=()=>{const e=(new Date).getTime(),t=new Date(p.expiresAt).getTime()-e;if(t<=0)return void w({hours:0,minutes:0,seconds:0,expired:!0});const s=Math.floor(t/36e5),r=Math.floor(t%36e5/6e4),a=Math.floor(t%6e4/1e3);w({hours:s,minutes:r,seconds:a,expired:!1})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[p?.expiresAt]);const T=j.useCallback(async()=>{if(p?.downloadUrl)try{await navigator.clipboard.writeText(p.downloadUrl),C(!0),setTimeout(()=>C(!1),2e3)}catch(e){s.error("❌ Failed to copy link:",e)}},[p?.downloadUrl]);return j.useEffect(()=>{!e||!r||p||u||S.current||(S.current=!0,D())},[e,r,p,u,D]),j.useEffect(()=>{e||(y(null),v(null),w({hours:0,minutes:0,seconds:0,expired:!1}),C(!1),S.current=!1)},[e]),e?l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"bg-white border-b px-6 py-4 flex items-center justify-between flex-shrink-0",style:{borderColor:"var(--color-border)"},children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--color-primary-light)"},children:l.jsx(G,{className:"w-5 h-5",style:{color:"var(--color-primary)"}})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Mobile Download"}),l.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Scan to download on your phone"})]})]}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(K,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[l.jsx(o,{padding:"md",className:"border",style:{borderColor:"var(--color-border)"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--color-success-light)"},children:l.jsx(Q,{className:"w-5 h-5",style:{color:"var(--color-success)"}})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:"font-medium text-sm truncate",style:{color:"var(--color-text)"},children:a}),x&&l.jsxs("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:["For: ",x]}),l.jsxs("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:["Size: ",(r.size/1024).toFixed(1)," KB"]})]})]})}),u&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 mx-auto mb-4",style:{borderWidth:"2px",borderColor:"transparent",borderTopColor:"var(--color-primary)"}}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text)"},children:"Generating secure download link..."}),l.jsx("p",{className:"text-xs mt-2",style:{color:"var(--color-text-secondary)"},children:"This may take a moment"})]}),f&&l.jsxs(c,{variant:"error",children:[l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(Y,{className:"w-5 h-5 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-medium text-sm",children:"Generation Failed"}),l.jsx("p",{className:"text-xs mt-1",children:f})]})]}),l.jsx(d,{variant:"danger",size:"sm",onClick:D,disabled:u,className:"mt-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(J,{className:"w-4 h-4"}),l.jsx("span",{children:"Try Again"})]})})]}),p&&!N.expired&&l.jsxs("div",{className:"space-y-4",children:[l.jsx(c,{variant:"warning",className:"border-l-4",style:{borderLeftColor:"var(--color-warning)"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(X,{className:"w-5 h-5"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-sm",children:"Time-Limited Access"}),l.jsxs("p",{className:"text-xs mt-1",children:["Link expires in: ",N.hours>0&&`${N.hours}h `,N.minutes,"m ",N.seconds,"s"]})]})]})}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"bg-white p-6 rounded-lg border-2 inline-block",style:{borderColor:"var(--color-border)"},children:l.jsx("img",{src:p.qrCodeData,alt:"Download QR Code",className:"w-64 h-64 mx-auto",style:{imageRendering:"pixelated"}})}),l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",style:{color:"var(--color-text)"},children:[l.jsx(Z,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm",children:"Point your camera at the QR code"})]}),l.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"No app needed - works with built-in camera on iOS & Android"})]})]}),l.jsx("div",{className:"space-y-3",children:l.jsx(d,{variant:k?"success":"secondary",size:"md",fullWidth:!0,onClick:T,children:l.jsx("div",{className:"flex items-center justify-center gap-2",children:k?l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-5 h-5"}),l.jsx("span",{children:"Link Copied!"})]}):l.jsxs(l.Fragment,{children:[l.jsx(te,{className:"w-5 h-5"}),l.jsx("span",{children:"Copy Download Link"})]})})})}),l.jsx(c,{variant:"info",className:"border-l-4",style:{borderLeftColor:"var(--color-info)"},children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(se,{className:"w-5 h-5 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-sm",children:"Security Features"}),l.jsxs("ul",{className:"text-xs mt-1 space-y-1",children:[l.jsx("li",{children:"• Link expires automatically in 1 hour"}),l.jsx("li",{children:"• Single-use download link"}),l.jsx("li",{children:"• Encrypted token authentication"}),l.jsx("li",{children:"• No app needed - works with any camera"})]})]})]})})]}),p&&N.expired&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center",style:{backgroundColor:"var(--color-error-light)"},children:l.jsx(re,{className:"w-8 h-8",style:{color:"var(--color-error)"}})}),l.jsx("h4",{className:"text-lg font-medium mb-2",style:{color:"var(--color-text)"},children:"Link Expired"}),l.jsx("p",{className:"text-sm mb-4",style:{color:"var(--color-text-secondary)"},children:"The download link has expired for security reasons."}),l.jsx(d,{variant:"primary",size:"md",onClick:D,disabled:u,children:"Generate New Link"})]})]})]})}):null};var Re,_e,Fe=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},Le=function(e){if("loading"===document.readyState)return"loading";var t=Fe();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},ze=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},Ue=function(e,t){var s="";try{for(;e&&9!==e.nodeType;){var r=e,a=r.id?"#"+r.id:ze(r)+(r.classList&&r.classList.value&&r.classList.value.trim()&&r.classList.value.trim().length?"."+r.classList.value.trim().replace(/\s+/g,"."):"");if(s.length+a.length>(t||100)-1)return s||a;if(s=s?a+">"+s:a,r.id)break;e=r.parentNode}}catch(e){}return s},We=-1,Oe=function(e){addEventListener("pageshow",function(t){t.persisted&&(We=t.timeStamp,e(t))},!0)},$e=function(){var e=Fe();return e&&e.activationStart||0},qe=function(e,t){var s=Fe(),r="navigate";return We>=0?r="back-forward-cache":s&&(document.prerendering||$e()>0?r="prerender":document.wasDiscarded?r="restore":s.type&&(r=s.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},He=function(e,t,s){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver(function(e){Promise.resolve().then(function(){t(e.getEntries())})});return r.observe(Object.assign({type:e,buffered:!0},s||{})),r}}catch(e){}},Be=function(e,t,s,r){var a,n;return function(i){t.value>=0&&(i||r)&&((n=t.value-(a||0))||void 0===a)&&(a=t.value,t.delta=n,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,s),e(t))}},Ve=function(e){requestAnimationFrame(function(){return requestAnimationFrame(function(){return e()})})},Ge=function(e){document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e()})},Ke=function(e){var t=!1;return function(){t||(e(),t=!0)}},Qe=-1,Ye=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},Je=function(e){"hidden"===document.visibilityState&&Qe>-1&&(Qe="visibilitychange"===e.type?e.timeStamp:0,Ze())},Xe=function(){addEventListener("visibilitychange",Je,!0),addEventListener("prerenderingchange",Je,!0)},Ze=function(){removeEventListener("visibilitychange",Je,!0),removeEventListener("prerenderingchange",Je,!0)},et=function(){return Qe<0&&(Qe=Ye(),Xe(),Oe(function(){setTimeout(function(){Qe=Ye(),Xe()},0)})),{get firstHiddenTime(){return Qe}}},tt=function(e){document.prerendering?addEventListener("prerenderingchange",function(){return e()},!0):e()},st=[1800,3e3],rt=[.1,.25],at=function(e,t){!function(e,t){t=t||{},function(e,t){t=t||{},tt(function(){var s,r=et(),a=qe("FCP"),n=He("paint",function(e){e.forEach(function(e){"first-contentful-paint"===e.name&&(n.disconnect(),e.startTime<r.firstHiddenTime&&(a.value=Math.max(e.startTime-$e(),0),a.entries.push(e),s(!0)))})});n&&(s=Be(e,a,st,t.reportAllChanges),Oe(function(r){a=qe("FCP"),s=Be(e,a,st,t.reportAllChanges),Ve(function(){a.value=performance.now()-r.timeStamp,s(!0)})}))})}(Ke(function(){var s,r=qe("CLS",0),a=0,n=[],i=function(e){e.forEach(function(e){if(!e.hadRecentInput){var t=n[0],s=n[n.length-1];a&&e.startTime-s.startTime<1e3&&e.startTime-t.startTime<5e3?(a+=e.value,n.push(e)):(a=e.value,n=[e])}}),a>r.value&&(r.value=a,r.entries=n,s())},l=He("layout-shift",i);l&&(s=Be(e,r,rt,t.reportAllChanges),Ge(function(){i(l.takeRecords()),s(!0)}),Oe(function(){a=0,r=qe("CLS",0),s=Be(e,r,rt,t.reportAllChanges),Ve(function(){return s()})}),setTimeout(s,0))}))}(function(t){var s=function(e){var t,s={};if(e.entries.length){var r=e.entries.reduce(function(e,t){return e&&e.value>t.value?e:t});if(r&&r.sources&&r.sources.length){var a=(t=r.sources).find(function(e){return e.node&&1===e.node.nodeType})||t[0];a&&(s={largestShiftTarget:Ue(a.node),largestShiftTime:r.startTime,largestShiftValue:r.value,largestShiftSource:a,largestShiftEntry:r,loadState:Le(r.startTime)})}}return Object.assign(e,{attribution:s})}(t);e(s)},t)},nt=0,it=1/0,lt=0,ot=function(e){e.forEach(function(e){e.interactionId&&(it=Math.min(it,e.interactionId),lt=Math.max(lt,e.interactionId),nt=lt?(lt-it)/7+1:0)})},ct=function(){return Re?nt:performance.interactionCount||0},dt=function(){"interactionCount"in performance||Re||(Re=He("event",ot,{type:"event",buffered:!0,durationThreshold:0}))},mt=[],xt=new Map,ht=0,ut=[],gt=function(e){if(ut.forEach(function(t){return t(e)}),e.interactionId||"first-input"===e.entryType){var t=mt[mt.length-1],s=xt.get(e.interactionId);if(s||mt.length<10||e.duration>t.latency){if(s)e.duration>s.latency?(s.entries=[e],s.latency=e.duration):e.duration===s.latency&&e.startTime===s.entries[0].startTime&&s.entries.push(e);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};xt.set(r.id,r),mt.push(r)}mt.sort(function(e,t){return t.latency-e.latency}),mt.length>10&&mt.splice(10).forEach(function(e){return xt.delete(e.id)})}}},pt=function(e){var t=self.requestIdleCallback||self.setTimeout,s=-1;return e=Ke(e),"hidden"===document.visibilityState?e():(s=t(e),Ge(e)),s},yt=[200,500],ft=function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},tt(function(){var s;dt();var r,a=qe("INP"),n=function(e){pt(function(){e.forEach(gt);var t=function(){var e=Math.min(mt.length-1,Math.floor((ct()-ht)/50));return mt[e]}();t&&t.latency!==a.value&&(a.value=t.latency,a.entries=t.entries,r())})},i=He("event",n,{durationThreshold:null!==(s=t.durationThreshold)&&void 0!==s?s:40});r=Be(e,a,yt,t.reportAllChanges),i&&(i.observe({type:"first-input",buffered:!0}),Ge(function(){n(i.takeRecords()),r(!0)}),Oe(function(){ht=ct(),mt.length=0,xt.clear(),a=qe("INP"),r=Be(e,a,yt,t.reportAllChanges)}))}))},vt=[],jt=[],bt=0,Nt=new WeakMap,wt=new Map,kt=-1,Ct=function(e){vt=vt.concat(e),St()},St=function(){kt<0&&(kt=pt(Dt))},Dt=function(){wt.size>10&&wt.forEach(function(e,t){xt.has(t)||wt.delete(t)});var e=mt.map(function(e){return Nt.get(e.entries[0])}),t=jt.length-50;jt=jt.filter(function(s,r){return r>=t||e.includes(s)});for(var s=new Set,r=0;r<jt.length;r++){var a=jt[r];Tt(a.startTime,a.processingEnd).forEach(function(e){s.add(e)})}var n=vt.length-1-50;vt=vt.filter(function(e,t){return e.startTime>bt&&t>n||s.has(e)}),kt=-1};ut.push(function(e){e.interactionId&&e.target&&!wt.has(e.interactionId)&&wt.set(e.interactionId,e.target)},function(e){var t,s=e.startTime+e.duration;bt=Math.max(bt,e.processingEnd);for(var r=jt.length-1;r>=0;r--){var a=jt[r];if(Math.abs(s-a.renderTime)<=8){(t=a).startTime=Math.min(e.startTime,t.startTime),t.processingStart=Math.min(e.processingStart,t.processingStart),t.processingEnd=Math.max(e.processingEnd,t.processingEnd),t.entries.push(e);break}}t||(t={startTime:e.startTime,processingStart:e.processingStart,processingEnd:e.processingEnd,renderTime:s,entries:[e]},jt.push(t)),(e.interactionId||"first-input"===e.entryType)&&Nt.set(e,t),St()});var Tt=function(e,t){for(var s,r=[],a=0;s=vt[a];a++)if(!(s.startTime+s.duration<e)){if(s.startTime>t)break;r.push(s)}return r},Et=function(e,t){_e||(_e=He("long-animation-frame",Ct)),ft(function(t){var s=function(e){var t=e.entries[0],s=Nt.get(t),r=t.processingStart,a=s.processingEnd,n=s.entries.sort(function(e,t){return e.processingStart-t.processingStart}),i=Tt(t.startTime,a),l=e.entries.find(function(e){return e.target}),o=l&&l.target||wt.get(t.interactionId),c=[t.startTime+t.duration,a].concat(i.map(function(e){return e.startTime+e.duration})),d=Math.max.apply(Math,c),m={interactionTarget:Ue(o),interactionTargetElement:o,interactionType:t.name.startsWith("key")?"keyboard":"pointer",interactionTime:t.startTime,nextPaintTime:d,processedEventEntries:n,longAnimationFrameEntries:i,inputDelay:r-t.startTime,processingDuration:a-r,presentationDelay:Math.max(d-a,0),loadState:Le(t.startTime)};return Object.assign(e,{attribution:m})}(t);e(s)},t)},It=[2500,4e3],Pt={},At=function(e,t){!function(e,t){t=t||{},tt(function(){var s,r=et(),a=qe("LCP"),n=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach(function(e){e.startTime<r.firstHiddenTime&&(a.value=Math.max(e.startTime-$e(),0),a.entries=[e],s())})},i=He("largest-contentful-paint",n);if(i){s=Be(e,a,It,t.reportAllChanges);var l=Ke(function(){Pt[a.id]||(n(i.takeRecords()),i.disconnect(),Pt[a.id]=!0,s(!0))});["keydown","click"].forEach(function(e){addEventListener(e,function(){return pt(l)},{once:!0,capture:!0})}),Ge(l),Oe(function(r){a=qe("LCP"),s=Be(e,a,It,t.reportAllChanges),Ve(function(){a.value=performance.now()-r.timeStamp,Pt[a.id]=!0,s(!0)})})}})}(function(t){var s=function(e){var t={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:e.value};if(e.entries.length){var s=Fe();if(s){var r=s.activationStart||0,a=e.entries[e.entries.length-1],n=a.url&&performance.getEntriesByType("resource").filter(function(e){return e.name===a.url})[0],i=Math.max(0,s.responseStart-r),l=Math.max(i,n?(n.requestStart||n.startTime)-r:0),o=Math.max(l,n?n.responseEnd-r:0),c=Math.max(o,a.startTime-r);t={element:Ue(a.element),timeToFirstByte:i,resourceLoadDelay:l-i,resourceLoadDuration:o-l,elementRenderDelay:c-o,navigationEntry:s,lcpEntry:a},a.url&&(t.url=a.url),n&&(t.lcpResourceEntry=n)}}return Object.assign(e,{attribution:t})}(t);e(s)},t)};const Mt="@firebase/performance",Rt="0.7.7",_t=Rt,Ft="FB-PERF-TRACE-MEASURE",Lt="_wt_",zt="_fcp",Ut="_fid",Wt="_lcp",Ot="_inp",$t="_cls",qt="@firebase/performance/config",Ht="@firebase/performance/configexpire",Bt="Performance",Vt=new z("performance",Bt,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),Gt=new M(Bt);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Kt,Qt,Yt,Jt;Gt.logLevel=R.INFO;class Xt{constructor(e){if(this.window=e,!e)throw Vt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=At,this.onINP=Et,this.onCLS=at}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,s){this.performance&&this.performance.measure&&this.performance.measure(e,t,s)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&W()?!!O()||(Gt.info("IndexedDB is not supported by current browser"),!1):(Gt.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(e=>{for(const s of e.getEntries())t(s)}).observe({entryTypes:[e]})}static getInstance(){return void 0===Kt&&(Kt=new Xt(Qt)),Kt}}function Zt(){return Yt}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function es(e,t){const s=e.length-t.length;if(s<0||s>1)throw Vt.create("invalid String merger input");const r=[];for(let a=0;a<e.length;a++)r.push(e.charAt(a)),t.length>a&&r.push(t.charAt(a));return r.join("")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=es("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=es("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===Jt&&(Jt=new ts),Jt}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ss;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}(ss||(ss={}));const rs=["firebase_","google_","ga_"],as=new RegExp("^[a-zA-Z]\\w*$");function ns(){const e=Xt.getInstance().navigator;return(null==e?void 0:e.serviceWorker)?e.serviceWorker.controller?2:3:1}function is(){switch(Xt.getInstance().document.visibilityState){case"visible":return ss.VISIBLE;case"hidden":return ss.HIDDEN;default:return ss.UNKNOWN}}function ls(){const e=Xt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function os(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.appId;if(!s)throw Vt.create("no app id");return s}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const cs="0.0.1",ds={loggingEnabled:!0},ms="FIREBASE_INSTALLATIONS_AUTH";function xs(e,t){const s=function(){const e=Xt.getInstance().localStorage;if(!e)return;const t=e.getItem(Ht);if(!(t&&(s=t,Number(s)>Date.now())))return;var s;const r=e.getItem(qt);if(!r)return;try{return JSON.parse(r)}catch(a){return}}();return s?(us(s),Promise.resolve()):function(e,t){return function(e){const t=e.getToken();return t.then(e=>{}),t}(e.installations).then(s=>{const r=function(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!s)throw Vt.create("no project id");return s}(e.app),a=function(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!s)throw Vt.create("no api key");return s}(e.app),n=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${a}`,{method:"POST",headers:{Authorization:`${ms} ${s}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:s,app_id:os(e.app),app_version:_t,sdk_version:cs})});return fetch(n).then(e=>{if(e.ok)return e.json();throw Vt.create("RC response not ok")})}).catch(()=>{Gt.info(hs)})}(e,t).then(us).then(e=>function(e){const t=Xt.getInstance().localStorage;if(!e||!t)return;t.setItem(qt,JSON.stringify(e)),t.setItem(Ht,String(Date.now()+60*ts.getInstance().configTimeToLive*60*1e3))}(e),()=>{})}const hs="Could not fetch config, will use default configs";function us(e){if(!e)return e;const t=ts.getInstance(),s=e.entries||{};return void 0!==s.fpr_enabled?t.loggingEnabled="true"===String(s.fpr_enabled):t.loggingEnabled=ds.loggingEnabled,s.fpr_log_source?t.logSource=Number(s.fpr_log_source):ds.logSource&&(t.logSource=ds.logSource),s.fpr_log_endpoint_url?t.logEndPointUrl=s.fpr_log_endpoint_url:ds.logEndPointUrl&&(t.logEndPointUrl=ds.logEndPointUrl),s.fpr_log_transport_key?t.transportKey=s.fpr_log_transport_key:ds.transportKey&&(t.transportKey=ds.transportKey),void 0!==s.fpr_vc_network_request_sampling_rate?t.networkRequestsSamplingRate=Number(s.fpr_vc_network_request_sampling_rate):void 0!==ds.networkRequestsSamplingRate&&(t.networkRequestsSamplingRate=ds.networkRequestsSamplingRate),void 0!==s.fpr_vc_trace_sampling_rate?t.tracesSamplingRate=Number(s.fpr_vc_trace_sampling_rate):void 0!==ds.tracesSamplingRate&&(t.tracesSamplingRate=ds.tracesSamplingRate),t.logTraceAfterSampling=gs(t.tracesSamplingRate),t.logNetworkAfterSampling=gs(t.networkRequestsSamplingRate),e}function gs(e){return Math.random()<=e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ps,ys=1;function fs(e){return ys=2,ps=ps||function(e){return function(){const e=Xt.getInstance().document;return new Promise(t=>{if(e&&"complete"!==e.readyState){const s=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",s),t())};e.addEventListener("readystatechange",s)}else t()})}().then(()=>function(e){const t=e.getId();return t.then(e=>{Yt=e}),t}(e.installations)).then(t=>xs(e,t)).then(()=>vs(),()=>vs())}(e),ps}function vs(){ys=3}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let js,bs=3,Ns=[],ws=!1;function ks(e){setTimeout(()=>{bs<=0||(Ns.length>0&&Cs(),ks(1e4))},e)}function Cs(){const e=Ns.splice(0,1e3),t=e.map(e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)}));(function(e){const t=ts.getInstance().getFlTransportFullUrl(),s=JSON.stringify(e);return navigator.sendBeacon&&navigator.sendBeacon(t,s)?Promise.resolve():fetch(t,{method:"POST",body:s,keepalive:!0}).then()})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:ts.getInstance().logSource,log_event:t}).then(()=>{bs=3}).catch(()=>{Ns=[...e,...Ns],bs--,Gt.info(`Tries left: ${bs}.`),ks(1e4)})}function Ss(e){return(...t)=>{!function(e){if(!e.eventTime||!e.message)throw Vt.create("invalid cc log");Ns=[...Ns,e]}({message:e(...t),eventTime:Date.now()})}}function Ds(){for(;Ns.length>0;)Cs()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(e,t){js||(js={send:Ss(Ps),flush:Ds}),js.send(e,t)}function Es(e){const t=ts.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&Xt.getInstance().requiredApisAvailable()&&(3===ys?Is(e):fs(e.performanceController).then(()=>Is(e),()=>Is(e)))}function Is(e){if(!Zt())return;const t=ts.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&Ts(e,1)}function Ps(e,t){return 0===t?function(e){const t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},s={application_info:As(e.performanceController.app),network_request_metric:t};return JSON.stringify(s)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);const s=e.getAttributes();0!==Object.keys(s).length&&(t.custom_attributes=s);const r={application_info:As(e.performanceController.app),trace_metric:t};return JSON.stringify(r)}(e)}function As(e){return{google_app_id:os(e),app_instance_id:Zt(),web_app_info:{sdk_version:_t,page_url:Xt.getInstance().getUrl(),service_worker_status:ns(),visibility_state:is(),effective_connection_type:ls()},application_process_state:0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(e,t){const s=t;if(!s||void 0===s.responseStart)return;const r=Xt.getInstance().getTimeOrigin(),a=Math.floor(1e3*(s.startTime+r)),n=s.responseStart?Math.floor(1e3*(s.responseStart-s.startTime)):void 0,i=Math.floor(1e3*(s.responseEnd-s.startTime));!function(e){const t=ts.getInstance();if(!t.instrumentationEnabled)return;const s=e.url,r=t.logEndPointUrl.split("?")[0],a=t.flTransportEndpointUrl.split("?")[0];s!==r&&s!==a&&t.loggingEnabled&&t.logNetworkAfterSampling&&Ts(e,0)}({performanceController:e,url:s.name&&s.name.split("?")[0],responsePayloadBytes:s.transferSize,startTimeUs:a,timeToResponseInitiatedUs:n,timeToResponseCompletedUs:i})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs=["_fp",zt,Ut,Wt,$t,Ot];
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class _s{constructor(e,t,s=!1,r){this.performanceController=e,this.name=t,this.isAuto=s,this.state=1,this.customAttributes={},this.counters={},this.api=Xt.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`${Ft}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw Vt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw Vt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Es(this)}record(e,t,s){if(e<=0)throw Vt.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw Vt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),s&&s.attributes&&(this.customAttributes=Object.assign({},s.attributes)),s&&s.metrics)for(const r of Object.keys(s.metrics))isNaN(Number(s.metrics[r]))||(this.counters[r]=Math.floor(Number(s.metrics[r])));Es(this)}incrementMetric(e,t=1){void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(!function(e,t){return!(0===e.length||e.length>100)&&(t&&t.startsWith(Lt)&&Rs.indexOf(e)>-1||!e.startsWith("_"))}(e,this.name))throw Vt.create("invalid custom metric name",{customMetricName:e});this.counters[e]=function(e){const t=Math.floor(e);return t<e&&Gt.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}(null!=t?t:0)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const s=function(e){return!(0===e.length||e.length>40)&&(!rs.some(t=>e.startsWith(t))&&!!e.match(as))}(e),r=function(e){return 0!==e.length&&e.length<=100}(t);if(s&&r)this.customAttributes[e]=t;else{if(!s)throw Vt.create("invalid attribute name",{attributeName:e});if(!r)throw Vt.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,s,r,a){const n=Xt.getInstance().getUrl();if(!n)return;const i=new _s(e,Lt+n,!0),l=Math.floor(1e3*Xt.getInstance().getTimeOrigin());i.setStartTime(l),t&&t[0]&&(i.setDuration(Math.floor(1e3*t[0].duration)),i.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),i.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),i.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(s){const e=s.find(e=>"first-paint"===e.name);e&&e.startTime&&i.putMetric("_fp",Math.floor(1e3*e.startTime));const t=s.find(e=>"first-contentful-paint"===e.name);t&&t.startTime&&i.putMetric(zt,Math.floor(1e3*t.startTime)),a&&i.putMetric(Ut,Math.floor(1e3*a))}this.addWebVitalMetric(i,Wt,"lcp_element",r.lcp),this.addWebVitalMetric(i,$t,"cls_largestShiftTarget",r.cls),this.addWebVitalMetric(i,Ot,"inp_interactionTarget",r.inp),Es(i),js&&js.flush()}static addWebVitalMetric(e,t,s,r){r&&(e.putMetric(t,Math.floor(1e3*r.value)),r.elementAttribution&&e.putAttribute(s,r.elementAttribution))}static createUserTimingTrace(e,t){Es(new _s(e,t,!1,t))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fs,Ls={},zs=!1;function Us(e){Zt()&&(setTimeout(()=>function(e){const t=Xt.getInstance();"onpagehide"in window?t.document.addEventListener("pagehide",()=>Os(e)):t.document.addEventListener("unload",()=>Os(e));t.document.addEventListener("visibilitychange",()=>{"hidden"===t.document.visibilityState&&Os(e)}),t.onFirstInputDelay&&t.onFirstInputDelay(e=>{Fs=e});t.onLCP(e=>{var t;Ls.lcp={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.element}}),t.onCLS(e=>{var t;Ls.cls={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.largestShiftTarget}}),t.onINP(e=>{var t;Ls.inp={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.interactionTarget}})}(e),0),setTimeout(()=>function(e){const t=Xt.getInstance(),s=t.getEntriesByType("resource");for(const r of s)Ms(e,r);t.setupObserver("resource",t=>Ms(e,t))}(e),0),setTimeout(()=>function(e){const t=Xt.getInstance(),s=t.getEntriesByType("measure");for(const r of s)Ws(e,r);t.setupObserver("measure",t=>Ws(e,t))}(e),0))}function Ws(e,t){const s=t.name;s.substring(0,21)!==Ft&&_s.createUserTimingTrace(e,s)}function Os(e){if(!zs){zs=!0;const t=Xt.getInstance(),s=t.getEntriesByType("navigation"),r=t.getEntriesByType("paint");setTimeout(()=>{_s.createOobTrace(e,s,r,Ls,Fs)},0)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),Xt.getInstance().requiredApisAvailable()?U().then(e=>{e&&(ws||(ks(5500),ws=!0),fs(this).then(()=>Us(this),()=>Us(this)),this.initialized=!0)}).catch(e=>{Gt.info(`Environment doesn't support IndexedDB: ${e}`)}):Gt.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){ts.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return ts.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){ts.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return ts.getInstance().dataCollectionEnabled}}const qs=(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if("[DEFAULT]"!==s.name)throw Vt.create("FB not default");if("undefined"==typeof window)throw Vt.create("no window");!function(e){Qt=e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(window);const a=new $s(s,r);return a._init(t),a};_(new F("performance",qs,"PUBLIC")),L(Mt,Rt),L(Mt,Rt,"esm2017");let Hs=null,Bs=!1;function Vs(){try{Hs=function(e=$()){return e=q(e),H(e,"performance").getImmediate()}(m),Bs=!0}catch(e){s.error("❌ [PERFORMANCE] Failed to initialize:",e)}}function Gs(e){return Bs&&Hs?function(e,t){return e=q(e),new _s(e,t)}(Hs,e):{start:()=>{},stop:()=>{},putAttribute:()=>{},putMetric:()=>{},incrementMetric:()=>{},getAttribute:()=>null,getMetric:()=>0}}const Ks="generate_warning_pdf",Qs=({isOpen:e,onClose:t,warningData:r,deliveryChoice:a,onPDFGenerated:n,showPreview:i=!0,title:o="Warning Document"})=>{const{organization:c}=x(),[d,m]=j.useState(null),[h,u]=j.useState(null),[g,p]=j.useState(""),[y,f]=j.useState(!1),[v,b]=j.useState(null),[N,w]=j.useState(""),[k,C]=j.useState(!1),[S,D]=j.useState(null),[T,E]=j.useState(!1),[I,P]=j.useState(!1);j.useEffect(()=>{const e=()=>P(window.innerWidth<768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const A=j.useMemo(()=>{if(!r)return null;const e=r.wizardState||r,t=e.selectedEmployee||r.selectedEmployee||r.employee,s=e.selectedCategory||r.selectedCategory,n=e.formData||r.formData||{},i=e.signatures||r.signatures||{},l=e.lraRecommendation||r.lraRecommendation,o=t?{id:t.id,firstName:t.profile?.firstName||t.firstName||"Unknown",lastName:t.profile?.lastName||t.lastName||"Employee",employeeId:t.profile?.employeeNumber||t.employeeId||t.id||"N/A",position:t.employment?.position||t.position||"Unknown Position",department:t.employment?.department||t.profile?.department||t.department||"Unknown Department",email:t.profile?.email||t.email||"",phone:t.profile?.phoneNumber||t.phone||""}:{id:n.employeeId||"unknown",firstName:"Employee",lastName:"Not Selected",employeeId:n.employeeId||"N/A",position:"Unknown Position",department:"Unknown Department",email:"",phone:""},c=s?{id:s.id,name:s.name||"General Misconduct",severity:s.severity||"medium"}:{id:n.categoryId||"unknown",name:"Category Not Selected",severity:"medium"};return{warningId:`WRN_${Date.now()}`,organizationId:e.organizationId||r.organizationId,employee:o,category:c,isComplete:!(!t||!s),incident:{date:n.incidentDate||(new Date).toISOString().split("T")[0],time:n.incidentTime||"09:00",location:n.incidentLocation||"",description:n.incidentDescription||""},additionalNotes:n.additionalNotes||"",validityPeriod:n.validityPeriod||6,signatures:{manager:i.manager,employee:i.employee},recommendation:l,issueDate:new Date,deliveryMethod:a?.method||"email"}},[r,a]),M=j.useMemo(()=>{if(!A)return"Warning_Document.pdf";const e=`${A.employee.firstName}_${A.employee.lastName}`,t=(new Date).toISOString().split("T")[0];return`Warning_${A.category.name.replace(/\s+/g,"_").substring(0,20)}_${e}_${t}.pdf`},[A]),R=j.useCallback(async()=>{if(!A||!c)return void b("Missing required data for PDF generation");if(!(A.incident.description||A.incident.location||A.additionalNotes))return void b("Insufficient incident data. Please complete the form first.");f(!0),b(null);const e=["Preparing document...","Applying branding...","Formatting content...","Finalizing PDF..."];try{for(let s=0;s<e.length;s++)w(e[s]),await new Promise(e=>setTimeout(e,400));const t={warningId:A.warningId,issuedDate:A.issueDate,employee:{firstName:A.employee.firstName,lastName:A.employee.lastName,employeeNumber:A.employee.employeeId,department:A.employee.department,position:A.employee.position,email:A.employee.email},warningLevel:A.recommendation?.suggestedLevel||"verbal",category:A.category.name,description:A.incident.description,incidentDate:new Date(A.incident.date),incidentTime:A.incident.time,incidentLocation:A.incident.location,organization:c,signatures:A.signatures,additionalNotes:A.additionalNotes,validityPeriod:A.validityPeriod,legalCompliance:{isCompliant:!0,framework:"LRA Section 188",requirements:A.recommendation?.legalRequirements||[]},disciplineRecommendation:A.recommendation?{suggestedLevel:A.recommendation.suggestedLevel,reason:A.recommendation.reason||"Progressive discipline escalation",warningCount:A.recommendation.warningCount||0,activeWarnings:A.recommendation.previousWarnings||[],legalRequirements:A.recommendation.legalRequirements||[]}:void 0,deliveryChoice:a?{method:a.method,timestamp:new Date,chosenBy:"Manager",contactDetails:a.contactDetails}:void 0},{PDFGenerationService:r}=await V(async()=>{const{PDFGenerationService:e}=await import("./PDFGenerationService-B6AQFPAq.js");return{PDFGenerationService:e}},__vite__mapDeps([0,1,2,3,4,5])),i=await async function(e,t,s){const r=Gs(e);try{r.start(),s&&Object.entries(s).forEach(([e,t])=>{r.putAttribute(e,t)});const e=await t();return r.stop(),e}catch(v){throw r.putAttribute("error","true"),r.stop(),v}}(Ks,()=>r.generateWarningPDF(t),{employee:`${A.employee.firstName} ${A.employee.lastName}`,category:A.category.name});m(i),p(M);const l=URL.createObjectURL(i);u(l),s.success("✅ PDF generated:",{employee:`${A.employee.firstName} ${A.employee.lastName}`,size:`${(i.size/1024).toFixed(1)} KB`}),n&&await n(i,M)}catch(t){s.error("❌ PDF generation failed:",t),b(`Failed to generate PDF: ${t instanceof Error?t.message:"Unknown error"}`)}finally{f(!1),w("")}},[A,c,M,a,n]);j.useCallback(()=>{if(!d||!g)return;const e=URL.createObjectURL(d),t=document.createElement("a");t.href=e,t.download=g,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e),s.success("📥 PDF downloaded successfully")},[d,g]);const _=j.useCallback(async()=>{if(A&&c){E(!0);try{const e={warningId:A.warningId,issuedDate:A.issueDate,employee:{firstName:A.employee.firstName,lastName:A.employee.lastName,employeeNumber:A.employee.employeeId,department:A.employee.department,position:A.employee.position,email:A.employee.email},warningLevel:A.recommendation?.suggestedLevel||"verbal",category:A.category.name,description:A.incident.description,incidentDate:new Date(A.incident.date),incidentTime:A.incident.time,incidentLocation:A.incident.location,organization:c,signatures:A.signatures,additionalNotes:A.additionalNotes,validityPeriod:A.validityPeriod,legalCompliance:{isCompliant:!0,framework:"LRA Section 188",requirements:A.recommendation?.legalRequirements||[]},disciplineRecommendation:A.recommendation?{suggestedLevel:A.recommendation.suggestedLevel,reason:A.recommendation.reason||"Progressive discipline escalation",warningCount:A.recommendation.warningCount||0,activeWarnings:A.recommendation.previousWarnings||[],legalRequirements:A.recommendation.legalRequirements||[]}:void 0},{PDFGenerationService:t}=await V(async()=>{const{PDFGenerationService:e}=await import("./PDFGenerationService-B6AQFPAq.js");return{PDFGenerationService:e}},__vite__mapDeps([0,1,2,3,4,5])),s=await t.generateWarningPDF(e);D(s),C(!0)}catch(e){s.error("❌ QR PDF generation failed:",e),b(`Failed to generate QR code: ${e instanceof Error?e.message:"Unknown error"}`)}finally{E(!1)}}else b("Missing required data for QR code generation")},[A,c]),F=j.useCallback(()=>{h&&window.open(h,"_blank")},[h]),L=j.useRef(!1);return j.useEffect(()=>{e&&A&&A.isComplete&&!d&&!y&&!L.current&&(L.current=!0,R()),e||(L.current=!1)},[e,A,d,y,R]),j.useEffect(()=>{e&&window.scrollTo({top:0,behavior:"smooth"})},[e]),j.useEffect(()=>()=>{h&&URL.revokeObjectURL(h)},[h]),e?I?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:t,children:l.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[l.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between flex-shrink-0",children:[l.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:o}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:l.jsx(K,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[v&&l.jsxs("div",{className:"bg-red-50 border-l-4 border-red-400 p-3 rounded-r-lg",children:[l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(Y,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),l.jsx("p",{className:"text-sm text-red-700 mt-1",children:v})]})]}),l.jsxs("button",{onClick:R,className:"mt-2 text-sm text-red-700 hover:text-red-900 font-medium flex items-center gap-1",children:[l.jsx(J,{className:"w-4 h-4"}),"Retry"]})]}),y&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(ae,{className:"w-6 h-6 text-blue-600 animate-spin"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-800 font-medium",children:"Generating PDF"}),N&&l.jsx("p",{className:"text-blue-600 text-sm",children:N})]})]})}),A&&!A.isComplete&&!y&&l.jsxs("div",{className:"bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg",children:[l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(Y,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-sm font-semibold text-amber-800 mb-2",children:"Incomplete Warning Data"}),l.jsxs("div",{className:"text-sm text-amber-700 space-y-1",children:[!A.hasEmployee&&l.jsx("p",{children:"• Employee not selected"}),!A.hasCategory&&l.jsx("p",{children:"• Category not selected"}),!A.incident.description&&l.jsx("p",{children:"• Incident description missing"})]}),l.jsx("p",{className:"text-sm text-amber-800 mt-3 font-medium",children:"Please complete the warning wizard before generating the PDF."})]})]}),l.jsx("button",{onClick:t,className:"mt-3 w-full bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors font-medium",children:"Return to Wizard"})]}),d&&!y&&A&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center flex-shrink-0",children:l.jsx(ne,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 text-base mb-1",children:[A.employee.firstName," ",A.employee.lastName]}),l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:A.category.name}),l.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[l.jsx(ne,{className:"w-3 h-3"}),l.jsx("span",{className:"truncate",children:g})]}),l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(d.size/1024).toFixed(1)," KB"]})]}),l.jsx(ee,{className:"w-6 h-6 text-green-600 flex-shrink-0"})]})}),l.jsx("div",{className:"space-y-3",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{onClick:_,disabled:T,className:"flex items-center justify-center gap-2 bg-white text-gray-700 border border-gray-300 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors font-medium disabled:opacity-50",style:{minHeight:"48px"},children:[T?l.jsx(ae,{className:"w-4 h-4 animate-spin"}):l.jsx(G,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm",children:"QR Code"})]}),l.jsxs("button",{onClick:F,className:"flex items-center justify-center gap-2 bg-white text-gray-700 border border-gray-300 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors font-medium",style:{minHeight:"48px"},children:[l.jsx(ie,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm",children:"Preview"})]})]})})]}),!A&&!y&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx(ne,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Data Available"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Complete the warning wizard first."}),l.jsx("button",{onClick:t,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Return to Wizard"})]})]})]})}),S&&l.jsx(Me,{isOpen:k,onClose:()=>{C(!1),D(null)},pdfBlob:S,filename:g,employeeId:A?.employee?.id,warningId:A?.warningId,organizationId:A?.organizationId||c?.id,employeeName:A&&`${A.employee.firstName} ${A.employee.lastName}`.trim(),onLinkGenerated:e=>{}})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full h-[90vh] overflow-hidden flex",children:[l.jsxs("div",{className:"w-80 border-r border-gray-200 flex flex-col",children:[l.jsxs("div",{className:"p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center",children:l.jsx(le,{className:"w-5 h-5 text-white"})}),l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:o})]}),A&&l.jsxs("div",{className:"mt-3",children:[l.jsxs("p",{className:"font-medium text-gray-900 text-base",children:[A.employee.firstName," ",A.employee.lastName]}),l.jsx("p",{className:"text-sm text-gray-600",children:A.category.name})]})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[v&&l.jsxs("div",{className:"bg-red-50 border-l-4 border-red-400 p-3 rounded-r-lg",children:[l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(Y,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),l.jsx("p",{className:"text-xs text-red-700 mt-1",children:v})]})]}),l.jsxs("button",{onClick:R,className:"mt-2 text-sm text-red-700 hover:text-red-900 font-medium flex items-center gap-1",children:[l.jsx(J,{className:"w-4 h-4"}),"Retry"]})]}),y&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(ae,{className:"w-5 h-5 text-blue-600 animate-spin flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-800 font-medium text-sm",children:"Generating PDF"}),N&&l.jsx("p",{className:"text-blue-600 text-xs mt-1",children:N})]})]})}),A&&!A.isComplete&&!y&&l.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-400 p-3 rounded-r-lg",children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(Y,{className:"w-5 h-5 text-amber-400 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-sm font-semibold text-amber-800 mb-2",children:"Incomplete Data"}),l.jsxs("div",{className:"text-xs text-amber-700 space-y-1",children:[!A.hasEmployee&&l.jsx("p",{children:"• No employee selected"}),!A.hasCategory&&l.jsx("p",{children:"• No category selected"}),!A.incident.description&&l.jsx("p",{children:"• No incident description"})]}),l.jsx("p",{className:"text-xs text-amber-800 mt-2 font-medium",children:"Complete the wizard first."})]})]})}),d&&!y&&l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(ee,{className:"w-5 h-5 text-green-600"}),l.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Ready to Download"})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("p",{className:"text-xs text-gray-600 truncate",title:g,children:g}),l.jsxs("p",{className:"text-xs text-gray-500",children:[(d.size/1024).toFixed(1)," KB"]})]})]}),d&&!y&&l.jsx("div",{className:"space-y-3 pt-2",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("button",{onClick:_,disabled:T,className:"flex items-center justify-center gap-2 bg-white text-gray-700 border border-gray-300 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors font-medium disabled:opacity-50",children:T?l.jsxs(l.Fragment,{children:[l.jsx(ae,{className:"w-4 h-4 animate-spin"}),l.jsx("span",{children:"Generating..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(G,{className:"w-4 h-4"}),l.jsx("span",{children:"QR Code"})]})}),l.jsxs("button",{onClick:F,className:"flex items-center justify-center gap-2 bg-white text-gray-700 border border-gray-300 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:[l.jsx(ie,{className:"w-4 h-4"}),l.jsx("span",{children:"Open in New Tab"})]})]})})]}),l.jsx("div",{className:"p-6 border-t border-gray-200",children:l.jsx("button",{onClick:t,className:"w-full px-4 py-2 text-gray-600 hover:text-gray-800 font-medium transition-colors",children:"Close"})})]}),l.jsxs("div",{className:"flex-1 bg-gray-50 flex flex-col",children:[l.jsx("div",{className:"p-4 flex justify-end",children:l.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(K,{className:"w-5 h-5"})})}),l.jsx("div",{className:"flex-1 p-6 pt-0",children:h&&i?l.jsx("div",{className:"h-full bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:l.jsx("iframe",{src:h,className:"w-full h-full border-0",title:"PDF Preview"})}):y?l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(ae,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Generating preview..."})]})}):l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(ne,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"No preview available"})]})})})]})]})}),S&&l.jsx(Me,{isOpen:k,onClose:()=>{C(!1),D(null)},pdfBlob:S,filename:g,employeeId:A?.employee?.id,warningId:A?.warningId,organizationId:A?.organizationId||c?.id,employeeName:A&&`${A.employee.firstName} ${A.employee.lastName}`.trim(),onLinkGenerated:e=>{}})]}):null},Ys=({physicalCopyLocation:e,className:t=""})=>l.jsx(o,{className:`bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-500 ${t}`,children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-amber-500 flex items-center justify-center",children:l.jsx(Y,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-base font-semibold text-amber-900 dark:text-amber-100",children:"⚠️ IMPORTANT: Physical Copy Required"}),l.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 mt-1",children:"This warning was entered manually from a physical document"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-amber-300 dark:border-amber-700",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"The system does NOT have:"}),l.jsxs("ul",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),l.jsx("span",{children:"Digital signatures from manager and employee"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),l.jsx("span",{children:"Audio recording of the disciplinary meeting"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),l.jsx("span",{children:"PDF document with QR code verification"})]})]})]}),l.jsxs("div",{className:"bg-amber-100 dark:bg-amber-900/40 rounded-lg p-4 border border-amber-400 dark:border-amber-600",children:[l.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[l.jsx(se,{className:"w-5 h-5 text-amber-700 dark:text-amber-300 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm font-semibold text-amber-900 dark:text-amber-100",children:"Legal Compliance Requirement:"})]}),l.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200 ml-7",children:["You ",l.jsx("strong",{children:"MUST"})," keep the original signed physical document safe and accessible for potential legal proceedings or CCMA hearings. This digital record is supplementary only."]})]}),e&&l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-amber-300 dark:border-amber-700",children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(ne,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:"Physical Copy Location:"}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 font-mono bg-gray-50 dark:bg-gray-900 px-3 py-2 rounded border border-gray-200 dark:border-gray-700",children:e})]})]})}),l.jsx("div",{className:"text-xs text-amber-700 dark:text-amber-300 italic border-t border-amber-300 dark:border-amber-700 pt-3",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Note:"})," Historical entries are fully integrated with the escalation system and will count toward the employee's progressive discipline record."]})})]})}),Js=({value:e,onChange:t,min:s,max:r,label:a,className:n=""})=>{const[i,o]=j.useState(!1),c=j.useRef(null);j.useEffect(()=>{if(i&&c.current){const t=c.current,r=48,a=(e-s)*r-t.clientHeight/2+r/2;setTimeout(()=>{t.scrollTo({top:Math.max(0,a),behavior:"smooth"})},100)}},[i,e,s]);const d=(()=>{const e=[];for(let t=s;t<=r;t++)e.push(t);return e})();return l.jsxs("div",{className:`relative ${n}`,children:[l.jsx("div",{onClick:()=>o(!i),className:"w-24 h-20 cursor-pointer border-2 rounded-2xl flex items-center justify-center transition-all duration-200 hover:scale-105",style:{backgroundColor:"var(--color-card-background)",borderColor:i?"var(--color-primary)":"var(--color-border)",boxShadow:i?"0 0 0 3px var(--color-primary-light)":"0 4px 12px rgba(0, 0, 0, 0.08)"},children:l.jsx("span",{className:"text-3xl font-light",style:{color:"var(--color-text)",fontVariantNumeric:"tabular-nums"},children:e.toString().padStart(2,"0")})}),i&&l.jsx("div",{className:"absolute top-full left-0 mt-2 w-24 bg-white border-2 rounded-2xl shadow-lg z-10 overflow-hidden",style:{backgroundColor:"var(--color-card-background)",borderColor:"var(--color-primary)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.15)"},children:l.jsx("div",{ref:c,className:"max-h-48 overflow-y-auto scrollbar-thin",style:{scrollbarWidth:"thin",scrollbarColor:"var(--color-primary) transparent"},children:d.map(s=>l.jsx("button",{onClick:()=>(t(s),void o(!1)),className:"w-full h-12 flex items-center justify-center transition-all duration-150 hover:scale-105",style:{backgroundColor:s===e?"var(--color-primary-light)":"transparent",color:s===e?"var(--color-primary)":"var(--color-text)",fontWeight:s===e?"600":"400",fontVariantNumeric:"tabular-nums"},onMouseEnter:t=>{s!==e&&(t.currentTarget.style.backgroundColor="var(--color-muted)")},onMouseLeave:t=>{s!==e&&(t.currentTarget.style.backgroundColor="transparent")},children:l.jsx("span",{className:"text-lg",children:s.toString().padStart(2,"0")})},s))})}),l.jsx("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2",children:l.jsx("span",{className:"text-xs font-medium tracking-wider uppercase",style:{color:"var(--color-text-tertiary)"},children:a})})]})},Xs=({label:e,value:t,onChange:s,type:r="date",icon:a,required:n=!1,disabled:i=!1,error:o,className:c=""})=>{const[d,m]=j.useState(!1),[x,h]=j.useState(t?new Date(t):null),[u,g]=j.useState(new Date),[p,y]=j.useState({hours:t?new Date(`1970-01-01T${t}`).getHours():9,minutes:t?new Date(`1970-01-01T${t}`).getMinutes():0}),f=j.useRef(null),v=j.useRef(null);j.useEffect(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&f.current&&!f.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),j.useEffect(()=>(d?(setTimeout(()=>{const e=v.current;e&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},100),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[d]);const b=e=>{h(e);const t=e.toISOString().split("T")[0];s(t),m(!1)},w=(e,t)=>{y({hours:e,minutes:t});const r=`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;s(r)},k=(()=>{const e=u.getFullYear(),t=u.getMonth(),s=new Date(e,t,1),r=new Date(s);r.setDate(r.getDate()-s.getDay());const a=[];for(let n=0;n<42;n++){const e=new Date(r);e.setDate(r.getDate()+n),a.push(e)}return a})(),C=new Date,S={backgroundColor:o?"var(--color-alert-error-bg)":"var(--color-input-background)",borderColor:o?"var(--color-alert-error-border)":"var(--color-input-border)",color:"var(--color-text)"};return l.jsxs("div",{className:`space-y-2 ${c}`,children:[l.jsxs("label",{className:"block text-xs font-medium",style:{color:"var(--color-text-secondary)"},children:[a&&l.jsx(a,{className:"w-3 h-3 inline mr-1"}),e," ",n&&l.jsx("span",{style:{color:"var(--color-error)"},children:"*"})]}),l.jsxs("div",{className:"relative",ref:f,children:[l.jsxs("div",{onClick:()=>!i&&m(!d),className:"w-full h-11 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm cursor-pointer flex items-center justify-between "+(i?"opacity-50 cursor-not-allowed":""),style:S,children:[l.jsx("span",{style:{color:t?"var(--color-text)":"var(--color-text-tertiary)"},children:"time"===r?t||"Select time...":x?x.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Select date..."}),"date"===r?l.jsx(oe,{className:"w-4 h-4",style:{color:"var(--color-primary)"}}):l.jsx(re,{className:"w-4 h-4",style:{color:"var(--color-primary)"}})]}),d&&"undefined"!=typeof document&&N.createPortal(l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[10000]",onClick:()=>m(!1)}),l.jsx("div",{ref:v,className:"fixed inset-0 z-[10001] flex items-center justify-center p-4",children:l.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full max-h-[90vh] overflow-auto",style:{backgroundColor:"var(--color-card-background)",borderColor:"var(--color-border)",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:e=>e.stopPropagation(),children:"date"===r?l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("button",{onClick:()=>g(new Date(u.setMonth(u.getMonth()-1))),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",style:{color:"var(--color-text-secondary)"},children:l.jsx(ce,{className:"w-4 h-4"})}),l.jsx("h3",{className:"font-semibold text-center flex-1",style:{color:"var(--color-text)"},children:u.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),l.jsx("button",{onClick:()=>g(new Date(u.setMonth(u.getMonth()+1))),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",style:{color:"var(--color-text-secondary)"},children:l.jsx(de,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(e=>l.jsx("div",{className:"text-xs font-medium text-center p-2",style:{color:"var(--color-text-secondary)"},children:e},e))}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:k.map((e,t)=>{const s=e.getMonth()===u.getMonth(),r=e.toDateString()===C.toDateString(),a=x&&e.toDateString()===x.toDateString();return l.jsx("button",{onClick:()=>s&&b(e),disabled:!s,className:"p-2 text-sm rounded-lg transition-all "+(s?"hover:bg-gray-100 cursor-pointer":"opacity-30 cursor-not-allowed"),style:{backgroundColor:a?"var(--color-primary)":r?"var(--color-primary-light)":"transparent",color:a?"white":r?"var(--color-primary)":"var(--color-text)",fontWeight:r||a?"600":"400"},children:e.getDate()},t)})}),l.jsx("div",{className:"mt-4 flex justify-center",children:l.jsx("button",{onClick:()=>b(C),className:"px-4 py-2 text-sm rounded-lg border transition-colors",style:{borderColor:"var(--color-primary)",color:"var(--color-primary)",backgroundColor:"transparent"},children:"Today"})})]}):l.jsxs("div",{className:"p-6",children:[l.jsx("div",{className:"text-center mb-6",children:l.jsx("h3",{className:"text-lg font-light tracking-wide",style:{color:"var(--color-text)",letterSpacing:"0.5px"},children:"Select Time"})}),l.jsxs("div",{className:"flex items-center justify-center gap-6 mb-8",children:[l.jsx(Js,{value:p.hours,onChange:e=>w(e,p.minutes),min:0,max:23,label:"Hours"}),l.jsxs("div",{className:"flex flex-col items-center self-start mt-12",children:[l.jsx("div",{className:"w-3 h-3 rounded-full mb-3",style:{backgroundColor:"var(--color-primary)"}}),l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"var(--color-primary)"}})]}),l.jsx(Js,{value:p.minutes,onChange:e=>w(p.hours,e),min:0,max:59,label:"Minutes"})]}),l.jsx("div",{className:"text-center mb-6",children:l.jsxs("div",{className:"inline-flex items-center px-4 py-2 rounded-full",style:{backgroundColor:"var(--color-muted)"},children:[l.jsx(re,{className:"w-4 h-4 mr-2",style:{color:"var(--color-text-secondary)"}}),l.jsxs("span",{className:"text-lg font-medium tracking-wider",style:{color:"var(--color-text)",fontVariantNumeric:"tabular-nums"},children:[p.hours.toString().padStart(2,"0"),":",p.minutes.toString().padStart(2,"0")]})]})}),l.jsx("div",{className:"flex justify-center",children:l.jsx("button",{onClick:()=>m(!1),className:"px-8 py-3 rounded-xl font-medium tracking-wide transition-all duration-200 transform hover:scale-105 active:scale-95",style:{backgroundColor:"var(--color-primary)",color:"white",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.15)",letterSpacing:"0.5px"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 6px 24px rgba(0, 0, 0, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="0 4px 16px rgba(0, 0, 0, 0.15)"},children:"Done"})})]})})})]}),document.body)]}),o&&l.jsxs("div",{className:"flex items-center gap-1 text-xs",style:{color:"var(--color-error)"},children:[l.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o]})]})},Zs=["Select Employee & Category","Enter Dates & Details","Physical Copy Confirmation","Review & Save"],er={counselling:"Counselling Session",verbal:"Verbal Warning",first_written:"First Written Warning",second_written:"Second Written Warning",final_written:"Final Written Warning"},tr=({isOpen:e,onClose:t,onSuccess:r,employees:a,categories:n,preSelectedEmployeeId:i,currentUserId:c,organizationId:m})=>{const[x,p]=j.useState(0),[y,f]=j.useState(!1),[v,b]=j.useState(null),[N,w]=j.useState({employeeId:i||"",categoryId:"",level:"",incidentDate:null,incidentTime:"09:00",issueDate:null,expiryDate:null,validityPeriod:6,title:"",description:"",incidentLocation:"",additionalNotes:"",hasPhysicalCopy:!1,physicalCopyLocation:"",historicalNotes:""}),k=j.useMemo(()=>a.find(e=>e.id===N.employeeId),[a,N.employeeId]),C=j.useMemo(()=>n.find(e=>e.id===N.categoryId),[n,N.categoryId]),S=j.useMemo(()=>C?.escalationPath?C.escalationPath:["counselling","verbal","first_written","second_written","final_written"],[C]),D=j.useCallback((e,t)=>{if(!e)return null;const s=new Date(e);return s.setMonth(s.getMonth()+t),s},[]),T=j.useCallback((e,t)=>{w(s=>{const r={...s,[e]:t};if("issueDate"===e||"validityPeriod"===e){const a="issueDate"===e?t:s.issueDate,n="validityPeriod"===e?t:s.validityPeriod;r.expiryDate=D(a,n)}return r})},[D]),E=j.useCallback(e=>{switch(e){case 0:return N.employeeId?N.categoryId?N.level?{isValid:!0}:{isValid:!1,error:"Please select a warning level"}:{isValid:!1,error:"Please select a category"}:{isValid:!1,error:"Please select an employee"};case 1:return N.incidentDate?N.issueDate?N.title.trim()?N.description.trim()?N.incidentLocation.trim()?N.issueDate>new Date?{isValid:!1,error:"Issue date cannot be in the future"}:N.expiryDate&&N.expiryDate<=N.issueDate?{isValid:!1,error:"Expiry date must be after issue date"}:{isValid:!0}:{isValid:!1,error:"Please enter incident location"}:{isValid:!1,error:"Please enter incident description"}:{isValid:!1,error:"Please enter a warning title"}:{isValid:!1,error:"Please enter issue date"}:{isValid:!1,error:"Please enter incident date"};case 2:return N.hasPhysicalCopy?{isValid:!0}:{isValid:!1,error:"You must confirm that a physical signed copy exists"};case 3:return{isValid:!0};default:return{isValid:!1}}},[N]),I=j.useCallback(()=>{const e=E(x);e.isValid?(b(null),p(e=>Math.min(e+1,3))):b(e.error||"Please complete all required fields")},[x,E]),P=j.useCallback(()=>{b(null),p(e=>Math.max(e-1,0))},[]),A=j.useCallback(async()=>{const e=E(2);if(e.isValid){f(!0),b(null);try{const{ShardedDataService:e}=await V(async()=>{const{ShardedDataService:e}=await import("./business-owner-dashboard-C90qwqPE.js").then(e=>e.V);return{ShardedDataService:e}},__vite__mapDeps([2,3,1,4,5])),s={employeeId:N.employeeId,categoryId:N.categoryId,level:N.level,incidentDate:N.incidentDate,incidentTime:N.incidentTime,issueDate:N.issueDate,expiryDate:N.expiryDate,validityPeriod:N.validityPeriod,title:N.title,description:N.description,incidentLocation:N.incidentLocation,additionalNotes:N.additionalNotes,isHistoricalEntry:!0,hasPhysicalCopy:N.hasPhysicalCopy,physicalCopyLocation:N.physicalCopyLocation,historicalNotes:N.historicalNotes,enteredBy:c,enteredAt:new Date,issuedBy:c,status:"issued",isActive:!0,deliveryStatus:"delivered",followUpActions:[]};await e.createWarning(s,m),r(),t()}catch(a){s.error("Error creating historical warning:",a),b(a instanceof Error?a.message:"Failed to create warning")}finally{f(!1)}}else b(e.error||"Please complete all required fields")},[N,c,m,r,t,E]),M=j.useCallback(()=>{y||(p(0),b(null),w({employeeId:i||"",categoryId:"",level:"",incidentDate:null,incidentTime:"09:00",issueDate:null,expiryDate:null,validityPeriod:6,title:"",description:"",incidentLocation:"",additionalNotes:"",hasPhysicalCopy:!1,physicalCopyLocation:"",historicalNotes:""}),t())},[y,t,i]);return l.jsxs(h,{isOpen:e,onClose:M,title:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-amber-100 to-amber-50 dark:from-amber-900/40 dark:to-amber-900/20 flex items-center justify-center shadow-sm",children:l.jsx(ne,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"Manual Warning Entry"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:Zs[x]})]})]}),size:"lg",children:[l.jsx("div",{className:"flex items-center justify-between mb-4 px-4",children:[0,1,2,3].map(e=>l.jsxs("div",{className:"flex items-center flex-1",children:[l.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-xs font-semibold transition-all duration-200\n                "+(e<=x?"bg-blue-600 text-white shadow-sm":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400"),children:e<x?l.jsx(me,{className:"w-3.5 h-3.5"}):e+1}),e<3&&l.jsx("div",{className:"flex-1 h-0.5 mx-2 transition-all duration-200\n                  "+(e<x?"bg-blue-600":"bg-gray-200 dark:bg-gray-700")})]},e))}),v&&l.jsx("div",{className:"mb-4 px-4",children:l.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg p-3 flex items-start gap-2",children:[l.jsx(Y,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:v})]})}),l.jsx("div",{className:"px-4 pb-4 max-h-[calc(100vh-300px)] overflow-y-auto",children:(()=>{switch(x){case 0:return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(g,{icon:ge,title:"Select Employee",subtitle:"Choose the employee who received this warning"}),l.jsxs("select",{value:N.employeeId,onChange:e=>T("employeeId",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[l.jsx("option",{value:"",children:"Select an employee..."}),a.map(e=>l.jsxs("option",{value:e.id,children:[e.profile.firstName," ",e.profile.lastName," (",e.profile.employeeNumber,")"]},e.id))]})]}),l.jsxs("div",{children:[l.jsx(g,{icon:pe,title:"Select Category",subtitle:"Choose the violation category"}),l.jsxs("select",{value:N.categoryId,onChange:e=>T("categoryId",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[l.jsx("option",{value:"",children:"Select a category..."}),n.map(e=>l.jsx("option",{value:e.id,children:e.name},e.id))]})]}),N.categoryId&&l.jsxs("div",{children:[l.jsx(g,{icon:Y,title:"Warning Level",subtitle:"Select the severity level given in the original warning"}),l.jsxs("select",{value:N.level,onChange:e=>T("level",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[l.jsx("option",{value:"",children:"Select warning level..."}),S.map(e=>l.jsx("option",{value:e,children:er[e]||e},e))]})]})]});case 1:return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Xs,{label:"Incident Date",value:N.incidentDate?N.incidentDate.toISOString().split("T")[0]:"",onChange:e=>T("incidentDate",e?new Date(e):null),icon:oe,required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When did the incident occur?"})]}),l.jsx(u,{icon:re,label:"Incident Time",type:"time",value:N.incidentTime,onChange:e=>T("incidentTime",e)}),l.jsxs("div",{children:[l.jsx(Xs,{label:"Issue Date",value:N.issueDate?N.issueDate.toISOString().split("T")[0]:"",onChange:e=>T("issueDate",e?new Date(e):null),icon:he,required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When was the warning issued?"})]}),l.jsxs("div",{children:[l.jsx(g,{icon:re,title:"Validity Period",subtitle:"How long is this warning active?"}),l.jsxs("select",{value:N.validityPeriod,onChange:e=>T("validityPeriod",parseInt(e.target.value)),className:"w-full h-11 px-4 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent",children:[l.jsx("option",{value:3,children:"3 months"}),l.jsx("option",{value:6,children:"6 months"}),l.jsx("option",{value:12,children:"12 months"})]}),N.expiryDate&&l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Will expire on: ",N.expiryDate.toLocaleDateString()]})]}),l.jsx(u,{icon:ne,label:"Warning Title",placeholder:"Brief summary of the warning",value:N.title,onChange:e=>T("title",e)}),l.jsx(u,{icon:ue,label:"Incident Location",placeholder:"Where did the incident occur?",value:N.incidentLocation,onChange:e=>T("incidentLocation",e)}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Incident Description *"}),l.jsx("textarea",{value:N.description,onChange:e=>T("description",e.target.value),rows:4,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Describe what happened in detail..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Additional Notes (Optional)"}),l.jsx("textarea",{value:N.additionalNotes,onChange:e=>T("additionalNotes",e.target.value),rows:3,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Any additional context or notes..."})]})]});case 2:return l.jsxs("div",{className:"space-y-4",children:[l.jsx(o,{children:l.jsx("div",{className:"space-y-4",children:l.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:N.hasPhysicalCopy,onChange:e=>T("hasPhysicalCopy",e.target.checked),className:"w-5 h-5 mt-0.5 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("span",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"I confirm the physical signed copy exists"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Required: You must have access to the original signed warning document"})]})]})})}),N.hasPhysicalCopy&&l.jsx(u,{icon:ne,label:"Physical Copy Location (Optional)",placeholder:"e.g., Filing Cabinet A3, HR Office",value:N.physicalCopyLocation,onChange:e=>T("physicalCopyLocation",e)}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Historical Entry Notes (Optional)"}),l.jsx("textarea",{value:N.historicalNotes,onChange:e=>T("historicalNotes",e.target.value),rows:3,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Any additional context about this historical entry..."})]}),l.jsx(Ys,{physicalCopyLocation:N.physicalCopyLocation||void 0})]});case 3:return l.jsxs("div",{className:"space-y-4",children:[l.jsx(o,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2",children:"Warning Summary"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Employee:"}),l.jsxs("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:[k?.profile.firstName," ",k?.profile.lastName]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Category:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:C?.name})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Level:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:er[N.level]||N.level})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Validity:"}),l.jsxs("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:[N.validityPeriod," months"]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Incident Date:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:N.incidentDate?.toLocaleDateString()})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Issue Date:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:N.issueDate?.toLocaleDateString()})]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Title:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:N.title})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Description:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:N.description})]})]})]})}),l.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(Y,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-semibold text-red-900 dark:text-red-100 mb-1",children:"This warning has NO digital signatures or audio recording"}),l.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:"Ensure the physical signed document is kept safe for legal compliance"})]})]})})]});default:return null}})()}),l.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-4 py-4 flex items-center justify-between",children:[l.jsx(d,{variant:"outline",onClick:0===x?M:P,disabled:y,icon:0===x?K:ce,children:0===x?"Cancel":"Back"}),l.jsx(d,{onClick:3===x?A:I,disabled:y,className:"flex items-center justify-center gap-2",children:y?"Saving...":3===x?l.jsxs(l.Fragment,{children:["Save Historical Warning ",l.jsx(xe,{className:"w-4 h-4"})]}):l.jsxs(l.Fragment,{children:["Next ",l.jsx(de,{className:"w-4 h-4"})]})})]})]})},sr=({notification:e,currentStep:t,onStepComplete:r,onDeliveryComplete:a,isProcessing:n})=>{const[i,m]=j.useState(!1),[x,h]=j.useState(!1),[u,g]=j.useState(!1),[p,y]=j.useState(null),[f,v]=j.useState(null),[b,N]=j.useState(!1),[w,k]=j.useState(!1),C=j.useCallback(()=>{const t=e.contactDetails.phone||e.employeePhone||"",s=t.replace(/[^\d]/g,"");return{message:`Hi ${e.employeeName},\n\nI hope this message finds you well. I'm writing to inform you that we need to discuss a ${e.warningLevel.toLowerCase()} regarding ${e.warningCategory.toLowerCase()}.\n\nI've attached the formal warning document for your review. Please read through it carefully and let me know if you have any questions or would like to schedule a meeting to discuss this matter further.\n\nThis is an important workplace matter that requires your immediate attention. Please confirm receipt of this message and the attached document.\n\nThank you for your cooperation.\n\nBest regards,\nHR Department`,phoneNumber:s,formattedPhone:t}},[e])();return l.jsxs("div",{className:"space-y-6",children:[0===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-green-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(ye,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Prepare WhatsApp Message"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Copy the pre-written script and download the PDF attachment"})]})]}),l.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(fe,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Employee Phone Number:"})]}),l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:C.formattedPhone||l.jsxs("span",{className:"text-red-500 text-sm",children:[l.jsx(Y,{className:"w-4 h-4 inline mr-1"}),"No phone number on file"]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WhatsApp Message Script:"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{value:C.message,readOnly:!0,className:"w-full h-48 p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm font-mono resize-none",style:{color:"var(--color-text)"}}),l.jsx(d,{variant:i?"success":"primary",size:"sm",onClick:async()=>{try{await navigator.clipboard.writeText(C.message),m(!0),setTimeout(()=>m(!1),3e3)}catch(e){s.error("Failed to copy script:",e)}},className:"absolute top-2 right-2",children:i?l.jsxs(l.Fragment,{children:[l.jsx(me,{className:"w-4 h-4 mr-1"}),"Copied!"]}):l.jsxs(l.Fragment,{children:[l.jsx(te,{className:"w-4 h-4 mr-1"}),"Copy Script"]})})]})]}),l.jsxs("div",{className:"mb-6 space-y-3",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(d,{variant:"secondary",onClick:()=>{k(!0)},className:"flex items-center gap-2",children:[l.jsx(ve,{className:"w-4 h-4"}),"Preview & Download PDF"]}),x&&l.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[l.jsx(ee,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"PDF Downloaded"})]})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"Use the preview to download the PDF, then attach it to your WhatsApp message"})]}),l.jsxs("div",{className:"space-y-2 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm "+(i?"text-green-600":"text-gray-500"),children:[i?l.jsx(ee,{className:"w-4 h-4"}):l.jsx(re,{className:"w-4 h-4"}),"Script copied to clipboard"]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm "+(x?"text-green-600":"text-gray-500"),children:[x?l.jsx(ee,{className:"w-4 h-4"}):l.jsx(re,{className:"w-4 h-4"}),"PDF downloaded for attachment"]})]}),l.jsx(d,{variant:"primary",onClick:()=>{i&&x&&r(0)},disabled:!i||!x,className:"w-full",children:i&&x?l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"Continue to Send Message"]}):l.jsxs(l.Fragment,{children:[l.jsx(re,{className:"w-4 h-4 mr-2"}),"Complete preparation steps above"]})})]}),1===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(ie,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Send via WhatsApp"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Open WhatsApp Web and send the message with PDF attachment"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(c,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Instructions:"}),l.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[l.jsx("li",{children:'Click "Open WhatsApp Web" below'}),l.jsx("li",{children:"The message will be pre-filled with the script"}),l.jsx("li",{children:"Attach the downloaded PDF file"}),l.jsx("li",{children:"Send the message"}),l.jsx("li",{children:"Wait for delivery confirmation (double blue ticks)"})]})]})}),l.jsxs(d,{variant:"primary",onClick:()=>{const e=encodeURIComponent(C.message),t=`https://web.whatsapp.com/send?phone=${C.phoneNumber}&text=${e}`;window.open(t,"_blank"),g(!0)},disabled:!C.phoneNumber,size:"lg",className:"w-full",children:[l.jsx(ie,{className:"w-5 h-5 mr-2"}),"Open WhatsApp Web"]}),u&&l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm mb-4",children:[l.jsx(ee,{className:"w-4 h-4"}),"WhatsApp Web opened"]}),l.jsxs(d,{variant:"primary",onClick:()=>{u&&r(1)},className:"w-full",children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"I've sent the message"]})]})]})]}),2===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-green-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(je,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: Confirm Delivery"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Upload screenshot proof of successful delivery"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(c,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Screenshot Requirements:"}),l.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[l.jsx("li",{children:"Show the sent message with timestamp"}),l.jsx("li",{children:"Display delivery confirmation (double blue ticks)"}),l.jsx("li",{children:"Include employee's phone number visible"}),l.jsx("li",{children:"Capture PDF attachment in the message"})]})]})}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[l.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){y(t);const e=new FileReader;e.onload=e=>{v(e.target?.result)},e.readAsDataURL(t)}},className:"hidden",id:"proof-upload"}),l.jsx("label",{htmlFor:"proof-upload",className:"cursor-pointer",children:f?l.jsxs("div",{className:"space-y-3",children:[l.jsx("img",{src:f,alt:"Delivery proof",className:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}),l.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[l.jsx(ee,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Screenshot uploaded"})]})]}):l.jsxs("div",{className:"space-y-3",children:[l.jsx(be,{className:"w-12 h-12 mx-auto text-gray-400"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-medium text-gray-700",children:"Upload Screenshot"}),l.jsx("div",{className:"text-sm text-gray-500",children:"Click to select image file"})]})]})})]}),l.jsx(d,{variant:"success",onClick:async()=>{if(p){N(!0);try{await a({warningId:e.warningId,deliveryMethod:"whatsapp",deliveredAt:new Date,proofImage:p,phoneNumber:C.formattedPhone})}catch(t){s.error("Failed to complete delivery:",t)}finally{N(!1)}}},disabled:!p||b,size:"lg",className:"w-full",children:b?l.jsxs(l.Fragment,{children:[l.jsx(ae,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Delivery..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"Complete WhatsApp Delivery"]})})]})]}),w&&l.jsx(Qs,{isOpen:w,onClose:()=>k(!1),warningData:{employee:{firstName:e.employeeName.split(" ")[0]||e.employeeName,lastName:e.employeeName.split(" ").slice(1).join(" ")||"",employeeNumber:"EMP001",department:"N/A"},category:e.warningCategory,level:e.warningLevel,description:"Warning document details",incidentDate:new Date,issueDate:new Date},onDownload:()=>{h(!0)}})]})},rr=({notification:e,currentStep:t,onStepComplete:r,onDeliveryComplete:a,isProcessing:n})=>{const[i,m]=j.useState(!1),[x,h]=j.useState(!1),[u,g]=j.useState(!1),[p,y]=j.useState(null),[f,v]=j.useState(null),[b,N]=j.useState(!1),[w,k]=j.useState(!1),C=j.useCallback(()=>{const t=e.contactDetails.email||e.employeeEmail||"";return{subject:`Important: ${e.warningLevel} - ${e.warningCategory}`,body:`Dear ${e.employeeName},\n\nI hope this email finds you well. I am writing to formally notify you of a disciplinary matter that requires your immediate attention.\n\nSubject: ${e.warningLevel}\nCategory: ${e.warningCategory}\n\nPlease find attached the formal warning document that outlines the details of this matter. It is crucial that you review this document thoroughly and understand its contents.\n\nKey Points:\n• This is a formal disciplinary action\n• Please read the attached document carefully\n• You have the right to respond or appeal this decision\n• Further incidents may result in additional disciplinary action\n\nIf you have any questions or wish to discuss this matter, please do not hesitate to contact me or schedule a meeting with HR.\n\nPlease confirm receipt of this email and the attached document by replying to this message.\n\nThank you for your attention to this matter.\n\nBest regards,\n${e.createdByName||"HR Department"}\nHuman Resources Department`,to:t}},[e])();return l.jsxs("div",{className:"space-y-6",children:[0===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(Ne,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Prepare Email"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Copy the professional email template and download the PDF attachment"})]})]}),l.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(ge,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Employee Email:"})]}),l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:C.to||l.jsxs("span",{className:"text-red-500 text-sm",children:[l.jsx(Y,{className:"w-4 h-4 inline mr-1"}),"No email address on file"]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Subject:"}),l.jsx("div",{className:"relative",children:l.jsx("input",{value:C.subject,readOnly:!0,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm font-medium",style:{color:"var(--color-text)"}})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Message Template:"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{value:C.body,readOnly:!0,className:"w-full h-64 p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm resize-none",style:{color:"var(--color-text)"}}),l.jsxs("div",{className:"absolute top-2 right-2 space-x-2",children:[l.jsx(d,{variant:i?"success":"primary",size:"sm",onClick:async()=>{try{const e=`To: ${C.to}\nSubject: ${C.subject}\n\n${C.body}`;await navigator.clipboard.writeText(e),m(!0),setTimeout(()=>m(!1),3e3)}catch(e){s.error("Failed to copy template:",e)}},children:i?l.jsxs(l.Fragment,{children:[l.jsx(me,{className:"w-4 h-4 mr-1"}),"Copied!"]}):l.jsxs(l.Fragment,{children:[l.jsx(te,{className:"w-4 h-4 mr-1"}),"Copy Full Email"]})}),l.jsxs(d,{variant:"secondary",size:"sm",onClick:async()=>{try{await navigator.clipboard.writeText(C.body),m(!0),setTimeout(()=>m(!1),3e3)}catch(e){s.error("Failed to copy email body:",e)}},children:[l.jsx(te,{className:"w-4 h-4 mr-1"}),"Body Only"]})]})]})]}),l.jsxs("div",{className:"mb-6 space-y-3",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(d,{variant:"secondary",onClick:()=>{k(!0)},className:"flex items-center gap-2",children:[l.jsx(ve,{className:"w-4 h-4"}),"Preview & Download PDF"]}),x&&l.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[l.jsx(ee,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"PDF Downloaded"})]})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"Use the preview to download the PDF, then attach it to your email"})]}),l.jsxs("div",{className:"space-y-2 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm "+(i?"text-green-600":"text-gray-500"),children:[i?l.jsx(ee,{className:"w-4 h-4"}):l.jsx(re,{className:"w-4 h-4"}),"Email template copied to clipboard"]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm "+(x?"text-green-600":"text-gray-500"),children:[x?l.jsx(ee,{className:"w-4 h-4"}):l.jsx(re,{className:"w-4 h-4"}),"PDF downloaded for attachment"]})]}),l.jsx(d,{variant:"primary",onClick:()=>{i&&x&&r(0)},disabled:!i||!x,className:"w-full",children:i&&x?l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"Continue to Send Email"]}):l.jsxs(l.Fragment,{children:[l.jsx(re,{className:"w-4 h-4 mr-2"}),"Complete preparation steps above"]})})]}),1===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-green-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(we,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Send Email"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Open your email client and send the message with PDF attachment"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(c,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Instructions:"}),l.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[l.jsx("li",{children:'Click "Open Email Client" below'}),l.jsx("li",{children:"Your default email application will open with pre-filled content"}),l.jsx("li",{children:"Attach the downloaded PDF file"}),l.jsx("li",{children:"Review the email content and recipient"}),l.jsx("li",{children:"Send the email"}),l.jsx("li",{children:"Wait for delivery confirmation if available"})]})]})}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"font-medium text-gray-700",children:"To:"}),l.jsx("span",{className:"text-gray-900",children:C.to})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Subject:"}),l.jsx("span",{className:"text-gray-900",children:C.subject})]})]}),l.jsxs(d,{variant:"primary",onClick:()=>{const e=encodeURIComponent(C.subject),t=encodeURIComponent(C.body),s=`mailto:${encodeURIComponent(C.to)}?subject=${e}&body=${t}`;window.location.href=s,g(!0)},disabled:!C.to,size:"lg",className:"w-full",children:[l.jsx(ie,{className:"w-5 h-5 mr-2"}),"Open Email Client"]}),u&&l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm mb-4",children:[l.jsx(ee,{className:"w-4 h-4"}),"Email client opened"]}),l.jsxs(d,{variant:"primary",onClick:()=>{u&&r(1)},className:"w-full",children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"I've sent the email"]})]})]})]}),2===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-purple-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:l.jsx(je,{className:"w-5 h-5 text-purple-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: Confirm Delivery"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Upload screenshot proof of successful email delivery"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(c,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Screenshot Requirements:"}),l.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[l.jsx("li",{children:'Show the sent email in your "Sent" folder'}),l.jsx("li",{children:"Display recipient email address clearly"}),l.jsx("li",{children:"Include timestamp/date sent"}),l.jsx("li",{children:"Show PDF attachment in the email"}),l.jsx("li",{children:"Capture any delivery confirmation if available"})]})]})}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[l.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){y(t);const e=new FileReader;e.onload=e=>{v(e.target?.result)},e.readAsDataURL(t)}},className:"hidden",id:"proof-upload"}),l.jsx("label",{htmlFor:"proof-upload",className:"cursor-pointer",children:f?l.jsxs("div",{className:"space-y-3",children:[l.jsx("img",{src:f,alt:"Delivery proof",className:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}),l.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[l.jsx(ee,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Screenshot uploaded"})]})]}):l.jsxs("div",{className:"space-y-3",children:[l.jsx(be,{className:"w-12 h-12 mx-auto text-gray-400"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-medium text-gray-700",children:"Upload Screenshot"}),l.jsx("div",{className:"text-sm text-gray-500",children:"Click to select image file"})]})]})})]}),l.jsx(d,{variant:"success",onClick:async()=>{if(p){N(!0);try{await a({warningId:e.warningId,deliveryMethod:"email",deliveredAt:new Date,proofImage:p,emailAddress:C.to})}catch(t){s.error("Failed to complete delivery:",t)}finally{N(!1)}}},disabled:!p||b,size:"lg",className:"w-full",children:b?l.jsxs(l.Fragment,{children:[l.jsx(ae,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Delivery..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"Complete Email Delivery"]})})]})]}),w&&l.jsx(Qs,{isOpen:w,onClose:()=>k(!1),warningData:{employee:{firstName:e.employeeName.split(" ")[0]||e.employeeName,lastName:e.employeeName.split(" ").slice(1).join(" ")||"",employeeNumber:"EMP001",department:"N/A"},category:e.warningCategory,level:e.warningLevel,description:"Warning document details",incidentDate:new Date,issueDate:new Date},onDownload:()=>{h(!0)}})]})},ar=({notification:e,currentStep:t,onStepComplete:r,onDeliveryComplete:a,isProcessing:n})=>{const[i,m]=j.useState(!1),[x,h]=j.useState(!1),[u,g]=j.useState([{id:"hand_delivered",label:"Hand delivered to employee",completed:!1,required:!0,description:"Personally delivered the printed warning to the employee"},{id:"employee_present",label:"Employee was present during delivery",completed:!1,required:!0,description:"Confirmed employee identity and presence during delivery"},{id:"signature_obtained",label:"Employee signature obtained",completed:!1,required:!0,description:"Employee signed acknowledgment of receipt on physical document"},{id:"copy_filed",label:"Signed copy filed in employee records",completed:!1,required:!0,description:"Filed the signed physical copy in the employee's personnel file"}]),[p,y]=j.useState([{id:"original_filed",label:"Original signed document filed",completed:!1,required:!0,description:"Original signed warning document placed in employee's personnel file"},{id:"copy_retained",label:"Copy retained by HR",completed:!1,required:!0,description:"Photocopy of signed document retained in HR files"},{id:"system_updated",label:"Digital system updated",completed:!1,required:!0,description:"Employee record system updated to reflect warning delivery"}]),[f,v]=j.useState({deliveryDate:(new Date).toISOString().split("T")[0],deliveryTime:(new Date).toTimeString().split(" ")[0].slice(0,5),deliveryLocation:"",witnessName:"",additionalNotes:""}),b=j.useCallback(()=>{if(e.pdfUrl){const t=window.open(e.pdfUrl,"_blank");t&&(t.onload=()=>{t.print(),m(!0)})}else h(!0)},[e.pdfUrl]),N=(e,t)=>{"delivery"===e?g(e=>e.map(e=>e.id===t?{...e,completed:!e.completed}:e)):y(e=>e.map(e=>e.id===t?{...e,completed:!e.completed}:e))},w=u.filter(e=>e.required).every(e=>e.completed),k=p.filter(e=>e.required).every(e=>e.completed);return l.jsxs("div",{className:"space-y-6",children:[0===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-purple-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:l.jsx(ke,{className:"w-5 h-5 text-purple-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Print Warning Document"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Print the official warning document for hand delivery"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(c,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Printing Requirements:"}),l.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[l.jsx("li",{children:"Print on official company letterhead if available"}),l.jsx("li",{children:"Use high-quality paper (minimum 80gsm)"}),l.jsx("li",{children:"Ensure all text is clearly legible"}),l.jsx("li",{children:"Print multiple copies (original + HR copy)"})]})]})}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(ge,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Employee:"}),l.jsx("span",{children:e.employeeName})]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(ne,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Warning Type:"}),l.jsx("span",{children:e.warningLevel})]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(oe,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Issue Date:"}),l.jsx("span",{children:e.createdAt.toLocaleDateString()})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(d,{variant:"secondary",onClick:()=>{h(!0)},className:"flex items-center gap-2",children:[l.jsx(ve,{className:"w-4 h-4"}),"Preview Document"]}),l.jsxs(d,{variant:"primary",onClick:b,className:"flex items-center gap-2",children:[l.jsx(ke,{className:"w-4 h-4"}),"Print Document"]})]}),i&&l.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[l.jsx(ee,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Document printed successfully"})]})]}),l.jsx(d,{variant:"primary",onClick:()=>{i&&r(0)},disabled:!i,className:"w-full",children:i?l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"Continue to Hand Delivery"]}):l.jsxs(l.Fragment,{children:[l.jsx(re,{className:"w-4 h-4 mr-2"}),"Print document to continue"]})})]})]}),1===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-green-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(ge,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Hand Delivery to Employee"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Deliver the printed document and obtain employee acknowledgment"})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Date"}),l.jsx("input",{type:"date",value:f.deliveryDate,onChange:e=>v(t=>({...t,deliveryDate:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Time"}),l.jsx("input",{type:"time",value:f.deliveryTime,onChange:e=>v(t=>({...t,deliveryTime:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Location"}),l.jsx("input",{type:"text",placeholder:"e.g., Employee's office, HR meeting room",value:f.deliveryLocation,onChange:e=>v(t=>({...t,deliveryLocation:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Witness Name (Optional)"}),l.jsx("input",{type:"text",placeholder:"Name of witness present during delivery",value:f.witnessName,onChange:e=>v(t=>({...t,witnessName:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]})]}),l.jsxs("div",{children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(ee,{className:"w-5 h-5 text-green-600"}),"Delivery Checklist"]}),l.jsx("div",{className:"space-y-3",children:u.map(e=>l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>N("delivery",e.id),className:"mt-1 w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"font-medium "+(e.completed?"text-green-600":"text-gray-900"),children:[e.label,e.required&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsx("div",{className:"text-sm text-gray-600",children:e.description})]}),e.completed&&l.jsx(ee,{className:"w-5 h-5 text-green-600 mt-1"})]},e.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),l.jsx("textarea",{rows:3,placeholder:"Any additional notes about the delivery process...",value:f.additionalNotes,onChange:e=>v(t=>({...t,additionalNotes:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),l.jsx(d,{variant:"primary",onClick:()=>{w&&r(1)},disabled:!w,className:"w-full",children:w?l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"Continue to Filing"]}):l.jsxs(l.Fragment,{children:[l.jsx(re,{className:"w-4 h-4 mr-2"}),"Complete all required items above"]})})]})]}),2===t&&l.jsxs(o,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(Ce,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: File Documentation"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"File the signed documents and complete the delivery process"})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(c,{variant:"warning",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Important:"})," Proper filing is crucial for legal compliance and audit purposes. Ensure all documents are filed in the correct employee personnel file."]})}),l.jsxs("div",{children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(Ce,{className:"w-5 h-5 text-blue-600"}),"Filing Checklist"]}),l.jsx("div",{className:"space-y-3",children:p.map(e=>l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>N("filing",e.id),className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"font-medium "+(e.completed?"text-blue-600":"text-gray-900"),children:[e.label,e.required&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsx("div",{className:"text-sm text-gray-600",children:e.description})]}),e.completed&&l.jsx(ee,{className:"w-5 h-5 text-blue-600 mt-1"})]},e.id))})]}),l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h5",{className:"font-semibold text-blue-900 mb-2",children:"Delivery Summary"}),l.jsxs("div",{className:"space-y-1 text-sm text-blue-800",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Employee:"})," ",e.employeeName]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Warning Type:"})," ",e.warningLevel]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Delivery Date:"})," ",f.deliveryDate," at ",f.deliveryTime]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Location:"})," ",f.deliveryLocation||"Not specified"]}),f.witnessName&&l.jsxs("div",{children:[l.jsx("strong",{children:"Witness:"})," ",f.witnessName]})]})]}),l.jsx(d,{variant:"success",onClick:async()=>{if(k)try{await a({warningId:e.warningId,deliveryMethod:"printed",deliveredAt:new Date(`${f.deliveryDate}T${f.deliveryTime}`),deliveryLocation:f.deliveryLocation,witnessName:f.witnessName,additionalNotes:f.additionalNotes,deliveryChecklist:u,filingChecklist:p})}catch(t){s.error("Failed to complete delivery:",t)}},disabled:!k||n,size:"lg",className:"w-full",children:n?l.jsxs(l.Fragment,{children:[l.jsx(ae,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Process..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-2"}),"Complete Print Delivery Process"]})})]})]}),x&&l.jsx(Qs,{isOpen:x,onClose:()=>h(!1),warningData:{employee:{firstName:e.employeeName.split(" ")[0]||e.employeeName,lastName:e.employeeName.split(" ").slice(1).join(" ")||"",employeeNumber:"EMP001",department:"N/A"},category:e.warningCategory,level:e.warningLevel,description:"Warning document details",incidentDate:new Date,issueDate:new Date},onDownload:()=>{m(!0)},showPrintButton:!0})]})},nr=({notification:e,onDeliveryComplete:t,onClose:s,isOpen:r})=>{const[a,n]=j.useState(0),[i,o]=j.useState([]),[m,x]=j.useState(!1),[h,u]=j.useState(null);j.useEffect(()=>{o((()=>{switch(e.deliveryMethod){case"whatsapp":return[{id:"prepare",label:"Prepare Message",completed:!1,inProgress:!0,description:"Copy pre-written script and download PDF"},{id:"send",label:"Send via WhatsApp",completed:!1,inProgress:!1,description:"Open WhatsApp and send message with attachment"},{id:"confirm",label:"Confirm Delivery",completed:!1,inProgress:!1,description:"Upload screenshot proof and complete delivery"}];case"email":return[{id:"prepare",label:"Prepare Email",completed:!1,inProgress:!0,description:"Copy email template and download PDF attachment"},{id:"send",label:"Send Email",completed:!1,inProgress:!1,description:"Open email client and send message"},{id:"confirm",label:"Confirm Delivery",completed:!1,inProgress:!1,description:"Upload screenshot proof and complete delivery"}];case"printed":return[{id:"print",label:"Print Document",completed:!1,inProgress:!0,description:"Print warning PDF document"},{id:"deliver",label:"Hand Deliver",completed:!1,inProgress:!1,description:"Deliver to employee and obtain signature"},{id:"file",label:"File Documentation",completed:!1,inProgress:!1,description:"File signed copy and confirm completion"}];default:return[]}})())},[e.deliveryMethod]);const g=(()=>{switch(e.deliveryMethod){case"whatsapp":return{icon:ye,name:"WhatsApp Business",color:"green",bgClass:"bg-green-50 border-green-200",textClass:"text-green-700"};case"email":return{icon:Ne,name:"Email",color:"blue",bgClass:"bg-blue-50 border-blue-200",textClass:"text-blue-700"};case"printed":return{icon:ke,name:"Print & Hand Delivery",color:"purple",bgClass:"bg-purple-50 border-purple-200",textClass:"text-purple-700"};default:return{icon:ne,name:"Unknown",color:"gray",bgClass:"bg-gray-50 border-gray-200",textClass:"text-gray-700"}}})(),y=e=>{o(t=>t.map((t,s)=>s===e?{...t,completed:!0,inProgress:!1}:s===e+1?{...t,inProgress:!0}:t)),e<i.length-1&&n(e+1)},f=async r=>{x(!0);try{await t(e.id,{...r,deliveryMethod:e.deliveryMethod,completedAt:new Date,steps:i}),s()}catch(a){u("Failed to complete delivery. Please try again.")}finally{x(!1)}};return r?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[95vh] flex flex-col shadow-2xl",children:[l.jsx("div",{className:`p-6 border-b flex-shrink-0 ${g.bgClass}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"p-3 rounded-xl bg-white shadow-sm",children:l.jsx(g.icon,{className:`w-6 h-6 ${g.textClass}`})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-bold",style:{color:"var(--color-text)"},children:[g.name," Delivery"]}),l.jsxs("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:["Guided delivery workflow for ",e.employeeName]})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(p,{variant:e.priority,size:"sm",children:e.priority.toUpperCase()}),l.jsx(d,{variant:"ghost",size:"sm",onClick:s,children:l.jsx(K,{className:"w-4 h-4"})})]})]})}),l.jsxs("div",{className:"p-4 bg-gray-50 border-b flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ge,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-semibold text-gray-900",children:e.employeeName})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(se,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-600",children:e.warningLevel})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ne,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-600",children:e.warningCategory})]})]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[l.jsx(oe,{className:"w-4 h-4"}),e.createdAt.toLocaleDateString()]})]}),(e.contactDetails.email||e.contactDetails.phone)&&l.jsxs("div",{className:"mt-3 flex items-center gap-4",children:[e.contactDetails.email&&l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(Ne,{className:"w-4 h-4 text-gray-400"}),l.jsx("span",{className:"text-gray-600",children:e.contactDetails.email})]}),e.contactDetails.phone&&l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(fe,{className:"w-4 h-4 text-gray-400"}),l.jsx("span",{className:"text-gray-600",children:e.contactDetails.phone})]})]})]}),l.jsx("div",{className:"p-6 border-b bg-white flex-shrink-0",children:l.jsx("div",{className:"flex items-center justify-between",children:i.map((e,t)=>l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`\n                    w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium transition-all\n                    ${e.completed?"bg-green-500 text-white":e.inProgress?"bg-blue-500 text-white animate-pulse":"bg-gray-200 text-gray-500"}\n                  `,children:e.completed?l.jsx(ee,{className:"w-5 h-5"}):e.inProgress?l.jsx(re,{className:"w-5 h-5"}):t+1}),l.jsxs("div",{className:"mt-2 text-center",children:[l.jsx("div",{className:"text-sm font-medium "+(e.completed||e.inProgress?"text-gray-900":"text-gray-500"),children:e.label}),l.jsx("div",{className:"text-xs text-gray-500 mt-1 max-w-32",children:e.description})]})]}),t<i.length-1&&l.jsx(Se,{className:"w-5 h-5 mx-4 "+(e.completed?"text-green-500":"text-gray-300")})]},e.id))})}),h&&l.jsx("div",{className:"p-4 flex-shrink-0",children:l.jsx(c,{variant:"error",children:h})}),l.jsxs("div",{className:"p-6 flex-1 overflow-y-auto min-h-0",children:["whatsapp"===e.deliveryMethod&&l.jsx(sr,{notification:e,currentStep:a,onStepComplete:y,onDeliveryComplete:f,isProcessing:m}),"email"===e.deliveryMethod&&l.jsx(rr,{notification:e,currentStep:a,onStepComplete:y,onDeliveryComplete:f,isProcessing:m}),"printed"===e.deliveryMethod&&l.jsx(ar,{notification:e,currentStep:a,onStepComplete:y,onDeliveryComplete:f,isProcessing:m})]}),l.jsxs("div",{className:"p-4 border-t bg-gray-50 flex items-center justify-between flex-shrink-0",children:[l.jsxs("div",{className:"text-sm text-gray-500",children:["Step ",a+1," of ",i.length]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(d,{variant:"ghost",size:"sm",onClick:s,children:"Cancel"}),m&&l.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[l.jsx(J,{className:"w-4 h-4 animate-spin"}),"Processing..."]})]})]})]})}):null},ir=j.memo(({className:n=""})=>{const i=w(),{user:m}=e(),{organization:h,categories:u}=x(),g=(e=>{const[t,s]=j.useState(window.innerWidth>e),r=j.useCallback(()=>s(window.innerWidth>e),[e]);return j.useEffect(()=>(window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)),[r]),t})(768),[p,b]=j.useState(null),[N,T]=j.useState(null),{employees:E,warnings:I,error:P,refreshData:A}=y({role:"hr"}),{hrReportsCount:M,hrCountsLoading:R,hrCountsError:_}=(()=>{const{user:a}=e(),{canManageHR:n}=t(),[i,l]=j.useState({absenceReports:{unread:0,total:0},hrMeetings:{unread:0,total:0},correctiveCounselling:{unread:0,total:0}}),[o,c]=j.useState(!0),[d,m]=j.useState(null),[x,h]=j.useState(null),u=j.useRef([]),g=j.useRef(!0),p=j.useRef(!1),y=j.useCallback(async()=>{a?.organizationId&&n()&&(m(null),h(new Date))},[a?.organizationId,n]);return j.useEffect(()=>{if(!p.current){if(g.current=!0,!n()||!a?.organizationId)return c(!1),void(p.current=!0);c(!0),m(null),u.current.forEach(e=>{try{e()}catch(t){s.warn("⚠️ Error unsubscribing:",t)}}),u.current=[];try{const e=k(C(r,`organizations/${a.organizationId}/reports`),S("absenceDate","desc")),t=D(e,e=>{if(!g.current)return;const t=e.docs.filter(e=>"_metadata"!==e.id).map(e=>({id:e.id,...e.data()})),s=t.filter(e=>!e.hrReviewed).length;l(e=>({...e,absenceReports:{unread:s,total:t.length}})),h(new Date),t.length},e=>{s.error("❌ Absence reports listener error:",e),g.current&&m("Failed to load absence reports")});u.current.push(t);const n=k(C(r,`organizations/${a.organizationId}/meetings`),S("createdAt","desc")),i=D(n,e=>{if(!g.current)return;const t=e.docs.filter(e=>"_metadata"!==e.id).map(e=>({id:e.id,...e.data()})),s=t.filter(e=>"pending"===e.status).length;l(e=>({...e,hrMeetings:{unread:s,total:t.length}})),h(new Date),t.length},e=>{s.error("❌ HR meetings listener error:",e),g.current&&m("Failed to load HR meetings")});u.current.push(i);const o=k(C(r,`organizations/${a.organizationId}/corrective_counselling`),S("dateCreated","desc")),d=D(o,e=>{if(!g.current)return;const t=e.docs.filter(e=>"_metadata"!==e.id).map(e=>({id:e.id,...e.data()})),s=t.filter(e=>new Date(e.dateCreated)>new Date(Date.now()-6048e5)&&!e.hrReviewed).length;l(e=>({...e,correctiveCounselling:{unread:s,total:t.length}})),h(new Date),t.length},e=>{s.error("❌ Corrective counselling listener error:",e),g.current&&m("Failed to load counselling records")});u.current.push(d),setTimeout(()=>{g.current&&c(!1)},1e3)}catch(e){s.error("❌ Error setting up listeners:",e),m("Failed to initialize real-time data"),c(!1)}return p.current=!0,()=>{g.current=!1,u.current.forEach(t=>{try{t()}catch(e){s.warn("⚠️ Error during cleanup:",e)}}),u.current=[],p.current=!1}}},[]),j.useEffect(()=>{n()&&a?.organizationId||(l({absenceReports:{unread:0,total:0},hrMeetings:{unread:0,total:0}}),c(!1),m(null),h(null),p.current=!1)},[n(),a?.organizationId]),{hrReportsCount:i,hrCountsLoading:o,hrCountsError:d,refreshHRCounts:y,lastUpdated:x}})(),[F,L]=j.useState(!1),[z,U]=j.useState(!1),[W,O]=j.useState(null),[$,q]=j.useState(!1),H=((e,t,r)=>{const[n,i]=j.useState(!0),[l,o]=j.useState(null),[c,d]=j.useState(null);j.useEffect(()=>{(async()=>{if(e&&t)try{i(!0);const n=await a.getDocument(t,"users",e);if(!n)return s.error("User document not found for countdown feature"),void i(!1);const l=n?.features?.historicalWarningEntry;if(l?.firstAccessedAt){const e=l.firstAccessedAt.toDate?l.firstAccessedAt.toDate():new Date(l.firstAccessedAt),t=l.expiresAt.toDate?l.expiresAt.toDate():new Date(l.expiresAt);o({firstAccessedAt:e,expiresAt:t}),Math.ceil((t.getTime()-Date.now())/864e5)}else if(r){const s=new Date,r=new Date(s.getTime()+5184e6),n={"features.historicalWarningEntry":{firstAccessedAt:s,expiresAt:r}};await a.updateDocument(t,"users",e,n),o({firstAccessedAt:s,expiresAt:r})}}catch(n){s.error("Failed to initialize historical warning countdown:",n)}finally{i(!1)}else i(!1)})()},[e,t,r]),j.useEffect(()=>{if(!l)return void d(null);const e=()=>{const e=Date.now(),t=l.expiresAt.getTime()-e,s=Math.floor(t/864e5);d(Math.max(0,s))};e();const t=setInterval(e,36e5);return()=>clearInterval(t)},[l]);const{level:m,text:x}=null!==c&&l?0===c?{level:"urgent",text:"Enter Historical Warning (Last day!)"}:1===c?{level:"urgent",text:"Enter Historical Warning (1 day left!)"}:c<=7?{level:"warning",text:`Enter Historical Warning (${c} days left - Hurry!)`}:c<=14?{level:"warning",text:`Enter Historical Warning (${c} days left)`}:{level:"normal",text:`Enter Historical Warning (${c} days left)`}:{level:"normal",text:"Enter Historical Warning"},h=null!==c&&c<=0;return{daysRemaining:c,isExpired:h,isActive:!h&&null!==l,loading:n,urgencyLevel:m,displayText:x}})(m?.uid,h?.id,"warnings"===p),V={totalActive:I?.length||0,undelivered:I?.filter(e=>!e.delivered&&"expired"!==e.status)?.length||0,highSeverity:I?.filter(e=>("high"===e.severity||"gross_misconduct"===e.category?.severity)&&"expired"!==e.status)?.length||0},G={totalEmployees:E?.length||0,activeEmployees:E?.filter(e=>!1!==e.isActive)?.length||0,newEmployees:E?.filter(e=>new Date(e.createdAt||e.metadata?.createdAt||0)>new Date(Date.now()-2592e6))?.length||0};return j.useEffect(()=>{const e=e=>{const{employeeId:t}=e.detail,s=localStorage.getItem("warningFilterEmployeeName");t&&s&&(T({id:t,name:s}),b("warnings"),localStorage.removeItem("warningFilterEmployeeId"),localStorage.removeItem("warningFilterEmployeeName"))};return window.addEventListener("navigateToWarnings",e),()=>{window.removeEventListener("navigateToWarnings",e)}},[]),g?l.jsxs("div",{className:`${n}`,children:[l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-3 mb-6",children:[l.jsx(o,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/absence-reports"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-error), var(--color-error))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(De,{className:"w-8 h-8",style:{opacity:.7}}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Absence Reports"}),l.jsx("div",{className:"text-2xl font-bold",children:M.absenceReports.unread}),l.jsxs("div",{className:"text-xs mt-0.5",style:{opacity:.8},children:[M.absenceReports.total," total"]})]})]})}),l.jsx(o,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/meeting-requests"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-accent), var(--color-accent))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Te,{className:"w-8 h-8",style:{opacity:.7}}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Meeting Requests"}),l.jsx("div",{className:"text-2xl font-bold",children:M.hrMeetings.unread}),l.jsxs("div",{className:"text-xs mt-0.5",style:{opacity:.8},children:[M.hrMeetings.total," total"]})]})]})}),l.jsx(o,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/corrective-counselling"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-primary), var(--color-primary))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ee,{className:"w-8 h-8",style:{opacity:.7}}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Counselling"}),l.jsx("div",{className:"text-2xl font-bold",children:M.correctiveCounselling.unread}),l.jsxs("div",{className:"text-xs mt-0.5",style:{opacity:.8},children:[M.correctiveCounselling.total," total"]})]})]})}),l.jsx(o,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>b("warnings"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-warning), var(--color-warning))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(se,{className:"w-8 h-8",style:{opacity:.7}}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Active Warnings"}),l.jsx("div",{className:"text-2xl font-bold",children:V.totalActive}),l.jsxs("div",{className:"text-xs mt-0.5",style:{opacity:.8},children:[V.undelivered," undelivered"]})]})]})})]}),(P||_)&&l.jsx(c,{variant:"error",className:"mb-4",children:l.jsxs("div",{className:"text-sm",children:["Failed to load dashboard data: ",P||_]})}),l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"flex space-x-6 px-4",children:[{id:"urgent",label:"Urgent Tasks",icon:Y,count:M.absenceReports.unread+M.hrMeetings.unread+V.undelivered},{id:"warnings",label:"Warnings",icon:se},{id:"employees",label:"Employees",icon:Ie}].map(e=>l.jsxs("button",{onClick:()=>b(e.id),className:"flex items-center gap-2 py-3 px-1 border-b-2 text-sm font-medium transition-colors relative "+(p===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[l.jsx(e.icon,{className:"w-4 h-4"}),e.label,e.count&&e.count>0&&l.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center ml-1",children:e.count})]},e.id))})}),l.jsxs("div",{className:"p-4",children:["urgent"===p&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-white rounded-lg border border-red-200 shadow-sm",children:[l.jsxs("div",{className:"p-4 border-b border-red-100 bg-red-50",children:[l.jsxs("h3",{className:"text-lg font-semibold text-red-900 flex items-center gap-2",children:[l.jsx(Y,{className:"w-5 h-5"}),"Urgent Tasks Requiring Immediate Attention"]}),l.jsx("p",{className:"text-sm text-red-700 mt-1",children:"These items need your immediate review and action"})]}),l.jsxs("div",{className:"divide-y divide-gray-100",children:[M.absenceReports.unread>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>i("/hr/absence-reports"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[M.absenceReports.unread," Unread Absence Reports"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Employees reporting absences requiring approval"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full font-medium",children:[M.absenceReports.unread," pending"]}),l.jsx(De,{className:"w-4 h-4 text-gray-400"})]})]})}),M.hrMeetings.unread>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>i("/hr/meeting-requests"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[M.hrMeetings.unread," New Meeting Requests"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Employees requesting HR consultations"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full font-medium",children:[M.hrMeetings.unread," requests"]}),l.jsx(Te,{className:"w-4 h-4 text-gray-400"})]})]})}),V.undelivered>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>b("warnings"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[V.undelivered," Undelivered Warnings"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Warning documents pending delivery to employees"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full font-medium",children:"Urgent"}),l.jsx(Y,{className:"w-4 h-4 text-gray-400"})]})]})}),V.highSeverity>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>b("warnings"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-red-600 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[V.highSeverity," High Priority Cases"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Final warnings and dismissal cases requiring oversight"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full font-medium",children:"Critical"}),l.jsx(Y,{className:"w-4 h-4 text-gray-400"})]})]})}),0===M.absenceReports.unread&&0===M.hrMeetings.unread&&0===V.undelivered&&0===V.highSeverity&&l.jsxs("div",{className:"p-8 text-center text-gray-500",children:[l.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:l.jsx(se,{className:"w-8 h-8 text-green-600"})}),l.jsx("div",{className:"font-medium text-gray-700",children:"All caught up!"}),l.jsx("div",{className:"text-sm",children:"No urgent tasks requiring immediate attention"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(re,{className:"w-4 h-4 text-gray-600"}),"Today's Activity"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"New Reports"}),l.jsx("span",{className:"font-medium text-gray-900",children:M.absenceReports.unread})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Meetings"}),l.jsx("span",{className:"font-medium text-gray-900",children:M.hrMeetings.unread})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Counselling"}),l.jsx("span",{className:"font-medium text-gray-900",children:M.correctiveCounselling.unread})]})]})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(Pe,{className:"w-4 h-4 text-blue-600"}),"Team Status"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Total Employees"}),l.jsx("span",{className:"font-medium text-gray-900",children:G.totalEmployees})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Active"}),l.jsx("span",{className:"font-medium text-green-600",children:G.activeEmployees})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"New This Month"}),l.jsx("span",{className:"font-medium text-blue-600",children:G.newEmployees})]})]})]}),l.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(se,{className:"w-4 h-4 text-orange-600"}),"Warning Overview"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Active"}),l.jsx("span",{className:"font-medium text-gray-900",children:V.totalActive})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Undelivered"}),l.jsx("span",{className:"font-medium text-orange-600",children:V.undelivered})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"High Priority"}),l.jsx("span",{className:"font-medium text-red-600",children:V.highSeverity})]})]})]})]})]}),"warnings"===p&&l.jsxs("div",{className:"space-y-4",children:[!H.isExpired&&l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Warnings Management"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Digital and historical warning records"})]}),l.jsx(d,{variant:"outline",size:"md",icon:ne,onClick:()=>L(!0),className:""+("urgent"===H.urgencyLevel?"border-red-500 text-red-700 hover:bg-red-50 font-semibold animate-pulse":"warning"===H.urgencyLevel?"border-orange-500 text-orange-700 hover:bg-orange-50 font-semibold":"border-amber-500 text-amber-700 hover:bg-amber-50"),children:H.loading?"Enter Historical Warning":H.displayText})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsx("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Y,{className:"w-8 h-8 text-orange-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:V.undelivered}),l.jsx("div",{className:"text-sm text-orange-700",children:"Undelivered Warnings"}),l.jsx("div",{className:"text-xs text-orange-600",children:"Require immediate attention"})]})]})}),l.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(se,{className:"w-8 h-8 text-red-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:V.highSeverity}),l.jsx("div",{className:"text-sm text-red-700",children:"High Severity"}),l.jsx("div",{className:"text-xs text-red-600",children:"Final warnings & dismissals"})]})]})}),l.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(ne,{className:"w-8 h-8 text-blue-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:V.totalActive}),l.jsx("div",{className:"text-sm text-blue-700",children:"Total Active"}),l.jsx("div",{className:"text-xs text-blue-600",children:"All current warnings"})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200",children:l.jsx(B,{initialEmployeeFilter:N||void 0})})]}),"employees"===p&&l.jsx("div",{className:"space-y-4",children:l.jsx(f,{})})]})]}),F&&m&&h&&l.jsx(tr,{isOpen:F,onClose:()=>L(!1),onSuccess:()=>{L(!1),A()},employees:E||[],categories:u||[],currentUserId:m.uid,organizationId:h.id}),z&&h&&l.jsx(v,{isOpen:z,onClose:()=>U(!1),organizationId:h.id}),$&&W&&l.jsx(nr,{isOpen:$,notification:W,onDeliveryComplete:async(e,t)=>{try{q(!1),O(null),A()}catch(r){s.error("Failed to complete delivery:",r)}},onClose:()=>{q(!1),O(null)}})]}):l.jsxs("div",{className:`space-y-6 ${n}`,children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[l.jsx(o,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/absence-reports"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-error), var(--color-error))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex flex-col items-center gap-1.5 py-1",children:[l.jsx(De,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium text-xs text-center leading-tight",children:"Absence Reports"}),R?l.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current"}):l.jsx("span",{className:"text-lg font-bold",children:M.absenceReports.unread})]})}),l.jsx(o,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/meeting-requests"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-accent), var(--color-accent))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex flex-col items-center gap-1.5 py-1",children:[l.jsx(Te,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium text-xs text-center leading-tight",children:"HR Meetings"}),R?l.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current"}):l.jsx("span",{className:"text-lg font-bold",children:M.hrMeetings.unread})]})}),l.jsx(o,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/corrective-counselling"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-primary), var(--color-primary))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex flex-col items-center gap-1.5 py-1",children:[l.jsx(Ee,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium text-xs text-center leading-tight",children:"Counselling"}),R?l.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current"}):l.jsx("span",{className:"text-lg font-bold",children:M.correctiveCounselling.unread})]})}),l.jsx(o,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>b("warnings"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-warning), var(--color-warning))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex flex-col items-center gap-1.5 py-1",children:[l.jsx(se,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium text-xs text-center leading-tight",children:"Active Warnings"}),l.jsx("span",{className:"text-lg font-bold",children:V.totalActive})]})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx(o,{padding:"md",shadow:"sm",hover:!0,onClick:()=>b("urgent"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{minHeight:"64px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Y,{className:"w-5 h-5",style:{color:"var(--color-error)"}}),l.jsx("span",{className:"font-semibold",style:{color:"var(--color-text)"},children:"Urgent Tasks"})]}),l.jsx(de,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})]})}),l.jsx(o,{padding:"md",shadow:"sm",hover:!0,onClick:()=>b("warnings"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{minHeight:"64px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(se,{className:"w-5 h-5",style:{color:"var(--color-warning)"}}),l.jsx("span",{className:"font-semibold",style:{color:"var(--color-text)"},children:"Warnings"})]}),l.jsx(de,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})]})}),l.jsx(o,{padding:"md",shadow:"sm",hover:!0,onClick:()=>b("employees"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{minHeight:"64px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ie,{className:"w-5 h-5",style:{color:"var(--color-success)"}}),l.jsx("span",{className:"font-semibold",style:{color:"var(--color-text)"},children:"Employees"})]}),l.jsx(de,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})]})})]}),"urgent"===p&&l.jsx("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-50 p-4",style:{backgroundColor:"var(--color-overlay)"},children:l.jsxs(o,{padding:"none",className:"max-w-7xl w-full max-h-[90vh] overflow-hidden",shadow:"xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-4",style:{borderBottom:"1px solid var(--color-border)"},children:[l.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--color-text)"},children:"Urgent Tasks"}),l.jsx(d,{variant:"ghost",size:"sm",onClick:()=>b(null),children:"×"})]}),l.jsx("div",{className:"overflow-y-auto p-4",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx(o,{padding:"md",shadow:"sm",hover:!0,onClick:()=>i("/hr/absence-reports"),className:"cursor-pointer",style:{background:"linear-gradient(135deg, var(--color-error), var(--color-error))",color:"var(--color-text-inverse)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Absence Reports"}),l.jsx("div",{className:"text-2xl font-bold",children:M.absenceReports.unread})]}),l.jsx(De,{className:"w-8 h-8",style:{opacity:.7}})]})}),l.jsx(o,{padding:"md",shadow:"sm",hover:!0,onClick:()=>i("/hr/meeting-requests"),className:"cursor-pointer",style:{background:"linear-gradient(135deg, var(--color-accent), var(--color-accent))",color:"var(--color-text-inverse)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Meeting Requests"}),l.jsx("div",{className:"text-2xl font-bold",children:M.hrMeetings.unread})]}),l.jsx(Te,{className:"w-8 h-8",style:{opacity:.7}})]})}),l.jsx(o,{padding:"md",shadow:"sm",hover:!0,onClick:()=>i("/hr/corrective-counselling"),className:"cursor-pointer",style:{background:"linear-gradient(135deg, var(--color-primary), var(--color-primary))",color:"var(--color-text-inverse)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Counselling"}),l.jsx("div",{className:"text-2xl font-bold",children:M.correctiveCounselling.unread})]}),l.jsx(Ee,{className:"w-8 h-8",style:{opacity:.7}})]})})]})})]})}),"warnings"===p&&l.jsx("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-50 p-4",style:{backgroundColor:"var(--color-overlay)"},children:l.jsxs(o,{padding:"none",className:"max-w-7xl w-full max-h-[90vh] flex flex-col overflow-hidden",shadow:"xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 flex-shrink-0",style:{borderBottom:"1px solid var(--color-border)"},children:[l.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--color-text)"},children:N?`Warnings for ${N.name}`:"Warnings Overview"}),l.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{b(null),T(null)},children:"×"})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4 min-h-0",children:l.jsx(B,{initialEmployeeFilter:N||void 0})})]})}),"employees"===p&&l.jsx("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-50 p-4",style:{backgroundColor:"var(--color-overlay)"},children:l.jsxs(o,{padding:"none",className:"max-w-7xl w-full max-h-[90vh] flex flex-col overflow-hidden",shadow:"xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 flex-shrink-0",style:{borderBottom:"1px solid var(--color-border)"},children:[l.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--color-text)"},children:"Employees"}),l.jsx(d,{variant:"ghost",size:"sm",onClick:()=>b(null),children:"×"})]}),l.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:l.jsx(f,{})})]})})]})});ir.displayName="HRDashboardSection";export{Xs as C,ir as H,Qs as P,Vs as i};
