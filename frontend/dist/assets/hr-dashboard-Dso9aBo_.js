const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/warning-components-rhTj25mI.js","assets/business-owner-dashboard-Dq6MrEKt.js","assets/pdf-vendor-CbrIsI36.js","assets/react-vendor-BMk1H4su.js","assets/firebase-vendor-BIBOIkWK.js","assets/ui-vendor-Bx41JZPX.js","assets/dashboard-router-CsxAXVhx.js","assets/hod-dashboard-CL_RWHxj.js","assets/WarningDetailsModal-BuacO33I.js","assets/EmployeeManagement-B41bwMgz.js","assets/employee-BK6o4E_O.js","assets/ManualWarningEntry-Dj_Sp1yI.js","assets/CustomDatePicker-Bg2OmU-3.js","assets/DepartmentManagement-B6wqNEwy.js","assets/ManagerManagement-BSk58_y5.js","assets/FinalWarningsWatchList-DlNjfKOQ.js","assets/ReviewFollowUpDashboard-BL5oIouG.js"])))=>i.map(i=>d[i]);
import{a as e}from"./pdf-vendor-CbrIsI36.js";import{u as t,L as a,d as s,D as r,a as n,b as i,j as l,T as o,c as d}from"./business-owner-dashboard-Dq6MrEKt.js";import{r as c,u as m,R as u}from"./react-vendor-BMk1H4su.js";import{A as g,j as p,l as x,T as h,q as f,w as v,t as y,m as j,k as w,x as b,u as N,C as D}from"./firebase-vendor-BIBOIkWK.js";import{b as A,M as E,S,c as C,U as I,T as R,B as _,A as k,d as M,F as z}from"./ui-vendor-Bx41JZPX.js";const T=()=>{const{user:e}=t(),a=(()=>{if(!e)return[];const t=e.role?.id||e.role;return t?[t]:[]})(),s=e=>a.includes(e),r=e=>e.some(e=>a.includes(e));return{canViewBusinessMetrics:()=>s("executive-management")||s("super-user"),canManageOrganization:()=>s("executive-management")||s("super-user"),canViewComplianceReports:()=>r(["executive-management","hr-manager","super-user"]),canManageOrganizationSettings:()=>s("executive-management")||s("super-user"),canManageEmployees:()=>r(["hr-manager","executive-management","super-user"]),canManageHR:()=>r(["hr-manager","executive-management","super-user"]),canReviewWarnings:()=>r(["hr-manager","executive-management","super-user"]),canReviewDocuments:()=>r(["hr-manager","executive-management","super-user"]),canManageUsers:()=>r(["hr-manager","executive-management","super-user"]),canManageDepartments:()=>r(["hr-manager","executive-management","super-user"]),canCreateHRManagers:()=>s("executive-management")||s("super-user"),canCreateHODManagers:()=>r(["hr-manager","executive-management","super-user"]),canCreateWarnings:()=>r(["hod-manager","hr-manager","executive-management","super-user"]),canCaptureDocuments:()=>r(["hod-manager","hr-manager","super-user"]),canViewTeamMembers:()=>r(["hod-manager","hr-manager","executive-management","super-user"]),canManageTeam:()=>r(["hod-manager","hr-manager","executive-management","super-user"]),canManageCategories:r(["reseller","hr-manager","executive-management","super-user"]),canViewAnalytics:r(["reseller","hr-manager","executive-management","super-user"]),hasRole:s,hasAnyRole:r,hasAllRoles:e=>e.every(e=>a.includes(e)),getPrimaryRole:()=>a[0]||"unknown",getAllRoles:()=>[...a]}},F=[{name:"Operations",description:"Core business operations and daily management activities",isDefault:!0,isActive:!0},{name:"Admin",description:"Human resources, administration, and support functions",isDefault:!0,isActive:!0}];const W=new class{getCollectionPath(e){return`organizations/${e}/departments`}async createDefaultDepartments(e){try{const t=g(s),r=[],n=new Date;for(const a of F){const i=p(x(s,this.getCollectionPath(e))),l={id:i.id,...a,organizationId:e,employeeCount:0,createdAt:n,updatedAt:n};t.set(i,{...l,createdAt:h.fromDate(n),updatedAt:h.fromDate(n)}),r.push(l)}return await t.commit(),a.success("Default departments created successfully",{organizationId:e,count:r.length}),r}catch(t){throw a.error("Failed to create default departments",{error:t,organizationId:e}),t}}async getDepartments(e){try{const t=f(x(s,this.getCollectionPath(e)),v("isActive","==",!0),y("isDefault","desc"),y("name","asc")),a=await j(t),r=[];return a.forEach(e=>{const t=e.data();r.push({id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()||new Date})}),r.length,r}catch(t){throw a.error("Failed to get departments",{error:t,organizationId:e}),t}}async getDepartment(e,t){try{const a=p(s,this.getCollectionPath(e),t),r=await w(a);if(!r.exists())return null;const n=r.data();return{id:r.id,...n,createdAt:n.createdAt?.toDate()||new Date,updatedAt:n.updatedAt?.toDate()||new Date}}catch(r){throw a.error("Failed to get department",{error:r,organizationId:e,departmentId:t}),r}}async createDepartment(e,t){try{const r=new Date,n={name:t.name.trim(),description:t.description?.trim()||"",managerId:t.managerId||null,managerName:null,managerEmail:null,employeeCount:0,isDefault:!1,organizationId:e,isActive:!0,createdAt:h.fromDate(r),updatedAt:h.fromDate(r)},i=await b(x(s,this.getCollectionPath(e)),n),l={id:i.id,...n,createdAt:r,updatedAt:r};return t.managerId&&await this.updateManagerInfo(e,i.id,t.managerId),a.success("Department created successfully",{organizationId:e,departmentId:i.id}),l}catch(r){throw a.error("Failed to create department",{error:r,organizationId:e,formData:t}),r}}async updateDepartment(e,t,r){try{const n=p(s,this.getCollectionPath(e),t),i={name:r.name.trim(),description:r.description?.trim()||"",managerId:r.managerId||null,updatedAt:h.fromDate(new Date)};await N(n,i),r.managerId?await this.updateManagerInfo(e,t,r.managerId):await N(n,{managerName:null,managerEmail:null}),a.success("Department updated successfully",{organizationId:e,departmentId:t})}catch(n){throw a.error("Failed to update department",{error:n,organizationId:e,departmentId:t,formData:r}),n}}async deleteDepartment(e,t){try{const r=await this.getDepartment(e,t);if(r?.isDefault)throw new Error("Cannot delete default departments (Operations, Admin)");const n=p(s,this.getCollectionPath(e),t);await N(n,{isActive:!1,updatedAt:h.fromDate(new Date)}),a.success("Department deleted successfully",{organizationId:e,departmentId:t})}catch(r){throw a.error("Failed to delete department",{error:r,organizationId:e,departmentId:t}),r}}async updateManagerInfo(e,t,r){try{const a=p(s,`organizations/${e}/employees/${r}`),n=await w(a);if(n.exists()){const a=n.data(),r=`${a.profile?.firstName||""} ${a.profile?.lastName||""}`.trim(),i=a.profile?.email||"",l=p(s,this.getCollectionPath(e),t);await N(l,{managerName:r,managerEmail:i,updatedAt:h.fromDate(new Date)})}}catch(n){a.error("Failed to update manager info",{error:n,organizationId:e,departmentId:t,managerId:r})}}async getDepartmentStats(e){try{const t=await this.getDepartments(e),a=t.length,s=t.filter(e=>e.managerId).length,r=a-s,n=t.reduce((e,t)=>e+t.employeeCount,0),i=a>0?n/a:0;return{totalDepartments:a,departmentsWithManagers:s,departmentsWithoutManagers:r,totalEmployeesAcrossDepartments:n,averageEmployeesPerDepartment:Math.round(100*i)/100}}catch(t){throw a.error("Failed to get department stats",{error:t,organizationId:e}),t}}subscribeToDepartments(e,t){const r=f(x(s,this.getCollectionPath(e)),v("isActive","==",!0),y("isDefault","desc"),y("name","asc"));return D(r,e=>{const a=[];e.forEach(e=>{const t=e.data();a.push({id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()||new Date})}),t(a)},t=>{a.error("Department subscription error",{error:t,organizationId:e})})}async updateEmployeeCount(e,t,r){try{const a=p(s,this.getCollectionPath(e),t);await N(a,{employeeCount:r,updatedAt:h.fromDate(new Date)})}catch(n){throw a.error("Failed to update employee count",{error:n,organizationId:e,departmentId:t,newCount:r}),n}}async refreshEmployeeCounts(e){try{const t=x(s,`organizations/${e}/employees`),r=await j(f(t,v("isActive","==",!0))),n={};r.forEach(e=>{const t=e.data(),a=t.profile?.department||t.employment?.department;a&&(n[a]=(n[a]||0)+1)});const i=await this.getDepartments(e),l=g(s);for(const a of i){const t=n[a.name]||0;if(a.employeeCount!==t){const r=p(s,this.getCollectionPath(e),a.id);l.update(r,{employeeCount:t,updatedAt:h.fromDate(new Date)})}}await l.commit(),a.success("Employee counts refreshed successfully",{organizationId:e,counts:n})}catch(t){throw a.error("Failed to refresh employee counts",{error:t,organizationId:e}),t}}async getDepartmentsForManager(e,t){try{return(await this.getDepartments(e)).filter(e=>!e.managerId||e.managerId===t)}catch(s){throw a.error("Failed to get departments for manager",{error:s,organizationId:e}),s}}},P=()=>{const{organization:a}=t(),[r,n]=c.useState([]),[i,l]=c.useState(!0),[o,d]=c.useState(null),m=c.useCallback(e=>{if(e.reviewOutcome)return{status:"completed"};if(!e.reviewDate)return{status:"pending"};const t=e.reviewDate instanceof h?e.reviewDate.toDate():new Date(e.reviewDate),a=new Date;a.setHours(0,0,0,0),t.setHours(0,0,0,0);const s=t.getTime()-a.getTime(),r=Math.ceil(s/864e5);return r<-7?{status:"auto-satisfied",daysSinceReview:Math.abs(r)}:r<0?{status:"overdue",daysSinceReview:Math.abs(r)}:{status:"pending",daysUntilReview:r}},[]),u=c.useCallback(async()=>{if(a?.id)try{l(!0),d(null);const e=x(s,`organizations/${a.id}/warnings`),t=f(e,v("reviewDate","!=",null),y("reviewDate","asc")),r=await j(t),i=x(s,`organizations/${a.id}/employees`),o=await j(i),c=new Map;o.forEach(e=>{c.set(e.id,{id:e.id,...e.data()})});const u=[];r.forEach(e=>{const t={id:e.id,...e.data()},a=c.get(t.employeeId),s=m(t);u.push({...t,reviewStatus:s.status,daysUntilReview:s.daysUntilReview,daysSinceReview:s.daysSinceReview,employee:a?{id:a.id,firstName:a.profile.firstName,lastName:a.profile.lastName,employeeNumber:a.profile.employeeNumber,department:a.employment.department,position:a.employment.position,photoUrl:a.photoUrl}:void 0})}),n(u)}catch(e){console.error("Error fetching review follow-ups:",e),d("Failed to load review follow-ups")}finally{l(!1)}},[a?.id,m]),g=c.useCallback(async(t,r)=>{if(a?.id)try{const{doc:n,updateDoc:i}=await e(async()=>{const{doc:e,updateDoc:t}=await import("./firebase-vendor-BIBOIkWK.js").then(e=>e.Y);return{doc:e,updateDoc:t}},[]),l=n(s,`organizations/${a.id}/warnings`,t);await i(l,{...r,reviewedAt:h.now(),reviewStatus:"completed"}),await u()}catch(n){throw console.error("Error updating review:",n),new Error("Failed to update review")}},[a?.id,u]);c.useEffect(()=>{u()},[u]);const p=r.filter(e=>"pending"===e.reviewStatus&&void 0!==e.daysUntilReview&&e.daysUntilReview<=7),w=r.filter(e=>"overdue"===e.reviewStatus),b=r.filter(e=>"completed"===e.reviewStatus||"auto-satisfied"===e.reviewStatus);return{warnings:r,dueSoon:p,overdue:w,completed:b,loading:i,error:o,refresh:u,updateReview:g}},O=u.lazy(()=>e(()=>import("./warning-components-rhTj25mI.js").then(e=>e.R),__vite__mapDeps([0,1,2,3,4,5,6,7]))),H=u.lazy(()=>e(()=>import("./WarningDetailsModal-BuacO33I.js"),__vite__mapDeps([8,2,1,3,4,5,6,7,0]))),U=u.lazy(()=>e(()=>import("./EmployeeManagement-B41bwMgz.js"),__vite__mapDeps([9,1,2,3,4,5,6,7,10,0])).then(e=>({default:e.EmployeeManagement}))),L=u.lazy(()=>e(()=>import("./ManualWarningEntry-Dj_Sp1yI.js"),__vite__mapDeps([11,2,1,3,4,5,6,7,12])).then(e=>({default:e.ManualWarningEntry}))),$=u.lazy(()=>e(()=>import("./DepartmentManagement-B6wqNEwy.js"),__vite__mapDeps([13,2,1,3,4,5,6,7])).then(e=>({default:e.DepartmentManagement}))),V=u.lazy(()=>e(()=>import("./warning-components-rhTj25mI.js").then(e=>e.E),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(e=>({default:e.EnhancedDeliveryWorkflow}))),q=u.lazy(()=>e(()=>import("./ManagerManagement-BSk58_y5.js"),__vite__mapDeps([14,1,2,3,4,5,10,6,7])).then(e=>({default:e.ManagerManagement}))),Y=u.lazy(()=>e(()=>import("./FinalWarningsWatchList-DlNjfKOQ.js"),__vite__mapDeps([15,1,2,3,4,5])).then(e=>({default:e.FinalWarningsWatchList}))),B=u.lazy(()=>e(()=>import("./ReviewFollowUpDashboard-BL5oIouG.js"),__vite__mapDeps([16,1,2,3,4,5,6,7])).then(e=>({default:e.ReviewFollowUpDashboard}))),G=()=>l.jsxs("div",{className:"animate-pulse space-y-4 p-4",children:[l.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),l.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),l.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]})]}),J=c.memo(({className:g=""})=>{const p=m(),{user:h}=t(),{organization:v,categories:j}=n(),[w,b]=c.useState("urgent"),[N,F]=c.useState(null),[J,K]=c.useState(null),[Q,X]=c.useState(!1),{employees:Z,warnings:ee,loading:te,error:ae,refreshData:se}=i({role:"hr"}),{hrReportsCount:re,hrCountsLoading:ne,hrCountsError:ie}=(()=>{const{user:e}=t(),{canManageHR:r}=T(),[n,i]=c.useState({absenceReports:{unread:0,total:0},hrMeetings:{unread:0,total:0}}),[l,o]=c.useState(!0),[d,m]=c.useState(null),[u,g]=c.useState(null),p=c.useRef([]),h=c.useRef(!0),v=c.useRef(!1),j=c.useCallback(async()=>{e?.organizationId&&r()&&(m(null),g(new Date))},[e?.organizationId,r]);return c.useEffect(()=>{if(!v.current){if(h.current=!0,!r()||!e?.organizationId)return o(!1),void(v.current=!0);o(!0),m(null),p.current.forEach(e=>{try{e()}catch(t){a.warn("âš ï¸ Error unsubscribing:",t)}}),p.current=[];try{const t=f(x(s,`organizations/${e.organizationId}/reports`),y("absenceDate","desc")),r=D(t,e=>{if(!h.current)return;const t=e.docs.filter(e=>"_metadata"!==e.id).map(e=>({id:e.id,...e.data()})),a=t.filter(e=>!e.hrReviewed).length;i(e=>({...e,absenceReports:{unread:a,total:t.length}})),g(new Date),t.length},e=>{a.error("âŒ Absence reports listener error:",e),h.current&&m("Failed to load absence reports")});p.current.push(r);const n=f(x(s,`organizations/${e.organizationId}/meetings`),y("createdAt","desc")),l=D(n,e=>{if(!h.current)return;const t=e.docs.filter(e=>"_metadata"!==e.id).map(e=>({id:e.id,...e.data()})),a=t.filter(e=>"pending"===e.status).length;i(e=>({...e,hrMeetings:{unread:a,total:t.length}})),g(new Date),t.length},e=>{a.error("âŒ HR meetings listener error:",e),h.current&&m("Failed to load HR meetings")});p.current.push(l),setTimeout(()=>{h.current&&o(!1)},1e3)}catch(t){a.error("âŒ Error setting up listeners:",t),m("Failed to initialize real-time data"),o(!1)}return v.current=!0,()=>{h.current=!1,p.current.forEach(e=>{try{e()}catch(t){a.warn("âš ï¸ Error during cleanup:",t)}}),p.current=[],v.current=!1}}},[]),c.useEffect(()=>{r()&&e?.organizationId||(i({absenceReports:{unread:0,total:0},hrMeetings:{unread:0,total:0}}),o(!1),m(null),g(null),v.current=!1)},[r(),e?.organizationId]),{hrReportsCount:n,hrCountsLoading:l,hrCountsError:d,refreshHRCounts:j,lastUpdated:u}})(),{dueSoon:le,overdue:oe,loading:de}=P(),[ce,me]=c.useState(!1),[ue,ge]=c.useState(!1),[pe,xe]=c.useState(null),[he,fe]=c.useState(!1),[ve,ye]=c.useState(0),[je,we]=c.useState(!1),[be,Ne]=c.useState({});c.useEffect(()=>{const t=async()=>{if(v?.id)try{const e=await W.getDepartments(v.id);console.log("ðŸ”„ Department count updated:",e.length),ye(e.length)}catch(e){console.error("Failed to fetch departments:",e),ye(0)}},a=async()=>{if(v?.id)try{const{getFirestore:t,doc:a,getDoc:s}=await e(async()=>{const{getFirestore:e,doc:t,getDoc:a}=await import("./firebase-vendor-BIBOIkWK.js").then(e=>e.Y);return{getFirestore:e,doc:t,getDoc:a}},[]),r=t(),n=await s(a(r,"organizations",v.id)),i=n.data()?.setupSkipped||{};Ne(i)}catch(t){console.error("Failed to fetch skipped tasks:",t)}};(async()=>{await Promise.all([t(),a()]),we(!0)})();let s=null;return"urgent"===w&&(s=setInterval(()=>{t(),a()},5e3)),()=>{s&&clearInterval(s)}},[v?.id,w]);const De=c.useCallback(async t=>{if(v?.id)try{const{getFirestore:a,doc:s,updateDoc:r}=await e(async()=>{const{getFirestore:e,doc:t,updateDoc:a}=await import("./firebase-vendor-BIBOIkWK.js").then(e=>e.Y);return{getFirestore:e,doc:t,updateDoc:a}},[]),n=a();await r(s(n,"organizations",v.id),{[`setupSkipped.${t}`]:!0}),Ne(e=>({...e,[t]:!0})),console.log(`âœ… Skipped ${t} setup task`)}catch(a){console.error("Failed to skip setup task:",a)}},[v?.id]),Ae=((e,t,s)=>{const[n,i]=c.useState(!0),[l,o]=c.useState(null),[d,m]=c.useState(null);c.useEffect(()=>{(async()=>{if(e&&t)try{i(!0);const n=await r.getDocument(t,"users",e);if(!n)return a.error("User document not found for countdown feature"),void i(!1);const l=n?.features?.historicalWarningEntry;if(l?.firstAccessedAt){const e=l.firstAccessedAt.toDate?l.firstAccessedAt.toDate():new Date(l.firstAccessedAt),t=l.expiresAt.toDate?l.expiresAt.toDate():new Date(l.expiresAt);o({firstAccessedAt:e,expiresAt:t}),Math.ceil((t.getTime()-Date.now())/864e5)}else if(s){const a=new Date,s=new Date(a.getTime()+5184e6),n={"features.historicalWarningEntry":{firstAccessedAt:a,expiresAt:s}};await r.updateDocument(t,"users",e,n),o({firstAccessedAt:a,expiresAt:s})}}catch(n){a.error("Failed to initialize historical warning countdown:",n)}finally{i(!1)}else i(!1)})()},[e,t,s]),c.useEffect(()=>{if(!l)return void m(null);const e=()=>{const e=Date.now(),t=l.expiresAt.getTime()-e,a=Math.floor(t/864e5);m(Math.max(0,a))};e();const t=setInterval(e,36e5);return()=>clearInterval(t)},[l]);const{level:u,text:g}=null!==d&&l?0===d?{level:"urgent",text:"Capture Historical Warnings (Last day!)"}:1===d?{level:"urgent",text:"Capture Historical Warnings (1 day left!)"}:d<=7?{level:"warning",text:`Capture Historical Warnings (${d} days left - Hurry!)`}:d<=14?{level:"warning",text:`Capture Historical Warnings (${d} days left)`}:{level:"normal",text:`Capture Historical Warnings (${d} days left)`}:{level:"normal",text:"Capture Historical Warnings"},p=null!==d&&d<=0;return{daysRemaining:d,isExpired:p,isActive:!p&&null!==l,loading:n,urgencyLevel:u,displayText:g}})(h?.uid,v?.id,"warnings"===w),Ee=ee?.filter(e=>"expired"!==e.status&&"overturned"!==e.status)||[],Se={totalActive:Ee.length,undelivered:Ee.filter(e=>"delivered"!==e.status).length,highSeverity:Ee.filter(e=>"high"===e.severity||"gross_misconduct"===e.category?.severity).length},Ce={totalEmployees:Z?.length||0,activeEmployees:Z?.filter(e=>!1!==e.isActive)?.length||0,newEmployees:Z?.filter(e=>new Date(e.createdAt||e.metadata?.createdAt||0)>new Date(Date.now()-2592e6))?.length||0},Ie={dueThisWeek:le?.length||0,overdue:oe?.length||0,total:(le?.length||0)+(oe?.length||0)};c.useEffect(()=>{const e=e=>{const{employeeId:t}=e.detail,a=localStorage.getItem("warningFilterEmployeeName");t&&a&&(F({id:t,name:a}),b("warnings"),localStorage.removeItem("warningFilterEmployeeId"),localStorage.removeItem("warningFilterEmployeeName"))};return window.addEventListener("navigateToWarnings",e),()=>{window.removeEventListener("navigateToWarnings",e)}},[]);const Re=c.useMemo(()=>[{id:"absence-reports",label:"Absence Reports",value:re.absenceReports.unread,subtext:`${re.absenceReports.total} total`,icon:A,color:"error",onClick:()=>p("/hr/absence-reports"),loading:ne},{id:"meeting-requests",label:"Meeting Requests",value:re.hrMeetings.unread,subtext:`${re.hrMeetings.total} total`,icon:E,color:"accent",onClick:()=>p("/hr/meeting-requests"),loading:ne},{id:"active-warnings",label:"Active Warnings",value:Se.totalActive,subtext:`${Se.undelivered} undelivered`,icon:S,color:"warning",onClick:()=>b("warnings")},{id:"review-followups",label:"Review Follow-ups",value:Ie.total,subtext:`${Ie.overdue} overdue`,icon:C,color:Ie.overdue>0?"error":"accent",onClick:()=>b("review-followups"),loading:de},{id:"employees",label:"Total Employees",value:Ce.totalEmployees,subtext:`${Ce.activeEmployees} active`,icon:I,color:"success",onClick:()=>b("employees")}],[re,ne,Se,Ie,de,Ce,p]),_e=c.useMemo(()=>{const e=ve<3&&!be.departments,t=Z?.filter(e=>!("user_creation"===e.metadata?.source||e.metadata?.linkedUserId))||[],a=0===t.length&&!be.employees;return console.log("ðŸ” Setup Status Check:",{departmentCount:ve,needsDepartments:e,skippedDepartments:be.departments,totalEmployees:Z?.length||0,regularEmployees:t.length,needsEmployees:a,skippedEmployees:be.employees,filteredOut:Z?.filter(e=>"user_creation"===e.metadata?.source||e.metadata?.linkedUserId).map(e=>({name:`${e.profile?.firstName} ${e.profile?.lastName}`,position:e.employment?.position}))}),{needsDepartments:e,needsEmployees:a,hasSetupTasks:e||a}},[ve,Z,be]),ke=c.useMemo(()=>[{id:"urgent",label:"Urgent Tasks",icon:R,badgeCount:re.absenceReports.unread+re.hrMeetings.unread+Se.undelivered,content:l.jsxs("div",{className:"space-y-4",children:[je&&_e.hasSetupTasks&&l.jsxs("div",{className:"bg-white rounded-lg border border-blue-200 shadow-sm",children:[l.jsxs("div",{className:"p-4 border-b border-blue-100 bg-blue-50",children:[l.jsxs("h3",{className:"text-lg font-semibold text-blue-900 flex items-center gap-2",children:[l.jsx(_,{className:"w-5 h-5"}),"Getting Started - Setup Your Organization"]}),l.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Complete these steps to get your HR system ready"})]}),l.jsxs("div",{className:"divide-y divide-gray-100",children:[_e.needsDepartments&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>b("departments"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l.jsx(_,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-semibold text-gray-900",children:"Set Up Departments"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Create departments to organize your employees (e.g., Sales, Operations, Admin)"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[l.jsx("button",{onClick:e=>{e.stopPropagation(),De("departments")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"Skip this step",children:"Skip"}),l.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full font-medium",children:"Step 1"}),l.jsx(k,{className:"w-4 h-4 text-gray-400"})]})]})}),_e.needsEmployees&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>b("employees"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[l.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l.jsx(I,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-semibold text-gray-900",children:"Add Your Employees"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Import employee data via CSV or add them manually to start managing your team"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[l.jsx("button",{onClick:e=>{e.stopPropagation(),De("employees")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",title:"Skip this step",children:"Skip"}),l.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full font-medium",children:_e.needsDepartments?"Step 2":"Step 1"}),l.jsx(k,{className:"w-4 h-4 text-gray-400"})]})]})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg border border-red-200 shadow-sm",children:[l.jsxs("div",{className:"p-4 border-b border-red-100 bg-red-50",children:[l.jsxs("h3",{className:"text-lg font-semibold text-red-900 flex items-center gap-2",children:[l.jsx(R,{className:"w-5 h-5"}),"Urgent Tasks Requiring Immediate Attention"]}),l.jsx("p",{className:"text-sm text-red-700 mt-1",children:"These items need your immediate review and action"})]}),l.jsxs("div",{className:"divide-y divide-gray-100",children:[re.absenceReports.unread>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>p("/hr/absence-reports"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[re.absenceReports.unread," Unread Absence Reports"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Employees reporting absences requiring approval"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full font-medium",children:[re.absenceReports.unread," pending"]}),l.jsx(A,{className:"w-4 h-4 text-gray-400"})]})]})}),re.hrMeetings.unread>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>p("/hr/meeting-requests"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[re.hrMeetings.unread," New Meeting Requests"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Employees requesting HR consultations"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full font-medium",children:[re.hrMeetings.unread," requests"]}),l.jsx(E,{className:"w-4 h-4 text-gray-400"})]})]})}),Se.undelivered>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>b("warnings"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[Se.undelivered," Undelivered Warnings"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Warning documents pending delivery to employees"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full font-medium",children:"Urgent"}),l.jsx(R,{className:"w-4 h-4 text-gray-400"})]})]})}),Se.highSeverity>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>b("warnings"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-red-600 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[Se.highSeverity," High Priority Cases"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Final warnings and dismissal cases requiring oversight"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full font-medium",children:"Critical"}),l.jsx(R,{className:"w-4 h-4 text-gray-400"})]})]})}),0===re.absenceReports.unread&&0===re.hrMeetings.unread&&0===Se.undelivered&&0===Se.highSeverity&&l.jsxs("div",{className:"p-8 text-center text-gray-500",children:[l.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:l.jsx(S,{className:"w-8 h-8 text-green-600"})}),l.jsx("div",{className:"font-medium text-gray-700",children:"All caught up!"}),l.jsx("div",{className:"text-sm",children:"No urgent tasks requiring immediate attention"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(C,{className:"w-4 h-4 text-gray-600"}),"Today's Activity"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"New Reports"}),l.jsx("span",{className:"font-medium text-gray-900",children:re.absenceReports.unread})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Meetings"}),l.jsx("span",{className:"font-medium text-gray-900",children:re.hrMeetings.unread})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Warnings"}),l.jsx("span",{className:"font-medium text-gray-900",children:Se.undelivered})]})]})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(M,{className:"w-4 h-4 text-blue-600"}),"Team Status"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Total Employees"}),l.jsx("span",{className:"font-medium text-gray-900",children:Ce.totalEmployees})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Active"}),l.jsx("span",{className:"font-medium text-green-600",children:Ce.activeEmployees})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"New This Month"}),l.jsx("span",{className:"font-medium text-blue-600",children:Ce.newEmployees})]})]})]}),l.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(S,{className:"w-4 h-4 text-orange-600"}),"Warning Overview"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Active"}),l.jsx("span",{className:"font-medium text-gray-900",children:Se.totalActive})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Undelivered"}),l.jsx("span",{className:"font-medium text-orange-600",children:Se.undelivered})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"High Priority"}),l.jsx("span",{className:"font-medium text-red-600",children:Se.highSeverity})]})]})]})]})]})},{id:"warnings",label:"Warnings",icon:S,content:l.jsxs("div",{className:"space-y-4",children:[!Ae.isExpired&&l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Warnings Management"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Digital and historical warning records"})]}),l.jsx(o,{variant:"outline",size:"md",icon:z,onClick:()=>me(!0),className:""+("urgent"===Ae.urgencyLevel?"border-red-500 text-red-700 hover:bg-red-50 font-semibold animate-pulse":"warning"===Ae.urgencyLevel?"border-orange-500 text-orange-700 hover:bg-orange-50 font-semibold":"border-amber-500 text-amber-700 hover:bg-amber-50"),children:Ae.loading?"Capture Historical Warnings":Ae.displayText})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsx("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(R,{className:"w-8 h-8 text-orange-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:Se.undelivered}),l.jsx("div",{className:"text-sm text-orange-700",children:"Undelivered Warnings"}),l.jsx("div",{className:"text-xs text-orange-600",children:"Require immediate attention"})]})]})}),l.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(S,{className:"w-8 h-8 text-red-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:Se.highSeverity}),l.jsx("div",{className:"text-sm text-red-700",children:"High Severity"}),l.jsx("div",{className:"text-xs text-red-600",children:"Final warnings & dismissals"})]})]})}),l.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(z,{className:"w-8 h-8 text-blue-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Se.totalActive}),l.jsx("div",{className:"text-sm text-blue-700",children:"Total Active"}),l.jsx("div",{className:"text-xs text-blue-600",children:"All current warnings"})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200",children:l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(O,{initialEmployeeFilter:N||void 0,selectedWarning:J,showDetails:Q,onViewDetails:e=>{K(e),X(!0)},onCloseDetails:()=>{K(null),X(!1)},onWarningUpdated:se})})})]})},{id:"review-followups",label:"Review Follow-ups",icon:C,content:l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(B,{})})},{id:"employees",label:"Employees",icon:_,content:l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(U,{onDataChange:se,inline:!0})})},{id:"departments",label:"Departments",icon:_,content:v?l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx($,{isOpen:!0,onClose:()=>b("urgent"),organizationId:v.id,inline:!0})}):null},{id:"managers",label:"Managers",icon:I,content:l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(q,{})})}],[_e,re,Se,Ce,Ae,N,J,Q,se,v,p,De]);return l.jsxs(l.Fragment,{children:[l.jsx(d,{metrics:Re,tabs:ke,activeTab:w,onTabChange:b,loading:te.overall,error:ae||ie,bottomSection:l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(Y,{employees:Z})}),className:g}),ce&&h&&v&&l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(L,{isOpen:ce,onClose:()=>me(!1),onSuccess:()=>{me(!1),se()},employees:Z||[],categories:j||[],currentUserId:h.uid,organizationId:v.id})}),ue&&v&&l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx($,{isOpen:ue,onClose:()=>ge(!1),organizationId:v.id})}),he&&pe&&l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(V,{isOpen:he,notification:pe,onDeliveryComplete:async(e,t)=>{try{fe(!1),xe(null),se()}catch(s){a.error("Failed to complete delivery:",s)}},onClose:()=>{fe(!1),xe(null)}})}),l.jsx(u.Suspense,{fallback:l.jsx(G,{}),children:l.jsx(H,{warning:J,isOpen:Q,onClose:()=>{K(null),X(!1)},canTakeAction:!0,userRole:"hr"})})]})});J.displayName="HRDashboardSection";const K=Object.freeze(Object.defineProperty({__proto__:null,HRDashboardSection:J},Symbol.toStringTag,{value:"Module"}));export{W as D,K as H,P as a,T as u};
