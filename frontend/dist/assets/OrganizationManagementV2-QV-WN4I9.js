import{u as e,a as s,L as a,D as r,A as t,j as l,l as i}from"./business-owner-dashboard-BmQl3e0o.js";import{r as n,u as o,d}from"./react-vendor-BMk1H4su.js";import{u as m,D as c}from"./hr-dashboard-CByPQOeq.js";import{a as x,L as g}from"./dashboard-router-DiUm3Ijp.js";import{D as u}from"./firebase-vendor-BIBOIkWK.js";import{s as p,X as h,U as f,S as N,B as b,o as j,w as y,ae as v,ay as w,aj as A,t as C}from"./ui-vendor-nvFuqpTO.js";import"./pdf-vendor-CbrIsI36.js";import"./hod-dashboard-B5bMPhud.js";const S=n.memo(({isOpen:r,onClose:t,onSuccess:o,userRole:d,employees:m})=>{const[c,x]=n.useState(m.length>0?"promote":"create"),[g,p]=n.useState(null),[h,f]=n.useState({firstName:"",lastName:"",email:"",department:"",password:"temp123"}),[N,b]=n.useState(!1),[y,v]=n.useState(""),{user:w}=e(),{organization:A}=s(),S=()=>{x(m.length>0?"promote":"create"),p(null),f({firstName:"",lastName:"",email:"",department:"",password:"temp123"})};return r?l.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full shadow-2xl animate-in fade-in duration-200",children:[l.jsxs("div",{className:"p-6 border-b border-gray-200",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-3",children:[l.jsx(j,{className:"w-6 h-6 text-blue-600"}),"Add ","hr-manager"===d?"HR Manager":"Department Manager"]}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"promote"===c?"Promote an existing employee to "+("hr-manager"===d?"HR manager":"department manager"):`Create a new ${"hr-manager"===d?"HR manager":"department manager"} account`})]}),l.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),A&&w){b(!0),v("");try{if("promote"===c){if(!g)return v("Please select an employee to promote"),void b(!1);if(g.id,!h.email.trim())return v("Email address is required for creating user account"),void b(!1);const e={firstName:g.profile?.firstName||g.firstName,lastName:g.profile?.lastName||g.lastName,email:h.email.trim(),password:"temp123",role:d,organizationId:A.id,departmentIds:"hod-manager"===d?[h.department]:[],employeeId:g.id,updateEmployeeEmail:!0},s=u(i,"createOrganizationUser"),r=await s(e);if(!r.data.success)throw new Error(r.data.message||"Failed to promote employee");a.success(`âœ… Promoted employee to ${d} with verified email: ${h.email}`)}else{const e={firstName:h.firstName,lastName:h.lastName,email:h.email,password:h.password,role:d,organizationId:A.id,departmentIds:"hod-manager"===d?[h.department]:[],createEmployee:!0},s=u(i,"createOrganizationUser"),r=await s(e);if(!r.data.success)throw new Error(r.data.message||"Failed to create user");a.success(`âœ… Created ${d} user and employee: ${r.data.userId}`)}b(!1),o(),t(),S()}catch(s){a.error("âŒ Error processing user:",s),v(s.message||"Failed to process user"),b(!1)}}},className:"p-6 space-y-4",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Choose Option"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"selectionMode",value:"promote",checked:"promote"===c,onChange:e=>x(e.target.value),className:"mr-3 text-blue-600",disabled:0===m.length}),l.jsxs("span",{className:0===m.length?"text-gray-400":"text-gray-700",children:["Promote Existing Employee ",0===m.length&&"(No employees available)"]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"selectionMode",value:"create",checked:"create"===c,onChange:e=>x(e.target.value),className:"mr-3 text-blue-600"}),l.jsx("span",{className:"text-gray-700",children:"Create New Manager"})]})]})]}),"promote"===c&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Employee to Promote"}),l.jsxs("select",{value:g?.id||"",onChange:e=>{const s=m.find(s=>s.id===e.target.value);if(p(s||null),s){const e=s.profile?.email||s.email;e||(s.profile?.firstName||s.firstName,s.profile?.lastName||s.lastName,A?.name.toLowerCase().replace(/\s+/g,"")),f(s=>({...s,email:e||""}))}else f(e=>({...e,email:""}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[l.jsx("option",{value:"",children:"Select an employee..."}),m.map(e=>l.jsxs("option",{value:e.id,children:[e.profile?.firstName||e.firstName," ",e.profile?.lastName||e.lastName,e.profile?.email&&` (${e.profile.email})`]},e.id))]}),g&&l.jsxs("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg space-y-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Selected:"})," ",g.profile?.firstName||g.firstName," ",g.profile?.lastName||g.lastName,l.jsx("br",{}),l.jsx("strong",{children:"Department:"})," ",g.profile?.department||g.employment?.department||"Not assigned"]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:["Email Address",g.profile?.email?l.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Verify/Update"}):l.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"Required"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"email",value:h.email,onChange:e=>f(s=>({...s,email:e.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(g.profile?.email?"border-yellow-300 bg-yellow-50":"border-gray-300"),placeholder:g.profile?.email||`${g.profile?.firstName||g.firstName}.${g.profile?.lastName||g.lastName}@${A?.name.toLowerCase().replace(/\s+/g,"")}.com`,required:!0}),g.profile?.email&&h.email===(g.profile?.email||g.email)&&l.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:l.jsx("span",{className:"text-green-600 text-sm",children:"âœ“ Verified"})})]}),l.jsx("div",{className:"text-xs text-gray-600 mt-1 flex items-start gap-2",children:g.profile?.email?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full flex-shrink-0 mt-1"}),l.jsxs("span",{children:["Current: ",l.jsx("strong",{children:g.profile.email}),". You can verify or update it above."]})]}):l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full flex-shrink-0 mt-1"}),l.jsx("span",{children:"No email on file. Please enter their email address for login access."})]})})]})]})]}),"create"===c&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),l.jsx("input",{type:"text",value:h.firstName,onChange:e=>f(s=>({...s,firstName:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),l.jsx("input",{type:"text",value:h.lastName,onChange:e=>f(s=>({...s,lastName:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),l.jsx("input",{type:"email",value:h.email,onChange:e=>f(s=>({...s,email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),"hod-manager"===d&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),l.jsxs("select",{value:h.department,onChange:e=>f(s=>({...s,department:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[l.jsx("option",{value:"",children:"Select Department"}),l.jsx("option",{value:"operations",children:"Operations"}),l.jsx("option",{value:"production",children:"Production"}),l.jsx("option",{value:"quality",children:"Quality Assurance"}),l.jsx("option",{value:"maintenance",children:"Maintenance"}),l.jsx("option",{value:"logistics",children:"Logistics"}),l.jsx("option",{value:"administration",children:"Administration"}),l.jsx("option",{value:"finance",children:"Finance"}),l.jsx("option",{value:"sales",children:"Sales & Marketing"})]})]})]}),y&&l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(C,{className:"w-4 h-4 text-red-500"}),l.jsx("span",{className:"text-sm text-red-700",children:y})]})}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:N,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:N?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"promote"===c?"Promoting...":"Creating..."]}):l.jsxs(l.Fragment,{children:[l.jsx(j,{className:"w-4 h-4"}),"promote"===c?"Promote Employee":"Create Manager"]})})]})]})]})}):null});S.displayName="AddUserModal";const k=e=>"string"==typeof e?e:e?.id||"",D=n.memo(({onSwitchToDepartments:i}={})=>{const u=o(),{user:C}=e(),{organization:D}=s(),{canCreateHRManagers:$,canCreateHODManagers:M,canManageDepartments:R,canManageUsers:I}=m(),[E,F]=n.useState([]),[O,U]=n.useState(null),[P,z]=n.useState([]),[H,q]=n.useState([]),[L,T]=n.useState({totalUsers:0,totalEmployees:0,totalDepartments:0,activeWarnings:0}),[B,V]=n.useState(!0),W=x(),[Q,Y]=n.useState(null);n.useEffect(()=>{D&&G()},[D]);const G=async()=>{if(D)try{V(!0),D.id;const e=(await r.queryDocuments(D.id,"users",[])).documents.map(e=>({id:e.id,firstName:e.firstName||"",lastName:e.lastName||"",email:e.email,role:e.role,departmentIds:e.departmentIds||[],isActive:e.isActive??!0,createdAt:e.createdAt||(new Date).toISOString(),lastLogin:e.lastLogin})),s=e.filter(e=>"executive-management"!==k(e.role)),l=e.find(e=>"executive-management"===k(e.role))||null,i=await t.employees.getAll(D.id),n=(await t.warnings.getAll(D.id)).filter(e=>"issued"===e.status).length,o=(await c.getDepartments(D.id)).map(e=>({id:e.id,name:e.name,employeeCount:e.employeeCount,createdAt:e.createdAt.toISOString(),description:e.description,managerId:e.managerId,managerName:e.managerName})),d={totalUsers:s.length,totalEmployees:i.length,totalDepartments:o.length,activeWarnings:n};F(s),U(l),z(o),q(i),T(d),a.success(`âœ… Loaded organization data: ${s.length} users, ${i.length} employees`)}catch(e){a.error("âŒ Failed to load organization data:",e)}finally{V(!1)}},J=e=>{W.open(e)},K=async e=>{if(!D)return;const s=E.find(s=>s.id===e);if(!s)return;const r=await Z(e),t=r.length>0?`Archive ${s.firstName} ${s.lastName}?\n\nThis will:\nâ€¢ Archive the user account\nâ€¢ Reassign ${r.length} employees to HR managers\nâ€¢ Remove access to the system\n\nThis action can be undone by restoring the user.`:`Archive ${s.firstName} ${s.lastName}?\n\nThis will remove their access to the system.\nThis action can be undone by restoring the user.`;if(confirm(t))try{r.length>0&&await _(e,r),await ShardedDataService.updateDocument(D.id,"users",e,{isActive:!1,archivedAt:(new Date).toISOString(),archivedBy:s?.uid||"system"}),a.success(`âœ… User archived successfully: ${s.firstName} ${s.lastName}`),G()}catch(l){a.error("âŒ Failed to archive user:",l),alert("Failed to archive user. Please try again.")}},X=async e=>{if(!D)return;const s=E.find(s=>s.id===e);if(!s)return;if(confirm(`Restore ${s.firstName} ${s.lastName}?\n\nThis will reactivate their account and restore system access.`))try{await ShardedDataService.updateDocument(D.id,"users",e,{isActive:!0,restoredAt:(new Date).toISOString(),restoredBy:s?.uid||"system",archivedAt:null,archivedBy:null}),a.success(`âœ… User restored successfully: ${s.firstName} ${s.lastName}`),G()}catch(r){a.error("âŒ Failed to restore user:",r),alert("Failed to restore user. Please try again.")}},Z=async e=>{if(!D)return[];try{return(await t.employees.getAll(D.id)).filter(s=>s.employment?.managerId===e&&!1!==s.isActive)}catch(s){return a.error("Error loading managed employees:",s),[]}},_=async(e,s)=>{if(D&&0!==s.length)try{const r=E.find(s=>"hr-manager"===k(s.role)&&s.isActive&&s.id!==e);if(!r)return void a.warn("âš ï¸ No active HR manager found for employee reassignment");s.length,r.firstName,r.lastName;const t=s.map(s=>ShardedDataService.updateDocument(D.id,"employees",s.id,{"employment.managerId":r.id,"employment.managerName":`${r.firstName} ${r.lastName}`,"employment.managerRole":"hr-manager",reassignedAt:(new Date).toISOString(),reassignedFrom:e,reassignedReason:"Manager archived"}));await Promise.all(t),a.success(`âœ… Reassigned ${s.length} employees to ${r.firstName} ${r.lastName}`)}catch(r){throw a.error("âŒ Failed to reassign employees:",r),r}};return B?l.jsx(g,{message:"Loading organization..."}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"space-y-3",children:[Q&&l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 animate-in fade-in duration-300",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(p,{className:"w-5 h-5 text-green-600"}),l.jsx("div",{className:"flex-1",children:l.jsx("p",{className:"text-green-800 font-medium",children:Q})}),l.jsx("button",{onClick:()=>Y(null),className:"text-green-600 hover:text-green-800 p-1 rounded-full hover:bg-green-100",children:l.jsx(h,{className:"w-4 h-4"})})]})}),l.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("h2",{className:"text-base font-bold text-gray-900",children:"Organization Management"}),l.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-600",children:[l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(f,{className:"w-3 h-3"}),L.totalUsers," users"]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(N,{className:"w-3 h-3"}),L.totalEmployees," employees"]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(b,{className:"w-3 h-3"}),L.totalDepartments," depts"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[$()&&l.jsxs("button",{onClick:()=>J("hr-manager"),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200 hover:bg-blue-100 rounded-md transition-colors",children:[l.jsx(j,{className:"w-3.5 h-3.5"}),"Add HR Manager"]}),M()&&l.jsxs("button",{onClick:()=>J("hod-manager"),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-green-50 text-green-700 border border-green-200 hover:bg-green-100 rounded-md transition-colors",children:[l.jsx(j,{className:"w-3.5 h-3.5"}),"Add Dept Manager"]}),I()&&l.jsxs("button",{onClick:()=>u("/users"),className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-gray-50 text-gray-700 border border-gray-200 hover:bg-gray-100 rounded-md transition-colors",children:[l.jsx(y,{className:"w-3.5 h-3.5"}),"User Management"]})]})]})}),O&&l.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-2.5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsx(v,{className:"w-4 h-4 text-yellow-600"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-sm text-gray-900",children:[O.firstName," ",O.lastName]}),l.jsxs("div",{className:"text-xs text-gray-500",children:[O.email," â€¢ Executive Management"]})]})]}),("super-user"===C?.role||"reseller"===C?.role)&&l.jsxs("div",{className:"flex items-center gap-1",children:[O.isActive?l.jsx("button",{onClick:()=>K(O.id),className:"p-1.5 hover:bg-red-100 rounded transition-colors group",title:"Archive business owner",children:l.jsx(w,{className:"w-3.5 h-3.5 text-gray-500 group-hover:text-red-600"})}):l.jsx("button",{onClick:()=>X(O.id),className:"p-1.5 hover:bg-green-100 rounded transition-colors group",title:"Restore business owner",children:l.jsx(A,{className:"w-3.5 h-3.5 text-gray-500 group-hover:text-green-600"})}),l.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-medium "+(O.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:O.isActive?"Active":"Archived"})]}),"executive-management"===C?.role&&l.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Current User"})]})}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-2.5",children:[l.jsxs("h3",{className:"text-sm font-bold text-gray-900 flex items-center gap-1.5 mb-2",children:[l.jsx(N,{className:"w-4 h-4 text-blue-600"}),"HR Managers (",E.filter(e=>"hr-manager"===k(e.role)).length,")"]}),l.jsxs("div",{className:"space-y-1.5",children:[E.filter(e=>"hr-manager"===k(e.role)).map(e=>l.jsx("div",{className:"bg-gray-50 rounded p-2 border border-gray-100",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-7 h-7 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsxs("span",{className:"font-semibold text-blue-600 text-xs",children:[e.firstName?.[0],e.lastName?.[0]]})}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-medium text-xs text-gray-900",children:[e.firstName," ",e.lastName]}),l.jsx("div",{className:"text-xs text-gray-500",children:e.email})]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[e.isActive?l.jsx("button",{onClick:()=>K(e.id),className:"p-2 hover:bg-red-100 rounded-lg transition-colors group",title:"Archive user",children:l.jsx(w,{className:"w-4 h-4 text-gray-500 group-hover:text-red-600"})}):l.jsx("button",{onClick:()=>X(e.id),className:"p-2 hover:bg-green-100 rounded-lg transition-colors group",title:"Restore user",children:l.jsx(A,{className:"w-4 h-4 text-gray-500 group-hover:text-green-600"})}),l.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium "+(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Archived"})]})]})},e.id)),0===E.filter(e=>"hr-manager"===k(e.role)).length&&l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx(N,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),l.jsx("p",{className:"text-sm",children:"No HR managers yet"})]})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-2.5",children:[l.jsxs("h3",{className:"text-sm font-bold text-gray-900 flex items-center gap-1.5 mb-2",children:[l.jsx(f,{className:"w-4 h-4 text-green-600"}),"Department Managers (",E.filter(e=>"hod-manager"===k(e.role)).length,")"]}),l.jsxs("div",{className:"space-y-1.5",children:[E.filter(e=>"hod-manager"===k(e.role)).map(e=>l.jsx("div",{className:"bg-gray-50 rounded p-2 border border-gray-100",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-7 h-7 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsxs("span",{className:"font-semibold text-green-600 text-xs",children:[e.firstName?.[0],e.lastName?.[0]]})}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-medium text-xs text-gray-900",children:[e.firstName," ",e.lastName]}),l.jsxs("div",{className:"text-xs text-gray-500",children:[e.email,e.departmentIds&&e.departmentIds.length>0&&l.jsxs("span",{className:"ml-1 text-green-600",children:["â€¢ ",e.departmentIds.map(e=>P.find(s=>s.id===e)?.name||e).join(", ")]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[e.isActive?l.jsx("button",{onClick:()=>K(e.id),className:"p-2 hover:bg-red-100 rounded-lg transition-colors group",title:"Archive user",children:l.jsx(w,{className:"w-4 h-4 text-gray-500 group-hover:text-red-600"})}):l.jsx("button",{onClick:()=>X(e.id),className:"p-2 hover:bg-green-100 rounded-lg transition-colors group",title:"Restore user",children:l.jsx(A,{className:"w-4 h-4 text-gray-500 group-hover:text-green-600"})}),l.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium "+(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Archived"})]})]})},e.id)),0===E.filter(e=>"hod-manager"===k(e.role)).length&&l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx(f,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),l.jsx("p",{className:"text-sm",children:"No department managers yet"})]})]})]})]}),R()&&P.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-2.5",children:[l.jsxs("h3",{className:"text-sm font-bold text-gray-900 flex items-center gap-1.5 mb-2",children:[l.jsx(b,{className:"w-4 h-4 text-orange-600"}),"Departments (",P.length,")"]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:P.map(e=>l.jsxs("div",{onClick:i,className:"bg-orange-50 rounded p-2 border border-orange-200 cursor-pointer hover:bg-orange-100 hover:border-orange-300 transition-all duration-200 active:scale-95",title:"Click to manage departments",children:[l.jsx("div",{className:"mb-1",children:l.jsx("h4",{className:"font-semibold text-xs text-gray-900",children:e.name})}),e.managerName?l.jsxs("div",{className:"text-sm text-green-700 font-medium mb-2",children:["ðŸ‘¤ ",e.managerName]}):l.jsx("div",{className:"text-sm text-orange-600 font-medium mb-2",children:"âš ï¸ No manager assigned"}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[l.jsx(f,{className:"w-4 h-4"}),e.employeeCount," employees"]})]},e.id))})]})]}),W.isOpen&&W.data&&d.createPortal(l.jsx(S,{isOpen:W.isOpen,onClose:W.close,onSuccess:()=>{const e="hr-manager"===W.data?"HR Manager":"Department Manager";Y(`âœ… ${e} created successfully! User can now sign in with their email and password 'temp123'.`),setTimeout(()=>Y(null),5e3),G()},userRole:W.data,employees:H}),document.body)]})});D.displayName="OrganizationManagementV2";export{D as OrganizationManagementV2};
