import{a as e}from"./pdf-vendor-tUwojRr6.js";import{M as t,R as o,L as a}from"./business-owner-dashboard-SKPFtfOP.js";import"./react-vendor-CWjEGAcE.js";import"./firebase-vendor-BQc9GSQK.js";import"./ui-vendor-CbYg3h9k.js";class i{static async generateWarningPDF(i){try{const n=t||{isLegacyDevice:!1};o(n);if(n.isLegacyDevice)return a.warn("üö® Legacy device detected - using simplified PDF generation"),this.generateSimplifiedPDF(i);i.employee,i.organization,!i.description&&i.incidentLocation,i.employee&&(i.employee.firstName,i.employee.lastName),i.organization,i.warningLevel,i.category;Date.now();const{default:s}=await e(async()=>{const{default:e}=await import("./pdf-vendor-tUwojRr6.js").then(e=>e.j);return{default:e}},[]),r=new s({orientation:"portrait",unit:"mm",format:"a4",compress:!0});a.success(3579),r.setFont("helvetica","normal");let l=15;const c=r.internal.pageSize.width,d=r.internal.pageSize.height,p=20,h=40;l=this.addOrganizationHeader(r,i.organization,l,c,p),a.success(4172),l=this.addDocumentTitle(r,i,l,c,p,d,h),a.success(4459),l=this.addEmployeeSection(r,i.employee,l,c,p,d,h),a.success(4759),l=this.addWarningDetailsSection(r,i,l,c,p,d,h),a.success(5060),l=this.addIncidentDetailsSection(r,i,l,c,p,d,h),a.success(5387),i.disciplineRecommendation&&(l=this.addProgressiveDisciplineSection(r,i.disciplineRecommendation,l,c,p,d,h),a.success(5796)),i.legalCompliance&&(l=this.addLegalComplianceSection(r,i.legalCompliance,l,c,p,d,h),a.success(6262)),i.additionalNotes&&(l=this.addAdditionalNotesSection(r,i.additionalNotes,l,c,p,d,h),a.success(6716)),l=this.addEmployeeRightsSection(r,i,l,c,p,d,h),a.success("‚úÖ Employee rights section added"),l=this.addSignaturesSection(r,i.signatures,i.employee,l,c,p,d,h),a.success(7166),i.deliveryChoice&&(l=this.addDeliverySection(r,i.deliveryChoice,l,c,p,d,h),a.success(7512)),(i.appealDetails||i.appealOutcome)&&(l=this.addAppealHistorySection(r,i,l,c,p,d,h),a.success("‚úÖ Appeal history section added")),this.addDocumentFooter(r,i,c),a.success(7804),this.addSecurityWatermark(r,c),a.success(7997),"overturned"===i.status&&(this.addOverturnedWatermark(r,c),a.success("‚úÖ OVERTURNED watermark added to all pages"));const m=r.output("blob");Date.now();return i.warningId,i.employee.firstName,i.employee.lastName,(m.size/1024).toFixed(1),m}catch(n){throw a.error("‚ùå PDF generation failed:",n),new Error(`PDF generation failed: ${n instanceof Error?n.message:"Unknown error"}`)}}static addOrganizationHeader(e,t,o,i,n){const s=this.parseColor(t.branding?.colors?.primary)||{r:59,g:130,b:246};e.setFillColor(s.r,s.g,s.b),e.rect(0,0,i,35,"F");let r=0;if(t.branding?.logo)try{const o=20;r=30,e.addImage(t.branding.logo,"PNG",n,7,r,o)}catch(d){a.warn("Failed to add organization logo to PDF:",d),r=0}e.setTextColor(255,255,255),e.setFontSize(20),e.setFont("helvetica","bold");const l=t.branding?.companyName||t.name||"Organization Name";e.text(l,n+r+(r>0?10:0),15),e.setFontSize(10),e.setFont("helvetica","normal");const c=[];return t.address&&c.push(t.address),t.phone&&c.push(`Tel: ${t.phone}`),t.email&&c.push(`Email: ${t.email}`),c.length>0&&e.text(c.join(" | "),n,25),t.registrationNumber&&e.text(`Registration: ${t.registrationNumber}`,n,30),45}static addDocumentTitle(e,t,o,a,i,n,s){o=this.checkPageOverflow(e,o,30,n,s),e.setTextColor(0,0,0),e.setFontSize(18),e.setFont("helvetica","bold");const r=this.getWarningLevelTitle(t.warningLevel),l=e.getTextWidth(r),c=(a-l)/2;e.text(r,c,o);if("Employee"===t.employee?.firstName||"Category Not Selected"===t.category||!t.description?.trim()){e.setFontSize(12),e.setTextColor(200,50,50);const t="[DRAFT - INCOMPLETE DATA]",i=(a-e.getTextWidth(t))/2;e.text(t,i,o+6),o+=6}e.setTextColor(0,0,0),e.setLineWidth(.5),e.line(c,o+2,c+l,o+2),e.setFontSize(10),e.setFont("helvetica","normal");const d=`Document ID: ${t.warningId} | Issue Date: ${this.formatDate(t.issuedDate)}`,p=(a-e.getTextWidth(d))/2;return e.text(d,p,o+8),o+20}static addEmployeeSection(e,t,o,a,i,n,s){o=this.checkPageOverflow(e,o,40,n,s),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("EMPLOYEE INFORMATION",i,o);const r="Employee"===t.firstName||"Not Selected"===t.lastName;r?e.setDrawColor(255,200,200):e.setDrawColor(200,200,200),e.setLineWidth(.3),e.rect(i,o+2,a-2*i,25),r&&(e.setFillColor(255,245,245),e.rect(i+1,o+3,a-2*i-2,23,"F")),e.setFontSize(10),e.setFont("helvetica","normal"),r?e.setTextColor(150,0,0):e.setTextColor(0,0,0);const l=[`Name: ${t.firstName} ${t.lastName}`,`Employee ID: ${t.employeeNumber}`,`Position: ${t.position}`,`Department: ${t.department}`];t.email&&""!==t.email&&l.push(`Email: ${t.email}`),r&&l.push("‚ö†Ô∏è Complete employee selection in wizard for full details");let c=o+8;return l.forEach(t=>{e.text(t,i+3,c),c+=4}),o+35}static addWarningDetailsSection(e,t,o,a,i,n,s){o=this.checkPageOverflow(e,o,25,n,s),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("WARNING DETAILS",i,o);const r="Category Not Selected"===t.category;e.setFontSize(10),e.setFont("helvetica","normal"),r?e.setTextColor(150,0,0):e.setTextColor(0,0,0);let l=o+8;e.text(`Warning Level: ${this.getWarningLevelDisplay(t.warningLevel)}`,i,l),l+=5;const c=t.category&&"Unknown"!==t.category&&"Category Not Selected"!==t.category?t.category:"General Misconduct";return e.text(`Category: ${c}`,i,l),l+=5,t.validityPeriod&&(e.text(`Validity Period: ${t.validityPeriod} months`,i,l),l+=5),l+5}static addIncidentDetailsSection(e,t,o,a,i,n,s){const r=this.calculateIncidentSectionHeight(e,t,a,i);o=this.checkPageOverflow(e,o,r,n,s),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("INCIDENT DETAILS",i,o);const l=t.description&&""!==t.description.trim(),c=t.incidentLocation&&""!==t.incidentLocation.trim(),d=!l&&!c,p=this.calculateIncidentSectionHeight(e,t,a,i);d?e.setDrawColor(255,200,200):e.setDrawColor(200,200,200),e.setLineWidth(.3),e.rect(i,o+2,a-2*i,p),d&&(e.setFillColor(255,245,245),e.rect(i+1,o+3,a-2*i-2,p-2,"F")),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0);let h=o+10;e.setFont("helvetica","bold"),e.text("Date & Time:",i+3,h),e.setFont("helvetica","normal"),e.text(`${this.formatDate(t.incidentDate)} at ${t.incidentTime}`,i+30,h),h+=6,e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("Location:",i+3,h),e.setFont("helvetica","normal");const m=c?t.incidentLocation:"Not specified";e.text(m,i+25,h),h+=6,e.setFont("helvetica","bold"),e.text("Description:",i+3,h),h+=5,e.setFont("helvetica","normal");const g=l?t.description:"Details to be completed";return this.wrapText(e,g,a-2*i-6).forEach(t=>{e.text(t,i+3,h),h+=4}),o+p+10}static addProgressiveDisciplineSection(e,t,o,a,i,n,s){if(!t)return o;o=this.checkPageOverflow(e,o,35,n,s),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("PROGRESSIVE DISCIPLINE ANALYSIS",i,o),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0);let r=o+8;if(e.text(`Recommended Level: ${this.getWarningLevelDisplay(t.suggestedLevel)}`,i,r),r+=5,e.text(`Previous Warnings: ${t.warningCount}`,i,r),r+=5,t.reason){e.text("Escalation Reason:",i,r),r+=4;this.wrapText(e,t.reason,a-2*i).forEach(t=>{e.text(t,i+3,r),r+=4})}return r+5}static addLegalComplianceSection(e,t,o,a,i,n,s){if(!t)return o;o=this.checkPageOverflow(e,o,30,n,s),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("LEGAL COMPLIANCE",i,o),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0);let r=o+8;return e.text(`Framework: ${t.framework}`,i,r),r+=5,e.text("Compliance Status: "+(t.isCompliant?"COMPLIANT":"NON-COMPLIANT"),i,r),r+=5,t.requirements.length>0&&(e.text("Legal Requirements:",i,r),r+=4,t.requirements.forEach(t=>{e.text(`‚Ä¢ ${t}`,i+3,r),r+=4})),r+5}static addAdditionalNotesSection(e,t,o,a,i,n,s){const r=this.wrapText(e,t,a-2*i),l=15+4*r.length;o=this.checkPageOverflow(e,o,l,n,s),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("ADDITIONAL NOTES",i,o),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0);let c=o+8;return r.forEach(t=>{e.text(t,i,c),c+=4}),c+5}static addEmployeeRightsSection(e,t,o,a,i,n,s){o=this.checkPageOverflow(e,o,95,n,s),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("‚öñÔ∏è  EMPLOYEE RIGHTS AND NEXT STEPS",i,o);const r=a-2*i;e.setFillColor(239,246,255),e.setDrawColor(59,130,246),e.setLineWidth(.5),e.rect(i,o+3,r,85,"FD");let l=o+12;const c=i+5;e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(37,99,235),e.text("Your Rights:",c,l),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),l+=6;this.wrapText(e,"‚Ä¢ Right to Appeal: You may appeal this warning within 48 hours by submitting a written appeal to HR. If your internal appeal is unsuccessful, you may refer the matter to the CCMA within 30 days.",r-15).forEach(t=>{e.text(t,c,l),l+=4}),l+=1;this.wrapText(e,"‚Ä¢ Right to Representation: You have the right to be represented by a fellow employee or shop steward during disciplinary proceedings.",r-15).forEach(t=>{e.text(t,c,l),l+=4}),l+=1;this.wrapText(e,"‚Ä¢ Signing This Document: Your signature acknowledges that this warning has been explained to you. It does NOT mean you agree with the warning.",r-15).forEach(t=>{e.text(t,c,l),l+=4}),l+=1;this.wrapText(e,"‚Ä¢ Confidentiality: All information will be kept confidential and shared only with relevant management and HR personnel.",r-15).forEach(t=>{e.text(t,c,l),l+=4}),l+=3,e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(37,99,235),e.text("What Happens Next:",c,l),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),l+=6;const d=`‚Ä¢ This warning remains valid for ${t.validityPeriod||6} months from the date of issue.`;e.text(d,c,l),l+=4;this.wrapText(e,"‚Ä¢ During this period, similar conduct may result in further disciplinary action, up to and including dismissal.",r-15).forEach(t=>{e.text(t,c,l),l+=4}),l+=1;this.wrapText(e,"‚Ä¢ You are expected to demonstrate immediate and sustained improvement in your conduct.",r-15).forEach(t=>{e.text(t,c,l),l+=4}),l+=3,e.setFontSize(11),e.setFont("helvetica","bold"),e.setTextColor(37,99,235),e.text("Important Notice:",c,l),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),l+=6;return this.wrapText(e,"If you believe this warning is procedurally unfair or unjust, you have recourse through your company's internal appeal process or the Commission for Conciliation, Mediation and Arbitration (CCMA).",r-15).forEach(t=>{e.text(t,c,l),l+=4}),o+85+10}static addSignaturesSection(e,t,o,i,n,s,r,l){i=this.checkPageOverflow(e,i,50,r,l),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("SIGNATURES",s,i);const c=(n-3*s)/2;if(e.setDrawColor(150,150,150),e.setLineWidth(.3),e.rect(s,i+5,c,30),e.setFontSize(10),e.setFont("helvetica","normal"),e.text("Manager Signature:",s+2,i+12),t?.manager)try{const o=c-4,a=15;e.addImage(t.manager,"PNG",s+2,i+15,o,a),e.setFontSize(8),e.text(`Date: ${this.formatDate(new Date)}`,s+2,i+32)}catch(d){a.warn("Failed to embed manager signature image:",d),e.setFontSize(8),e.text("‚úì Digitally Signed",s+2,i+20),e.text(`Date: ${this.formatDate(new Date)}`,s+2,i+25)}else e.text("_________________________",s+2,i+25),e.text("Date: ___________",s+2,i+30);if(e.rect(s+c+10,i+5,c,30),e.text("Employee Signature:",s+c+12,i+12),e.text(`${o.firstName} ${o.lastName}`,s+c+12,i+16),t?.employee)try{const o=c-4,a=15;e.addImage(t.employee,"PNG",s+c+12,i+15,o,a),e.setFontSize(8),e.text(`Date: ${this.formatDate(new Date)}`,s+c+12,i+32)}catch(d){a.warn("Failed to embed employee signature image:",d),e.setFontSize(8),e.text("‚úì Digitally Signed",s+c+12,i+20),e.text(`Date: ${this.formatDate(new Date)}`,s+c+12,i+25)}else e.text("_________________________",s+c+12,i+25),e.text("Date: ___________",s+c+12,i+30);return i+30+15}static addDeliverySection(e,t,o,a,i,n,s){if(!t)return o;o=this.checkPageOverflow(e,o,20,n,s),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(51,51,51),e.text("DELIVERY INFORMATION",i,o),e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0);let r=o+6;return e.text(`Delivery Method: ${t.method.toUpperCase()}`,i,r),r+=4,e.text(`Delivery Date: ${this.formatDate(t.timestamp)}`,i,r),r+=4,e.text(`Authorized by: ${t.chosenBy}`,i,r),r+8}static addAppealHistorySection(e,t,o,a,i,n,s){o=this.checkPageOverflow(e,o,40,n,s),e.setFontSize(12),e.setFont("helvetica","bold"),e.setTextColor(102,45,145),e.text("APPEAL HISTORY",i,o);let r=o+6;if(t.appealDetails){if(e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("Employee Appeal Submission",i,r),r+=5,e.setFont("helvetica","normal"),e.setFontSize(9),t.appealDetails.submittedAt&&(e.text(`Submitted: ${this.formatDate(t.appealDetails.submittedAt)}`,i,r),r+=4),t.appealDetails.submittedBy&&(e.text(`Submitted by: ${t.appealDetails.submittedBy}`,i,r),r+=4),t.appealDetails.grounds){e.setFont("helvetica","bold"),e.text("Grounds for Appeal:",i,r),r+=4,e.setFont("helvetica","normal");const o=e.splitTextToSize(t.appealDetails.grounds,a-2*i-5);e.text(o,i+5,r),r+=4*o.length+2}if(t.appealDetails.details){e.setFont("helvetica","bold"),e.text("Additional Details:",i,r),r+=4,e.setFont("helvetica","normal");const o=e.splitTextToSize(t.appealDetails.details,a-2*i-5);e.text(o,i+5,r),r+=4*o.length+2}if(t.appealDetails.requestedOutcome){e.setFont("helvetica","bold"),e.text("Requested Outcome:",i,r),r+=4,e.setFont("helvetica","normal");const o=e.splitTextToSize(t.appealDetails.requestedOutcome,a-2*i-5);e.text(o,i+5,r),r+=4*o.length+4}}if(t.appealOutcome){r=this.checkPageOverflow(e,r,30,n,s),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("HR Decision",i,r),r+=5,e.setFont("helvetica","normal"),e.setFontSize(9),t.appealDecisionDate&&(e.text(`Decision Date: ${this.formatDate(t.appealDecisionDate)}`,i,r),r+=4),e.setFont("helvetica","bold"),e.text("Outcome: ",i,r);const o="overturned"===t.appealOutcome?"WARNING OVERTURNED":"upheld"===t.appealOutcome?"APPEAL DENIED - WARNING STANDS":"modified"===t.appealOutcome?"WARNING MODIFIED":"reduced"===t.appealOutcome?"WARNING REDUCED":t.appealOutcome.toUpperCase();if("overturned"===t.appealOutcome?e.setTextColor(34,139,34):"upheld"===t.appealOutcome?e.setTextColor(178,34,34):e.setTextColor(255,140,0),e.text(o,i+20,r),e.setTextColor(0,0,0),r+=5,t.appealReasoning){e.setFont("helvetica","bold"),e.text("HR Reasoning:",i,r),r+=4,e.setFont("helvetica","normal");const o=e.splitTextToSize(t.appealReasoning,a-2*i-5);e.text(o,i+5,r),r+=4*o.length+2}if(t.hrNotes){e.setFont("helvetica","bold"),e.text("HR Notes:",i,r),r+=4,e.setFont("helvetica","normal");const o=e.splitTextToSize(t.hrNotes,a-2*i-5);e.text(o,i+5,r),r+=4*o.length+2}if(t.followUpRequired){e.setDrawColor(255,193,7),e.setFillColor(255,248,220),e.roundedRect(i,r,a-2*i,10,2,2,"FD"),e.setFont("helvetica","bold"),e.setTextColor(139,69,19);const o=t.followUpDate?`‚ö† Follow-up Required by ${this.formatDate(t.followUpDate)}`:"‚ö† Follow-up Required";e.text(o,i+2,r+6),e.setTextColor(0,0,0),r+=12}}return r+8}static addDocumentFooter(e,t,o){const a=e.internal.pageSize.height,i=e.getNumberOfPages();for(let n=1;n<=i;n++){e.setPage(n),e.setDrawColor(180,180,180),e.setLineWidth(.3),e.line(20,a-25,o-20,a-25),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(120,120,120);const t="This document has been generated electronically and constitutes an official warning as per LRA Section 188.",s=(o-e.getTextWidth(t))/2;e.text(t,s,a-20);const r="CONFIDENTIAL DOCUMENT - For authorized personnel only",l=(o-e.getTextWidth(r))/2;e.text(r,l,a-15),e.text(`Generated: ${(new Date).toLocaleString()}`,20,a-10),e.text(`Page ${n} of ${i}`,o-50,a-10)}}static addSecurityWatermark(e,t){const o=e.internal.pageSize.height,a=e.getNumberOfPages();for(let i=1;i<=a;i++){e.setPage(i),e.saveGraphicsState(),e.setGState(new e.GState({opacity:.1})),e.setTextColor(150,150,150),e.setFontSize(40),e.setFont("helvetica","bold");const a=t/2,n=o/2;e.text("OFFICIAL WARNING",a,n,{angle:45,align:"center"}),e.restoreGraphicsState()}}static addOverturnedWatermark(e,t){const o=e.internal.pageSize.height,a=e.getNumberOfPages();for(let i=1;i<=a;i++){e.setPage(i),e.saveGraphicsState(),e.setGState(new e.GState({opacity:.35})),e.setTextColor(255,0,0),e.setFontSize(60),e.setFont("helvetica","bold");const a=t/2,n=o/2;e.text("OVERTURNED",a,n,{angle:45,align:"center"}),e.restoreGraphicsState()}}static async generateAppealReportPDF(t){try{const{default:o}=await e(async()=>{const{default:e}=await import("./pdf-vendor-tUwojRr6.js").then(e=>e.j);return{default:e}},[]),i=new o({orientation:"portrait",unit:"mm",format:"a4"}),n=i.internal.pageSize.width,s=i.internal.pageSize.height,r=20;let l=20;if(i.setFillColor(37,99,235),i.rect(0,0,n,40,"F"),i.setTextColor(255,255,255),i.setFontSize(22),i.setFont("helvetica","bold"),i.text("APPEAL DECISION REPORT",n/2,18,{align:"center"}),i.setFontSize(11),i.setFont("helvetica","normal"),i.text(t.organization.name,n/2,28,{align:"center"}),l=50,i.setDrawColor(200,200,200),i.setFillColor(248,248,248),i.roundedRect(r,l,n-2*r,35,3,3,"FD"),i.setTextColor(0,0,0),i.setFontSize(10),i.setFont("helvetica","bold"),i.text("Warning Reference",r+5,l+7),i.setFont("helvetica","normal"),i.setFontSize(9),i.text(`Warning ID: ${t.warningId}`,r+5,l+13),i.text(`Employee: ${t.employee.firstName} ${t.employee.lastName} (${t.employee.employeeNumber})`,r+5,l+18),i.text(`Department: ${t.employee.department}`,r+5,l+23),i.text(`Warning Level: ${t.warningLevel}`,r+5,l+28),i.text(`Original Issue Date: ${this.formatDate(t.issueDate)}`,n-r-60,l+13),i.text(`Category: ${t.category}`,n-r-60,l+18),l+=43,t.appealDetails){if(i.setFontSize(14),i.setFont("helvetica","bold"),i.setTextColor(102,45,145),i.text("1. APPEAL SUBMISSION",r,l),l+=8,i.setFillColor(245,243,255),i.setDrawColor(167,139,250),i.roundedRect(r,l,n-2*r,12,2,2,"FD"),i.setTextColor(0,0,0),i.setFontSize(9),i.setFont("helvetica","bold"),i.text(`Submitted: ${t.appealDetails.submittedAt?this.formatDate(t.appealDetails.submittedAt):"N/A"}`,r+5,l+5),i.text(`By: ${t.appealDetails.submittedBy||"Employee"}`,r+5,l+9),l+=15,t.appealDetails.grounds){i.setFont("helvetica","bold"),i.setFontSize(10),i.text("Grounds for Appeal:",r,l),l+=5,i.setFont("helvetica","normal"),i.setFontSize(9);const e=i.splitTextToSize(t.appealDetails.grounds,n-2*r-10);i.text(e,r+5,l),l+=4*e.length+5}if(t.appealDetails.details){i.setFont("helvetica","bold"),i.setFontSize(10),i.text("Additional Details:",r,l),l+=5,i.setFont("helvetica","normal"),i.setFontSize(9);const e=i.splitTextToSize(t.appealDetails.details,n-2*r-10);i.text(e,r+5,l),l+=4*e.length+5}if(t.appealDetails.requestedOutcome){i.setFont("helvetica","bold"),i.setFontSize(10),i.text("Requested Outcome:",r,l),l+=5,i.setFont("helvetica","normal"),i.setFontSize(9);const e=i.splitTextToSize(t.appealDetails.requestedOutcome,n-2*r-10);i.text(e,r+5,l),l+=4*e.length+8}}if(t.appealOutcome){l>s-100&&(i.addPage(),l=20),i.setFontSize(14),i.setFont("helvetica","bold"),i.setTextColor(102,45,145),i.text("2. HR DECISION",r,l),l+=8,i.setFillColor(245,243,255),i.setDrawColor(167,139,250),i.roundedRect(r,l,n-2*r,8,2,2,"FD"),i.setTextColor(0,0,0),i.setFontSize(9),i.setFont("helvetica","bold"),i.text(`Decision Date: ${t.appealDecisionDate?this.formatDate(t.appealDecisionDate):"Pending"}`,r+5,l+5),l+=12;const e="overturned"===t.appealOutcome?"APPEAL APPROVED - WARNING OVERTURNED":"upheld"===t.appealOutcome?"APPEAL DENIED - WARNING STANDS":"modified"===t.appealOutcome?"APPEAL PARTIALLY APPROVED - WARNING MODIFIED":"reduced"===t.appealOutcome?"APPEAL PARTIALLY APPROVED - WARNING REDUCED":t.appealOutcome.toUpperCase();if("overturned"===t.appealOutcome?i.setFillColor(34,197,94):"upheld"===t.appealOutcome?i.setFillColor(239,68,68):i.setFillColor(251,146,60),i.roundedRect(r,l,n-2*r,15,3,3,"F"),i.setTextColor(255,255,255),i.setFontSize(12),i.setFont("helvetica","bold"),i.text(e,n/2,l+10,{align:"center"}),l+=20,t.appealReasoning){i.setTextColor(0,0,0),i.setFont("helvetica","bold"),i.setFontSize(10),i.text("HR Reasoning:",r,l),l+=5,i.setFont("helvetica","normal"),i.setFontSize(9);const e=i.splitTextToSize(t.appealReasoning,n-2*r-10);i.text(e,r+5,l),l+=4*e.length+5}if(t.hrNotes){i.setFont("helvetica","bold"),i.setFontSize(10),i.text("HR Notes:",r,l),l+=5,i.setFont("helvetica","normal"),i.setFontSize(9);const e=i.splitTextToSize(t.hrNotes,n-2*r-10);i.text(e,r+5,l),l+=4*e.length+5}if(t.followUpRequired){i.setDrawColor(251,191,36),i.setFillColor(254,252,232),i.roundedRect(r,l,n-2*r,12,2,2,"FD"),i.setTextColor(146,64,14),i.setFontSize(10),i.setFont("helvetica","bold");const e=t.followUpDate?`‚ö† FOLLOW-UP REQUIRED BY: ${this.formatDate(t.followUpDate)}`:"‚ö† FOLLOW-UP REQUIRED";i.text(e,r+5,l+7),l+=15}}l<s-80?l=s-75:(i.addPage(),l=20),i.setFontSize(10),i.setFont("helvetica","bold"),i.setTextColor(0,0,0),i.text("HR Authorization:",r,l),l+=10,i.setDrawColor(0,0,0),i.line(r,l,r+70,l),i.setFontSize(8),i.setFont("helvetica","normal"),i.text("HR Manager Signature",r,l+5),i.line(n-r-70,l,n-r,l),i.text("Date",n-r-35,l+5);const c=i.getNumberOfPages(),d=s-25;for(let e=1;e<=c;e++){i.setPage(e),i.setDrawColor(180,180,180),i.setLineWidth(.3),i.line(r,d,n-r,d),i.setFontSize(8),i.setFont("helvetica","normal"),i.setTextColor(120,120,120);const t="Official Appeal Decision Report - Confidential HR Document";i.text(t,n/2,d+5,{align:"center"}),i.text(`Generated: ${(new Date).toLocaleString()}`,r,d+10),i.text(`Page ${e} of ${c}`,n-r-20,d+10)}return a.success("‚úÖ Appeal Report PDF generated"),i.output("blob")}catch(o){throw a.error("‚ùå Failed to generate appeal report:",o),console.error("Appeal report generation error details:",o),console.error("Stack trace:",o instanceof Error?o.stack:"No stack trace"),o instanceof Error?o:new Error("Failed to generate appeal report PDF")}}static checkPageOverflow(e,t,o,a,i){return t+o>a-i?(e.addPage(),20):t}static addPageHeader(e,t,o){const a=e.internal.pageSize.width;e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(100,100,100);const i=`${t.organization.name} - Warning Document (Continued)`;e.text(i,20,10);const n=`Page ${o}`;e.text(n,a-40,10),e.setDrawColor(200,200,200),e.setLineWidth(.3),e.line(20,12,a-20,12)}static getWarningLevelDisplay(e){return{counselling:"Counselling Session",verbal:"Verbal Warning",first_written:"First Written Warning",second_written:"Second Written Warning",final_written:"Final Written Warning",suspension:"Suspension",dismissal:"Dismissal"}[e]||e.replace("_"," ").toUpperCase()}static getWarningLevelTitle(e){return{counselling:"COUNSELLING SESSION RECORD",verbal:"VERBAL WARNING NOTICE",first_written:"FIRST WRITTEN WARNING",second_written:"SECOND WRITTEN WARNING",final_written:"FINAL WRITTEN WARNING",suspension:"SUSPENSION NOTICE",dismissal:"DISMISSAL NOTICE"}[e]||"WARNING NOTICE"}static formatDate(e){let t;return t=e?void 0!==e.seconds?new Date(1e3*e.seconds):e instanceof Date?e:"string"==typeof e||"number"==typeof e?new Date(e):new Date:new Date,t.toLocaleDateString("en-ZA",{year:"numeric",month:"long",day:"numeric"})}static wrapText(e,t,o){const a=t.split(" "),i=[];let n="";return a.forEach(t=>{const a=n+(n?" ":"")+t;e.getTextWidth(a)<=o?n=a:(n&&i.push(n),n=t)}),n&&i.push(n),i}static calculateIncidentSectionHeight(e,t,o,a){let i=25;const n=t.description&&""!==t.description.trim()?t.description:"[Incident description not provided - complete in wizard]";i+=4*this.wrapText(e,n,o-2*a-6).length;const s=t.description&&""!==t.description.trim(),r=t.incidentLocation&&""!==t.incidentLocation.trim();return!s&&!r&&(i+=10),Math.max(i,45)}static parseColor(e){if(!e)return null;if(e.startsWith("#")){const t=e.substring(1);if(6===t.length)return{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}}return null}static async generateSimplifiedPDF(t){try{const{default:o}=await e(async()=>{const{default:e}=await import("./pdf-vendor-tUwojRr6.js").then(e=>e.j);return{default:e}},[]),a=new o({orientation:"portrait",unit:"mm",format:"a4",compress:!0});let i=20;const n=15,s=6;a.setFont("helvetica","normal"),a.setFontSize(16),a.text("DISCIPLINARY WARNING",n,i),i+=2*s,a.setFontSize(12),t.organization?.name&&(a.text(`Organization: ${t.organization.name}`,n,i),i+=s),i+=s,a.setFontSize(11),a.text("EMPLOYEE DETAILS:",n,i),i+=s,a.setFontSize(10);[`Name: ${t.employee.firstName} ${t.employee.lastName}`,`Employee ID: ${t.employee.employeeNumber}`,`Department: ${t.employee.department}`,`Position: ${t.employee.position}`].forEach(e=>{a.text(e,n+5,i),i+=s}),i+=s,a.setFontSize(11),a.text("WARNING DETAILS:",n,i),i+=s,a.setFontSize(10);[`Date: ${t.issuedDate.toLocaleDateString()}`,`Category: ${t.category}`,`Level: ${t.warningLevel}`,`Location: ${t.incidentLocation||"Not specified"}`].forEach(e=>{a.text(e,n+5,i),i+=s}),i+=s,a.setFontSize(11),a.text("INCIDENT DESCRIPTION:",n,i),i+=s,a.setFontSize(10);const r=170;a.splitTextToSize(t.description,r).forEach(e=>{i>270&&(a.addPage(),i=20),a.text(e,n+5,i),i+=s}),i+=2*s,i>240&&(a.addPage(),i=20),a.setFontSize(11),a.text("SIGNATURES:",n,i),i+=2*s,a.setFontSize(10),a.text("Manager: ________________________",n,i),i+=s,a.text(`Date: ${t.issuedDate.toLocaleDateString()}`,n,i),i+=3*s,a.text("Employee: _______________________ ",n,i),i+=s,a.text("Date: _______________",n,i);const l=a.internal.pageSize.height;a.setFontSize(8),a.text("Generated by HR System - Simplified for mobile device",n,l-10);const c=a.output("blob");return window.gc&&setTimeout(()=>window.gc(),100),c}catch(o){return a.error("‚ùå Simplified PDF generation failed:",o),this.generatePlainTextPDF(t)}}static async generatePlainTextPDF(t){try{const{default:o}=await e(async()=>{const{default:e}=await import("./pdf-vendor-tUwojRr6.js").then(e=>e.j);return{default:e}},[]),a=new o;a.setFontSize(12);let i=20;const n=10;return["DISCIPLINARY WARNING","",`Employee: ${t.employee.firstName} ${t.employee.lastName}`,`Date: ${t.issuedDate.toLocaleDateString()}`,`Category: ${t.category}`,`Level: ${t.warningLevel}`,"","Description:",t.description,"","This is a simplified version generated for older devices."].forEach(e=>{i>280&&(a.addPage(),i=20),a.text(e,20,i),i+=n}),a.output("blob")}catch(o){throw a.error("‚ùå Even plain text PDF failed:",o),new Error("PDF generation not supported on this device")}}}export{i as PDFGenerationService};
