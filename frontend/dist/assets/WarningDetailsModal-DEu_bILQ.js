const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboard-router-DriKLXjX.js","assets/business-owner-dashboard-Cw2S2b3C.js","assets/pdf-vendor-CbrIsI36.js","assets/react-vendor-BMk1H4su.js","assets/firebase-vendor-BIBOIkWK.js","assets/ui-vendor-DjDr2yFV.js","assets/hr-dashboard-DCNKcWEX.js","assets/hod-dashboard-BWpKy7JX.js"])))=>i.map(i=>d[i]);
import{a as e}from"./pdf-vendor-CbrIsI36.js";import{j as a,L as s,a as t}from"./business-owner-dashboard-Cw2S2b3C.js";import{r}from"./react-vendor-BMk1H4su.js";import{u as l,Z as i}from"./dashboard-router-DriKLXjX.js";import{aW as n,L as d,j as o,k as c,aX as m,aJ as x,a8 as g,ah as u,n as p,S as h,I as y,T as b,v as j,ai as N,aY as f,s as v,aZ as w,a_ as D,c as S,X as k,ao as C,at as A,a$ as R,F as L,ak as P}from"./ui-vendor-DjDr2yFV.js";import{P as T}from"./warning-components-D4Kh8JfB.js";import"./firebase-vendor-BIBOIkWK.js";import"./hr-dashboard-DCNKcWEX.js";import"./hod-dashboard-BWpKy7JX.js";const E=e=>e?e.deleted?{status:"deleted",message:"This audio recording has been permanently deleted.",canPlay:!1}:e.autoDeleteDate&&new Date>new Date(e.autoDeleteDate)?{status:"expired",message:"This audio recording has expired and is no longer available.",canPlay:!1}:"processing"===e.processingStatus?{status:"processing",message:"Audio is still being processed. Please try again in a moment.",canPlay:!1}:"failed"===e.processingStatus?{status:"failed",message:"Audio processing failed. The recording may be corrupted.",canPlay:!1}:e.storageUrl||e.url?{status:"available",message:"Audio recording is ready to play.",canPlay:!0}:{status:"unavailable",message:"Audio URL is not available. The recording may not have been uploaded properly.",canPlay:!1}:{status:"not-available",message:"Audio recording not available.",canPlay:!1},O=({audioRecording:e,warningId:t,showDownload:l=!0,showMetadata:i=!0,showTranscript:f=!1,compact:v=!1,autoPlay:w=!1,className:D=""})=>{if(!e)return a.jsx("div",{className:`bg-gray-50 border border-gray-200 rounded-lg p-4 ${D}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-lg flex items-center justify-center",children:a.jsx(n,{className:"w-5 h-5 text-gray-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"No audio recording available"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Audio recording not found or not provided"})]})]})});const S=r.useRef(null),k=r.useRef(null),[C,A]=r.useState({isLoading:!0,isPlaying:!1,currentTime:0,duration:0,volume:1,isMuted:!1,error:null,buffered:0}),R=E(e),L=(e=>E(e).canPlay)(e),P=(e=>"deleted"===E(e).status)(e),T=(e=>"expired"===E(e).status)(e),O=e?.storageUrl||e?.url;r.useEffect(()=>{const e=S.current;if(!e||!L||!O)return void A(e=>({...e,isLoading:!1,error:L?"No audio URL available":R.message}));e.src=O;const a=()=>{A(e=>({...e,isLoading:!0,error:null}))},t=()=>{A(a=>({...a,duration:e.duration||0,isLoading:!1}))},r=()=>{A(a=>({...a,currentTime:e.currentTime||0}))},l=()=>{A(e=>({...e,isPlaying:!0}))},i=()=>{A(e=>({...e,isPlaying:!1}))},n=()=>{A(e=>({...e,isPlaying:!1,currentTime:0})),e&&(e.currentTime=0)},d=e=>{s.error("Audio loading error:",e),A(e=>({...e,isLoading:!1,isPlaying:!1,error:"Failed to load audio recording. The file may be corrupted or unavailable."}))},o=()=>{if(e.buffered.length>0){const a=e.buffered.end(e.buffered.length-1),s=e.duration||0;A(e=>({...e,buffered:s?a/s*100:0}))}};return e.addEventListener("loadstart",a),e.addEventListener("loadedmetadata",t),e.addEventListener("timeupdate",r),e.addEventListener("play",l),e.addEventListener("pause",i),e.addEventListener("ended",n),e.addEventListener("error",d),e.addEventListener("progress",o),e.load(),()=>{e.removeEventListener("loadstart",a),e.removeEventListener("loadedmetadata",t),e.removeEventListener("timeupdate",r),e.removeEventListener("play",l),e.removeEventListener("pause",i),e.removeEventListener("ended",n),e.removeEventListener("error",d),e.removeEventListener("progress",o)}},[L,O,R.message]),r.useEffect(()=>{w&&S.current&&!C.isLoading&&!C.error&&L&&S.current.play().catch(e=>s.warn("Audio autoplay failed",e))},[w,C.isLoading,C.error,L]);const I=r.useCallback(async()=>{const e=S.current;if(e&&L)try{C.isPlaying?e.pause():await e.play()}catch(a){s.error("Playback error:",a),A(e=>({...e,error:"Playback failed. Please try again."}))}},[C.isPlaying,L]),U=r.useCallback(e=>{const a=S.current;a&&L&&(a.currentTime=e)},[L]),M=r.useCallback(e=>{const a=S.current;a&&(a.volume=e,A(a=>({...a,volume:e,isMuted:0===e})))},[]),$=r.useCallback(()=>{const e=S.current;if(e){const a=!C.isMuted;e.muted=a,A(e=>({...e,isMuted:a}))}},[C.isMuted]),F=e=>{if(!e||isNaN(e)||!isFinite(e))return"0:00";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`};return a.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg ${D}`,children:[L&&O&&a.jsx("audio",{ref:S,preload:"metadata"}),P?a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(j,{className:"w-5 h-5 text-red-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-red-800 font-medium",children:"Audio Recording Deleted"}),a.jsx("p",{className:"text-red-600 text-sm",children:R.message})]})]}):T?a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx(b,{className:"w-5 h-5 text-yellow-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-yellow-800 font-medium",children:"Audio Recording Expired"}),a.jsx("p",{className:"text-yellow-600 text-sm",children:R.message})]})]}):"processing"===R.status?a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx(d,{className:"w-5 h-5 text-blue-600 animate-spin"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-blue-800 font-medium",children:"Processing Audio"}),a.jsx("p",{className:"text-blue-600 text-sm",children:R.message})]})]}):"failed"===R.status||"unavailable"===R.status?a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[a.jsx(N,{className:"w-5 h-5 text-red-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-red-800 font-medium",children:"Audio Unavailable"}),a.jsx("p",{className:"text-red-600 text-sm",children:R.message})]})]}):null,L&&!C.error&&a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:I,disabled:C.isLoading,className:"flex items-center justify-center w-12 h-12 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors disabled:opacity-50",title:C.isPlaying?"Pause":"Play",children:C.isLoading?a.jsx(d,{className:"w-5 h-5 animate-spin"}):C.isPlaying?a.jsx(o,{className:"w-5 h-5"}):a.jsx(c,{className:"w-5 h-5 ml-1"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{ref:k,className:"relative h-2 bg-gray-200 rounded-full cursor-pointer",onClick:e=>{if(k.current&&C.duration){const a=k.current.getBoundingClientRect(),s=(e.clientX-a.left)/a.width;U(s*C.duration)}},children:[a.jsx("div",{className:"absolute top-0 left-0 h-full bg-gray-300 rounded-full",style:{width:`${C.buffered}%`}}),a.jsx("div",{className:"absolute top-0 left-0 h-full bg-blue-600 rounded-full",style:{width:C.duration?C.currentTime/C.duration*100+"%":"0%"}})]}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[a.jsx("span",{children:F(C.currentTime)}),a.jsx("span",{children:F(C.duration>0?C.duration:e.duration||0)})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:$,className:"p-2 text-gray-600 hover:text-gray-800 transition-colors",title:C.isMuted?"Unmute":"Mute",children:C.isMuted?a.jsx(m,{className:"w-4 h-4"}):a.jsx(x,{className:"w-4 h-4"})}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:C.isMuted?0:C.volume,onChange:e=>M(parseFloat(e.target.value)),className:"w-16 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer",title:"Volume"})]}),l&&O&&a.jsx("button",{onClick:()=>{const a=document.createElement("a");a.href=O,a.download=`warning-audio-${e.recordingId||"recording"}.webm`,a.click()},className:"p-2 text-gray-600 hover:text-gray-800 transition-colors",title:"Download Audio",children:a.jsx(g,{className:"w-4 h-4"})})]})}),i&&!v&&L&&!C.error&&a.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 px-4 py-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-gray-600 flex items-center gap-1",children:[a.jsx(u,{className:"w-3 h-3"}),"Recorded By"]}),a.jsx("p",{className:"font-medium",children:e.recordedByName||"Manager"})]}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-gray-600 flex items-center gap-1",children:[a.jsx(p,{className:"w-3 h-3"}),"Recorded"]}),a.jsx("p",{className:"font-medium",children:e.timestamp?new Date(e.timestamp).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"}):e.recordedAt?new Date(e.recordedAt).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"}):e.startTime?new Date(e.startTime).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"}):e.createdAt?new Date(e.createdAt).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"}):"Not available"})]})]}),e.consentGiven&&a.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-green-700 bg-green-50 px-3 py-2 rounded-lg",children:[a.jsx(h,{className:"w-3 h-3"}),a.jsx("span",{children:"Recording consent was obtained from all participants"})]}),e.autoDeleteDate&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-blue-700 bg-blue-50 px-3 py-2 rounded-lg",children:[a.jsx(y,{className:"w-3 h-3"}),a.jsxs("span",{children:["This recording will be automatically deleted on"," ",new Date(e.autoDeleteDate).toLocaleDateString()]})]})]}),C.error&&a.jsx("div",{className:"border-t border-gray-200 p-4",children:a.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[a.jsx(b,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:C.error})]})})]})},I=({signature:e,title:t,subtitle:l,isOpen:i,onClose:n,allowDownload:d=!0})=>{const o=r.useCallback(()=>{try{const a=atob(e.split(",")[1]),s=new Array(a.length);for(let e=0;e<a.length;e++)s[e]=a.charCodeAt(e);const r=new Uint8Array(s),l=new Blob([r],{type:"image/png"}),i=URL.createObjectURL(l),n=document.createElement("a");n.href=i,n.download=`${t.toLowerCase().replace(/\s+/g,"_")}_signature.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}catch(a){s.error("Signature download failed:",a)}},[e,t]),c=r.useCallback(async()=>{try{await navigator.clipboard.writeText(e)}catch(a){s.error("Failed to copy signature:",a)}},[e]);return i?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),l&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l})]}),a.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(k,{className:"w-5 h-5 text-gray-500"})})]}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:a.jsx("img",{src:e,alt:t,className:"max-w-full max-h-96 mx-auto",style:{imageRendering:"crisp-edges"}})})}),a.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Digital signature • PNG format • Legally binding"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:c,className:"px-3 py-2 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition-colors flex items-center gap-2",children:[a.jsx(C,{className:"w-4 h-4"}),"Copy Data"]}),d&&a.jsxs("button",{onClick:o,className:"px-3 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[a.jsx(g,{className:"w-4 h-4"}),"Download"]})]})]})]})}):null},U=({signatures:e,warningId:s,showTimestamps:t=!0,compact:l=!1,showVerification:i=!0,allowDownload:n=!0,className:d=""})=>{const[o,c]=r.useState(null),m=e=>{if(!e)return!1;try{return e.startsWith("data:image/")&&e.includes("base64,")}catch{return!1}},x=m(e.manager),j=m(e.employee),N=x&&j,k=r.useCallback((e,a,s)=>{c({signature:e,title:a,subtitle:s})},[]),C=r.useCallback(()=>{c(null)},[]),A=e=>{if(!e)return"Not signed";try{return new Date(e).toLocaleString()}catch{return"Invalid timestamp"}},R=N?{status:"complete",message:"Document fully signed",color:"text-green-600 bg-green-50 border-green-200",icon:v}:x||j?{status:"partial",message:"Signatures pending",color:"text-yellow-600 bg-yellow-50 border-yellow-200",icon:S}:{status:"missing",message:"No signatures collected",color:"text-gray-600 bg-gray-50 border-gray-200",icon:b},L=R.icon;return l?a.jsxs("div",{className:`inline-flex items-center gap-2 ${d}`,children:[a.jsx(L,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm text-gray-600",children:N?"✓ Signed":"⏳ Pending"}),N&&a.jsx("button",{onClick:()=>k(e.manager,"Digital Signatures","Manager and Employee"),className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"View"})]}):a.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg overflow-hidden ${d}`,children:[a.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 px-4 py-3 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center",children:a.jsx(f,{className:"w-4 h-4 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Digital Signatures"}),a.jsx("p",{className:"text-xs text-gray-600",children:"Electronic authorization and acknowledgment"})]})]}),i&&a.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border ${R.color}`,children:[a.jsx(L,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:R.message})]})]})}),a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(u,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Manager"}),x&&a.jsx(v,{className:"w-4 h-4 text-green-500"})]}),x&&a.jsx("button",{onClick:()=>k(e.manager,"Manager Signature",e.managerName||"Warning Issuer"),className:"p-1 hover:bg-gray-100 rounded transition-colors",title:"View full signature",children:a.jsx(w,{className:"w-4 h-4 text-gray-500"})})]}),x?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 text-center",children:a.jsx("img",{src:e.manager,alt:"Manager Signature",className:"max-w-full h-16 mx-auto",style:{imageRendering:"crisp-edges"}})}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D,{className:"w-3 h-3"}),a.jsx("span",{children:e.managerName||"Manager"})]}),t&&e.managerTimestamp&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(p,{className:"w-3 h-3"}),a.jsx("span",{children:A(e.managerTimestamp)})]})]})]}):a.jsxs("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[a.jsx(u,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Awaiting manager signature"})]})]}),a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Employee"}),j&&a.jsx(v,{className:"w-4 h-4 text-green-500"})]}),j&&a.jsx("button",{onClick:()=>k(e.employee,"Employee Signature",e.employeeName||"Warning Recipient"),className:"p-1 hover:bg-gray-100 rounded transition-colors",title:"View full signature",children:a.jsx(w,{className:"w-4 h-4 text-gray-500"})})]}),j?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 text-center",children:a.jsx("img",{src:e.employee,alt:"Employee Signature",className:"max-w-full h-16 mx-auto",style:{imageRendering:"crisp-edges"}})}),a.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(D,{className:"w-3 h-3"}),a.jsx("span",{children:e.employeeName||"Employee"})]}),t&&e.employeeTimestamp&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(p,{className:"w-3 h-3"}),a.jsx("span",{children:A(e.employeeTimestamp)})]})]})]}):a.jsxs("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[a.jsx(D,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Awaiting employee acknowledgment"})]})]})]})}),N&&a.jsx("div",{className:"bg-green-50 border-t border-green-200 px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(h,{className:"w-5 h-5 text-green-600"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-green-800",children:"Document Digitally Signed & Verified"}),a.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["These digital signatures are legally binding and comply with electronic signature regulations.",s&&` Document ID: ${s}`]})]}),n&&a.jsx("button",{onClick:()=>{},className:"p-2 text-green-600 hover:bg-green-100 rounded-lg transition-colors",title:"Download signatures",children:a.jsx(g,{className:"w-4 h-4"})})]})}),!N&&(x||j)&&a.jsx("div",{className:"bg-yellow-50 border-t border-yellow-200 px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(y,{className:"w-5 h-5 text-yellow-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Signature Collection In Progress"}),a.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Document requires signatures from both manager and employee to be legally complete."})]})]})}),o&&a.jsx(I,{signature:o.signature,title:o.title,subtitle:o.subtitle,isOpen:!0,onClose:C,allowDownload:n})]})},M=(e,a="Not specified")=>null==e?a:"string"==typeof e?e:"number"==typeof e?e.toString():"boolean"==typeof e?e?"Yes":"No":a,$=(e,a="Not set")=>{if(!e)return a;try{let s;return s=void 0!==e.seconds?new Date(1e3*e.seconds):e instanceof Date?e:new Date(e),isNaN(s.getTime())?a:s.toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"})}catch{return a}},F=(e,a)=>{const s=$(e,"");return s&&"Not set"!==s?a?`${s} at ${a}`:s:"Not specified"},W=e=>{if(!e)return(new Date).toISOString().split("T")[0];try{let a;if(void 0!==e.seconds)a=new Date(1e3*e.seconds);else if(e instanceof Date)a=e;else{if("string"!=typeof e)return(new Date).toISOString().split("T")[0];a=new Date(e)}return isNaN(a.getTime())?(new Date).toISOString().split("T")[0]:a.toISOString().split("T")[0]}catch{return(new Date).toISOString().split("T")[0]}},B=(e,a)=>{const s={verbal:{primary:"bg-blue-600",secondary:"bg-blue-50",accent:"text-blue-600",background:"bg-blue-50",text:"text-blue-800",border:"border-blue-200"},written:{primary:"bg-yellow-600",secondary:"bg-yellow-50",accent:"text-yellow-600",background:"bg-yellow-50",text:"text-yellow-800",border:"border-amber-200"},final:{primary:"bg-red-600",secondary:"bg-red-50",accent:"text-red-600",background:"bg-red-50",text:"text-red-800",border:"border-red-200"},dismissal:{primary:"bg-red-700",secondary:"bg-red-50",accent:"text-red-700",background:"bg-red-50",text:"text-red-900",border:"border-red-300"}};return s[e]||s.verbal},V=({warning:n,isOpen:d,onClose:o,canTakeAction:c=!1,userRole:m="viewer",className:x="",onApprove:p,onReject:y,onAppealOutcome:b,canManageAppeals:j=!1})=>{const[N,v]=r.useState("overview"),[w,D]=r.useState(new Set(["summary"])),[C,E]=r.useState({type:null,loading:!1}),[I,V]=r.useState(!1),[G,z]=r.useState(""),[q,_]=r.useState(!1),[Z,H]=r.useState(!1),[X,Y]=r.useState(!1),[J,K]=r.useState(!1),[Q,ee]=r.useState(!1),[ae,se]=r.useState(null),[te,re]=r.useState(!1),[le,ie]=r.useState(null),[ne,de]=r.useState(""),[oe,ce]=r.useState(!1),me=r.useRef(null),xe=r.useRef(null);l(d);const{organization:ge}=t(),ue=r.useMemo(()=>n?{id:n.id||"",employeeName:M(n.employeeName),employeeNumber:M(n.employeeNumber),department:M(n.department),position:M(n.position),category:M(n.category),level:n.level||"verbal",status:n.status||"issued",incidentDate:$(n.incidentDate),incidentTime:M(n.incidentTime),incidentDateTime:F(n.incidentDate,n.incidentTime),incidentLocation:M(n.incidentLocation),description:M(n.description),issueDate:$(n.issueDate),expiryDate:$(n.expiryDate),issuedByName:M(n.issuedByName),deliveryMethod:M(n.deliveryMethod),additionalNotes:M(n.additionalNotes),hasAudio:Boolean(n.audioRecording?.url),audioRecording:n.audioRecording||null,hasPDF:Boolean(n.pdfGenerated||n.pdfFilename),hasSignatures:Boolean(n.signatures&&Object.keys(n.signatures).length>0),signatures:n.signatures||{manager:null,employee:null},validityPeriod:n.validityPeriod||6,escalationReason:M(n.escalationReason),acknowledgedAt:n.acknowledgedAt?$(n.acknowledgedAt):null,acknowledgedBy:M(n.acknowledgedBy),appealSubmitted:Boolean(n.appealSubmitted),appealDate:n.appealDate?$(n.appealDate):null,appealDetails:n.appealDetails||null,appealOutcome:n.appealOutcome||null,appealDecisionDate:n.appealDecisionDate?$(n.appealDecisionDate):null,appealReasoning:M(n.appealReasoning,""),hrNotes:M(n.hrNotes,""),followUpRequired:Boolean(n.followUpRequired),followUpDate:n.followUpDate?$(n.followUpDate):null,createdAt:$(n.createdAt),updatedAt:$(n.updatedAt)}:null,[n]),pe=r.useMemo(()=>ue?B(ue.level,ue.status):B("verbal"),[ue]),he=r.useCallback(()=>{_(!0),setTimeout(()=>{o(),_(!1),v("overview"),D(new Set(["summary"])),E({type:null,loading:!1}),V(!1),z(""),Y(!1),K(!1),ee(!1),se(null)},300)},[o]);r.useCallback(e=>{D(a=>{const s=new Set(a);return s.has(e)?s.delete(e):s.add(e),s})},[]),r.useCallback(async()=>{if(p&&ue?.id){E({type:"approve",loading:!0});try{await p(ue.id),setTimeout(he,1e3)}catch(e){s.error("Failed to approve warning:",e),E({type:null,loading:!1})}}},[p,ue?.id,he]),r.useCallback(async()=>{if(y&&ue?.id){E({type:"reject",loading:!0});try{await y(ue.id,G),setTimeout(he,1e3)}catch(e){s.error("Failed to reject warning:",e),E({type:null,loading:!1})}}},[y,ue?.id,G,he]),r.useCallback(()=>{V(!0)},[]);const ye=r.useCallback(()=>{ue?.hasAudio&&ee(!0)},[ue?.hasAudio]),be=r.useCallback(()=>{Y(!0)},[]),je=r.useCallback(async()=>{if(ue)try{const{PDFGenerationService:a}=await e(async()=>{const{PDFGenerationService:e}=await import("./dashboard-router-DriKLXjX.js").then(e=>e.e);return{PDFGenerationService:e}},__vite__mapDeps([0,1,2,3,4,5,6,7])),t=await a.generateAppealReportPDF({warningId:n.id||"N/A",employee:{firstName:ue.employeeName.split(" ")[0]||"Unknown",lastName:ue.employeeName.split(" ").slice(1).join(" ")||"Employee",employeeNumber:ue.employeeNumber,department:ue.department,position:ue.position},category:ue.category,warningLevel:ue.level,issueDate:n.issueDate?.seconds?new Date(1e3*n.issueDate.seconds):new Date,organization:{name:ge?.name||"Organization",branding:ge?.branding},appealDetails:ue.appealDetails?{grounds:ue.appealDetails.grounds,details:ue.appealDetails.details,requestedOutcome:ue.appealDetails.requestedOutcome,submittedAt:ue.appealDetails.submittedAt?new Date(ue.appealDetails.submittedAt):void 0,submittedBy:ue.appealDetails.submittedBy}:void 0,appealOutcome:ue.appealOutcome,appealDecisionDate:n.appealDecisionDate?.seconds?new Date(1e3*n.appealDecisionDate.seconds):void 0,appealReasoning:ue.appealReasoning,hrNotes:ue.hrNotes,followUpRequired:ue.followUpRequired,followUpDate:n.followUpDate?.seconds?new Date(1e3*n.followUpDate.seconds):void 0}),r=URL.createObjectURL(t),l=document.createElement("a");l.href=r,l.download=`Appeal_Report_${n.id||"Unknown"}_${(new Date).toISOString().split("T")[0]}.pdf`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r),s.success("✅ Appeal report downloaded")}catch(a){s.error("❌ Failed to generate appeal report:",a),console.error("Full error details:",a),console.error("Warning data:",ue),console.error("Organization:",ge),alert(`Failed to generate appeal report: ${a instanceof Error?a.message:"Unknown error"}`)}},[ue,n,ge]),Ne=r.useCallback(()=>{ue?.hasSignatures&&K(!0)},[ue?.hasSignatures]),fe=r.useCallback(e=>{if(!ue?.signatures)return;const a=ue.signatures[e];a&&(se({signature:a,title:`${e.charAt(0).toUpperCase()+e.slice(1)} Signature`,subtitle:`Warning ID: ${ue.id} • ${ue.employeeName}`}),K(!0))},[ue]);return d&&ue?a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:xe,className:`\n          fixed inset-0 flex items-center justify-center p-4\n          bg-black/60 backdrop-blur-xl\n          transition-all duration-500 ease-out\n          ${q?"opacity-0":"opacity-100"}\n          ${x}\n        `,style:{zIndex:i.modal},onClick:e=>e.target===xe.current&&he(),children:a.jsxs("div",{ref:me,className:`\n            relative w-full max-w-4xl max-h-[90vh] \n            bg-white rounded-lg shadow-xl border border-gray-200\n            overflow-hidden\n            transition-all duration-300 ease-out\n            ${q?"scale-95 opacity-0":"scale-100 opacity-100"}\n          `,children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`\n                w-10 h-10 rounded-lg ${pe.primary}\n                flex items-center justify-center\n              `,children:a.jsx(h,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Warning Details"}),a.jsxs("p",{className:"text-sm text-gray-600",children:[ue.employeeName," • ",ue.category]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-medium rounded-full "+("verbal"===ue.level?"bg-blue-100 text-blue-800":"written"===ue.level?"bg-yellow-100 text-yellow-800":"final"===ue.level?"bg-red-100 text-red-800":"dismissal"===ue.level?"bg-red-200 text-red-900":"bg-gray-100 text-gray-800"),children:"verbal"===ue.level?"Verbal Warning":"written"===ue.level?"Written Warning":"final"===ue.level?"Final Warning":"dismissal"===ue.level?"Dismissal":"Warning"}),a.jsx("button",{onClick:he,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(k,{className:"w-5 h-5"})})]})]}),a.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-200px)]",children:a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-3",children:"Incident Summary"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Description:"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ue.description})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Date:"}),a.jsx("span",{className:"ml-2 text-gray-600",children:ue.incidentDate})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Location:"}),a.jsx("span",{className:"ml-2 text-gray-600",children:ue.incidentLocation})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(u,{className:"w-4 h-4 text-gray-600"}),"Employee Details"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Name:"}),a.jsx("span",{className:"font-medium text-gray-900",children:ue.employeeName})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"ID:"}),a.jsx("span",{className:"font-medium text-gray-900",children:ue.employeeNumber})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Position:"}),a.jsx("span",{className:"font-medium text-gray-900",children:ue.position})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Department:"}),a.jsx("span",{className:"font-medium text-gray-900",children:ue.department})]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(S,{className:"w-4 h-4 text-gray-600"}),"Warning Timeline"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Issue Date:"}),a.jsx("span",{className:"font-medium text-gray-900",children:ue.issueDate})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Expiry Date:"}),a.jsx("span",{className:"font-medium text-gray-900",children:ue.expiryDate})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Issued By:"}),a.jsx("span",{className:"font-medium text-gray-900",children:ue.issuedByName})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Status:"}),a.jsx("span",{className:"font-medium "+("delivered"===ue.deliveryStatus?"text-green-600":"text-orange-600"),children:"delivered"===ue.deliveryStatus?"Delivered":"Pending Delivery"})]})]})]})]}),(ue.appealSubmitted||ue.appealOutcome)&&a.jsxs("div",{className:"mt-6 p-4 bg-purple-50 rounded-lg border border-purple-200",children:[a.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(A,{className:"w-4 h-4 text-purple-600"}),"Appeal History"]}),ue.appealSubmitted&&ue.appealDetails&&a.jsxs("div",{className:"mb-4 p-3 bg-white rounded-lg border border-purple-100",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-xs font-semibold text-purple-900 uppercase",children:"Employee Appeal"}),a.jsx("span",{className:"text-xs text-gray-600",children:ue.appealDate})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[ue.appealDetails.grounds&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Grounds:"}),a.jsx("p",{className:"text-gray-600 mt-1",children:ue.appealDetails.grounds})]}),ue.appealDetails.details&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Additional Details:"}),a.jsx("p",{className:"text-gray-600 mt-1",children:ue.appealDetails.details})]}),ue.appealDetails.requestedOutcome&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Requested Outcome:"}),a.jsx("p",{className:"text-gray-600 mt-1",children:ue.appealDetails.requestedOutcome})]}),ue.appealDetails.submittedBy&&a.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Submitted by: ",ue.appealDetails.submittedBy]})]})]}),ue.appealOutcome&&a.jsxs("div",{className:"p-3 bg-white rounded-lg border border-purple-100",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-xs font-semibold text-purple-900 uppercase",children:"HR Decision"}),a.jsx("span",{className:"text-xs text-gray-600",children:ue.appealDecisionDate||"Pending"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Outcome:"}),a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("overturned"===ue.appealOutcome?"bg-green-100 text-green-800":"upheld"===ue.appealOutcome?"bg-red-100 text-red-800":"modified"===ue.appealOutcome?"bg-blue-100 text-blue-800":"reduced"===ue.appealOutcome?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"overturned"===ue.appealOutcome?"Warning Overturned":"upheld"===ue.appealOutcome?"Appeal Upheld - Warning Stands":"modified"===ue.appealOutcome?"Warning Modified":"reduced"===ue.appealOutcome?"Warning Reduced":ue.appealOutcome})]}),ue.appealReasoning&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"HR Reasoning:"}),a.jsx("p",{className:"text-gray-600 mt-1",children:ue.appealReasoning})]}),ue.hrNotes&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"HR Notes:"}),a.jsx("p",{className:"text-gray-600 mt-1",children:ue.hrNotes})]}),ue.followUpRequired&&a.jsx("div",{className:"mt-2 p-2 bg-yellow-50 rounded border border-yellow-200",children:a.jsxs("span",{className:"text-xs font-medium text-yellow-800",children:["⚠️ Follow-up required",ue.followUpDate?` by ${ue.followUpDate}`:""]})})]})]})]}),a.jsx("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[ue.hasAudio&&a.jsxs("button",{onClick:ye,className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors text-sm",children:[a.jsx(R,{className:"w-4 h-4"}),"Audio Recording"]}),a.jsxs("button",{onClick:be,className:"flex items-center gap-2 px-3 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors text-sm font-medium",children:[a.jsx(L,{className:"w-4 h-4"}),ue.appealSubmitted||ue.appealOutcome?"View PDF (with Appeal)":"View PDF"]}),ue.hasSignatures&&a.jsxs("button",{onClick:Ne,className:"flex items-center gap-2 px-3 py-2 bg-purple-50 text-purple-700 rounded-lg hover:bg-purple-100 transition-colors text-sm",children:[a.jsx(f,{className:"w-4 h-4"}),"Signatures"]}),(ue.appealSubmitted||ue.appealOutcome)&&a.jsxs("button",{onClick:je,className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium",children:[a.jsx(A,{className:"w-4 h-4"}),"Print Appeal Report"]})]})})]})})]})}),Q&&ue?.hasAudio&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",style:{zIndex:i.modalNested1},children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Audio Recording"}),a.jsx("button",{onClick:()=>ee(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(k,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-6",children:a.jsx(O,{audioData:ue.audioRecording,compact:!1})})]})}),J&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",style:{zIndex:i.modalNested1},children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Digital Signatures"}),a.jsx("button",{onClick:()=>K(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(k,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"p-6",children:ue?.hasSignatures?a.jsxs("div",{className:"space-y-4",children:[ue.signatures?.manager&&a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Manager Signature"}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded p-4 text-center",children:a.jsx("img",{src:ue.signatures.manager,alt:"Manager Signature",className:"max-w-full h-20 mx-auto"})})]}),ue.signatures?.employee&&a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Employee Signature"}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded p-4 text-center",children:a.jsx("img",{src:ue.signatures.employee,alt:"Employee Signature",className:"max-w-full h-20 mx-auto"})})]})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(f,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No signatures available"}),a.jsx("p",{className:"text-gray-600",children:"Digital signatures have not been collected for this warning."})]})})]})}),X&&a.jsx(T,{isOpen:X,onClose:()=>Y(!1),warningData:{selectedEmployee:{id:n.employeeId||"",firstName:n.employeeName||"Unknown",lastName:n.employeeLastName||"Employee",employeeId:n.employeeNumber||"",employeeNumber:n.employeeNumber||"",department:n.employeeDepartment||n.department||"",position:n.employeePosition||n.position||"",email:n.employeeEmail||""},selectedCategory:{id:n.categoryId||"",name:n.categoryName||n.category||"General",severity:"medium",description:n.categoryName||n.category||"General"},formData:{incidentDate:W(n.incidentDate),incidentTime:n.incidentTime||"12:00",incidentLocation:n.incidentLocation||"",incidentDescription:n.incidentDescription||n.description||"",additionalNotes:n.additionalNotes||"",validityPeriod:n.validityPeriod||6,issueDate:W(n.issueDate),status:n.status,pdfGeneratorVersion:n.pdfGeneratorVersion,pdfTemplateVersion:n.pdfTemplateVersion,pdfSettings:n.pdfSettings},signatures:n.signatures||{manager:null,employee:null},lraRecommendation:n.disciplineRecommendation||{category:n.categoryName||n.category||"General",recommendedLevel:n.level||"Counselling Session",suggestedLevel:n.level||"counselling",reason:"Based on incident severity and employee history",warningCount:1,previousWarnings:[],activeWarnings:[],legalRequirements:["Employee consultation","Written documentation","Appeal process notification"]},organizationId:n.organizationId||""},onPDFGenerated:(e,a)=>{n.categoryName,n.category,n.signatures}}),Q&&ue?.hasAudio&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm",style:{zIndex:i.modalNested1},children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Audio Recording"}),a.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Warning ID: ",ue.id," • ",ue.employeeName]})]}),a.jsx("button",{onClick:()=>ee(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(k,{className:"w-5 h-5 text-gray-500"})})]}),a.jsx("div",{className:"p-6",children:a.jsx(O,{audioRecording:ue.audioRecording,warningId:ue.id,showDownload:!0,showMetadata:!0,className:"w-full"})})]})}),J&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm",style:{zIndex:i.modalNested1},children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Digital Signatures"}),a.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Warning ID: ",ue.id," • ",ue.employeeName]})]}),a.jsx("button",{onClick:()=>K(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(k,{className:"w-5 h-5 text-gray-500"})})]}),a.jsx("div",{className:"p-6",children:ue?.hasSignatures?a.jsxs(a.Fragment,{children:[a.jsx(U,{signatures:ue.signatures,warningId:ue.id,showTimestamps:!0,showVerification:!0,allowDownload:!0,className:"w-full mb-4"}),a.jsxs("div",{className:"flex gap-3",children:[ue.signatures.manager&&a.jsxs("button",{onClick:()=>fe("manager"),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg transition-colors",children:[a.jsx(P,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"View Manager Signature"})]}),ue.signatures.employee&&a.jsxs("button",{onClick:()=>fe("employee"),className:"flex items-center gap-2 px-4 py-2 bg-green-50 hover:bg-green-100 border border-green-200 rounded-lg transition-colors",children:[a.jsx(P,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{className:"text-sm text-green-700 font-medium",children:"View Employee Signature"})]})]})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(f,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No signatures available"}),a.jsx("p",{className:"text-gray-600",children:"Digital signatures have not been collected for this warning."})]})})]})}),ae&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm",style:{zIndex:i.modalNested2},children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ae.title}),ae.subtitle&&a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ae.subtitle})]}),a.jsx("button",{onClick:()=>se(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(k,{className:"w-5 h-5 text-gray-500"})})]}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:a.jsx("img",{src:ae.signature,alt:ae.title,className:"max-w-full max-h-96 mx-auto",style:{imageRendering:"crisp-edges"}})})}),a.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Digital signature • PNG format • Legally binding"}),a.jsxs("button",{onClick:()=>{const e=document.createElement("a");e.href=ae.signature,e.download=`${ae.title.toLowerCase().replace(/\s+/g,"_")}_signature.png`,document.body.appendChild(e),e.click(),document.body.removeChild(e)},className:"px-3 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[a.jsx(g,{className:"w-4 h-4"}),"Download PNG"]})]})]})})]}):null};export{V as WarningDetailsModal,V as default};
