import{u as e,L as t,A as s,j as i}from"./business-owner-dashboard-CK-ZpSaU.js";import{r as a,R as l}from"./react-vendor-BMk1H4su.js";import{R as n,s as r,T as d,aj as c,F as o,d as x,c as g,x as m,S as h}from"./ui-vendor-CMPykBlV.js";import"./pdf-vendor-CbrIsI36.js";import"./firebase-vendor-BIBOIkWK.js";const v={totalWarnings:0,activeWarnings:0,expiredWarnings:0,pendingReview:0,highRisk:0,expiringSoon:0,byLevel:{verbal:0,first_written:0,second_written:0,final_written:0,suspension:0,dismissal:0},byStatus:{delivered:0,issued:0,acknowledged:0,appealed:0,expired:0},recentActivity:{todayCount:0,weekCount:0,monthCount:0}},b=({title:e,value:t,subtitle:s,icon:a,color:l,bgColor:n,trend:r,isLoading:d,onClick:c,pulse:o=!1})=>d?i.jsx("div",{className:"bg-white rounded-lg p-3 border",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-20"}),i.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse w-12"})]}),i.jsx("div",{className:`w-8 h-8 ${n} rounded-lg animate-pulse`})]})}):i.jsx("div",{className:"bg-white rounded-lg p-3 border transition-all duration-200 "+(c?"hover:shadow-md cursor-pointer hover:border-gray-300":""),onClick:c,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:e}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("p",{className:`text-2xl font-bold ${l}`,children:t.toLocaleString()}),o&&t>0&&i.jsx("div",{className:`w-2 h-2 ${n.replace("bg-","bg-")} rounded-full animate-pulse`})]}),i.jsx("p",{className:"text-xs text-gray-500",children:s}),r&&i.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[i.jsxs("span",{className:"text-xs font-medium "+(r.isPositive?"text-green-600":"text-red-600"),children:[r.isPositive?"↗":"↘"," ",Math.abs(r.value),"%"]}),i.jsx("span",{className:"text-xs text-gray-400",children:r.label})]})]}),i.jsx("div",{className:`p-2 ${n} rounded-lg`,children:i.jsx(a,{className:`w-8 h-8 ${l}`})})]})}),u=({userRole:u,variant:j="detailed",gradientColors:p="from-red-500 to-orange-600",showHeader:N=!0})=>{const{stats:y,loading:w,error:f,refreshStats:C}=(()=>{const{user:i}=e(),[l,n]=a.useState(v),[r,d]=a.useState(!0),[c,o]=a.useState(null),x=async()=>{if(i?.organizationId)try{d(!0),o(null),i.organizationId;const e=await s.warnings.getAll(i.organizationId);e.length;const t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),l=new Date(t.getTime()-6048e5),r=new Date(t.getTime()-2592e6),c=new Date(t.getTime()+2592e6),x={totalWarnings:e.length,activeWarnings:0,expiredWarnings:0,pendingReview:0,highRisk:0,expiringSoon:0,byLevel:{verbal:0,first_written:0,second_written:0,final_written:0,suspension:0,dismissal:0},byStatus:{delivered:0,issued:0,acknowledged:0,appealed:0,expired:0},recentActivity:{todayCount:0,weekCount:0,monthCount:0}};e.forEach(e=>{const s=e.issueDate?new Date(e.issueDate):new Date(e.createdAt),i=e.expiryDate?new Date(e.expiryDate):null;!i||i>t?x.activeWarnings++:x.expiredWarnings++,["final_written","suspension","dismissal"].includes(e.level)&&x.highRisk++,i&&i<=c&&i>t&&x.expiringSoon++,e.level in x.byLevel&&x.byLevel[e.level]++,e.status&&e.status in x.byStatus&&x.byStatus[e.status]++,e.appealSubmitted&&x.pendingReview++,s>=a&&x.recentActivity.todayCount++,s>=l&&x.recentActivity.weekCount++,s>=r&&x.recentActivity.monthCount++}),n(x)}catch(e){t.error("Failed to load warnings stats:",e),o("Failed to load warnings statistics")}finally{d(!1)}else d(!1)};return a.useEffect(()=>{let e=!0,t=null;return i?.organizationId?(x(),t=setInterval(()=>{e&&x()},6e4)):d(!1),()=>{e=!1,t&&clearInterval(t)}},[i?.organizationId]),{stats:l,loading:r,error:c,refreshStats:async()=>{await x()}}})(),L=()=>"executive-management"===u?h:d,R=()=>"executive-management"===u?"text-purple-600":"text-emerald-600",k=()=>"executive-management"===u?"Warnings Overview":"Warnings Management",W=()=>"executive-management"===u?"Executive summary of disciplinary actions":"Active warnings requiring review and management";return"compact"===j?i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-4",children:[N&&i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:`text-lg font-semibold ${R()} flex items-center gap-2`,children:[l.createElement(L(),{className:"w-5 h-5"}),"Warnings"]}),i.jsx("button",{onClick:C,className:"p-1 text-gray-400 hover:text-gray-600 rounded",disabled:w,children:i.jsx(n,{className:"w-4 h-4 "+(w?"animate-spin":"")})})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[i.jsx(b,{title:"Active",value:y.activeWarnings,subtitle:"Current warnings",icon:r,color:"text-green-600",bgColor:"bg-green-100",isLoading:w}),i.jsx(b,{title:"High Risk",value:y.highRisk,subtitle:"Require attention",icon:d,color:"text-red-600",bgColor:"bg-red-100",isLoading:w,pulse:y.highRisk>0})]})]}):"executive"===j?i.jsxs("div",{className:"space-y-3",children:[N&&i.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:`text-sm font-semibold ${R()} flex items-center gap-2`,children:[l.createElement(L(),{className:"w-4 h-4"}),k()]}),i.jsx("p",{className:"text-gray-600 text-xs mt-0.5",children:W()})]}),i.jsx("button",{onClick:C,className:"p-1.5 text-gray-400 hover:text-gray-600 rounded hover:bg-gray-50 transition-colors",disabled:w,children:i.jsx(n,{className:"w-4 h-4 "+(w?"animate-spin":"")})})]})}),f&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[i.jsx(c,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium text-sm",children:"Failed to load warnings data"})]}),i.jsx("p",{className:"text-red-600 text-xs mt-1",children:f})]}),i.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsx(b,{title:"Total Warnings",value:y.totalWarnings,subtitle:"All time",icon:o,color:"text-gray-700",bgColor:"bg-gray-100",isLoading:w}),i.jsx(b,{title:"Active",value:y.activeWarnings,subtitle:"Currently valid",icon:r,color:"text-green-600",bgColor:"bg-green-100",isLoading:w}),i.jsx(b,{title:"High Risk",value:y.highRisk,subtitle:"Final warnings",icon:d,color:"text-red-600",bgColor:"bg-red-100",isLoading:w,pulse:y.highRisk>0}),i.jsx(b,{title:"This Month",value:y.recentActivity.monthCount,subtitle:"Recent activity",icon:x,color:"text-blue-600",bgColor:"bg-blue-100",isLoading:w})]}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Warning Level Distribution"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.byLevel.verbal}),i.jsx("div",{className:"text-xs text-gray-600",children:"Verbal"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:y.byLevel.first_written}),i.jsx("div",{className:"text-xs text-gray-600",children:"1st Written"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:y.byLevel.second_written}),i.jsx("div",{className:"text-xs text-gray-600",children:"2nd Written"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:y.byLevel.final_written}),i.jsx("div",{className:"text-xs text-gray-600",children:"Final"})]})]})]})]}):i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6",children:[N&&i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:`text-lg font-semibold ${R()} flex items-center gap-2 mb-1`,children:[l.createElement(L(),{className:"w-6 h-6"}),k()]}),i.jsx("p",{className:"text-gray-600 text-sm",children:W()})]}),i.jsx("button",{onClick:C,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-50 transition-colors",disabled:w,children:i.jsx(n,{className:"w-5 h-5 "+(w?"animate-spin":"")})})]}),f&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[i.jsx(c,{className:"w-5 h-5"}),i.jsx("span",{className:"font-medium",children:"Failed to load warnings data"})]}),i.jsx("p",{className:"text-red-600 text-sm mt-1",children:f})]}),i.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[i.jsx(b,{title:"Pending Review",value:y.pendingReview,subtitle:"Require immediate attention",icon:g,color:"text-orange-600",bgColor:"bg-orange-100",isLoading:w,pulse:y.pendingReview>0}),i.jsx(b,{title:"High Risk",value:y.highRisk,subtitle:"Final warnings",icon:d,color:"text-red-600",bgColor:"bg-red-100",isLoading:w,pulse:y.highRisk>0}),i.jsx(b,{title:"Expiring Soon",value:y.expiringSoon,subtitle:"Within 30 days",icon:g,color:"text-yellow-600",bgColor:"bg-yellow-100",isLoading:w}),i.jsx(b,{title:"Active Total",value:y.activeWarnings,subtitle:"Currently valid",icon:r,color:"text-green-600",bgColor:"bg-green-100",isLoading:w})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[i.jsxs("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[i.jsx(m,{className:"w-5 h-5 text-gray-600"}),"Warning Level Distribution"]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[i.jsx("div",{className:"text-xl font-bold text-green-600",children:y.byLevel.verbal}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Verbal"})]}),i.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[i.jsx("div",{className:"text-xl font-bold text-yellow-600",children:y.byLevel.first_written}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"1st Written"})]}),i.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[i.jsx("div",{className:"text-xl font-bold text-orange-600",children:y.byLevel.second_written}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"2nd Written"})]}),i.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[i.jsx("div",{className:"text-xl font-bold text-red-600",children:y.byLevel.final_written}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Final"})]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:[i.jsxs("h4",{className:"font-semibold text-blue-900 mb-3 flex items-center gap-2",children:[i.jsx(x,{className:"w-5 h-5 text-blue-600"}),"Recent Activity"]}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-blue-700",children:y.recentActivity.todayCount}),i.jsx("div",{className:"text-sm text-blue-600",children:"Today"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-blue-700",children:y.recentActivity.weekCount}),i.jsx("div",{className:"text-sm text-blue-600",children:"This Week"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-lg font-bold text-blue-700",children:y.recentActivity.monthCount}),i.jsx("div",{className:"text-sm text-blue-600",children:"This Month"})]})]})]})]})};export{u as WarningsOverviewCard,u as default};
