import{u as he,e as Ee,j as e,a as Ae,y as Me,A as Be,L as f,S as de,D as De,w as ce}from"./business-owner-dashboard-mIihUYS1.js";import{r as i}from"./react-vendor-e4uWabrV.js";import{C as Ue}from"./dashboard-router-OFtOu3Ey.js";import{b as G,j as O,P as V,R as ue,X as ae,a as Q,e as ie,a3 as q,d as D,L as re,F,r as ne,E as Te,S as me,g as Pe,h as Le,Q as Oe,f as Fe,I as _e,i as pe,J as ge,o as He,T as Xe,n as _,O as $e,k as Ge,M as fe,v as ye,a1 as Ve,m as Y,B as xe,ao as qe,w as Ye,aq as Qe}from"./ui-vendor-DaBpJB-Q.js";import"./pdf-vendor-D1mz_3s2.js";import"./firebase-vendor-ZA7KOHFb.js";import"./hr-dashboard-lJxKp818.js";import"./warning-components-Bt10jUXa.js";import"./hod-dashboard-CwiSpfyn.js";const Ze=({onClose:o,initialTab:w="overview",organizationId:T,isEmbedded:H=!1})=>{const{user:S}=he();let z=null,P=null;try{const s=Ee();z=s.organization,P=s.organizationId}catch{}const x=T||P;if(!x)return e.jsxs("div",{className:"p-6 text-center",children:[e.jsxs("div",{className:"text-red-600 mb-4",children:[e.jsx(G,{className:"w-12 h-12 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Organization ID Required"}),e.jsx("p",{className:"text-sm",children:"Cannot manage categories without an organization ID."})]}),o&&e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Close"})]});const{canManageCategories:R,canViewAnalytics:C}=Ae(),[l,I]=i.useState(w),[d,b]=i.useState(!0),[c,N]=i.useState(!1),[k,a]=i.useState(null),[r,h]=i.useState(null),[y]=i.useState(Me),[W,Z]=i.useState([]),[E,be]=i.useState([]),[u,je]=i.useState(null),[ve,we]=i.useState(null),[J,K]=i.useState(null),[Ce,X]=i.useState(!1),[Ke,es]=i.useState(!1),[ss,ts]=i.useState(new Set),[j,ee]=i.useState({search:"",severity:"all",status:"all",usage:"all"}),[se,rs]=i.useState({field:"name",direction:"asc"}),[g,A]=i.useState({name:"",description:"",severity:"serious",icon:"📋",escalationPath:["counselling","verbal","first_written","final_written"],examples:[],isActive:!0}),M=!R,te=i.useMemo(()=>{let s=y;if(j.search){const t=j.search.toLowerCase();s=s.filter(n=>n.name.toLowerCase().includes(t)||n.description.toLowerCase().includes(t)||n.commonExamples.some(m=>m.toLowerCase().includes(t)))}return j.severity!=="all"&&(s=s.filter(t=>t.severity===j.severity)),j.status!=="all"&&(s=s.filter(t=>{const m=E.find(v=>v.universalCategoryId===t.id)?.isDisabled||!1;return j.status==="enabled"?!m:m})),j.usage!=="all"&&u&&(s=s.filter(t=>{const m=u.recentUsage.find(v=>v.categoryId===t.id)?.count||0;switch(j.usage){case"high":return m>=10;case"medium":return m>=3&&m<10;case"low":return m>0&&m<3;case"unused":return m===0;default:return!0}})),s.sort((t,n)=>{const m=se.direction==="asc"?1:-1;switch(se.field){case"name":return m*t.name.localeCompare(n.name);case"severity":{const v={minor:1,serious:2,gross_misconduct:3};return m*(v[t.severity]-v[n.severity])}case"usage":{if(!u)return 0;const v=u.recentUsage.find(B=>B.categoryId===t.id)?.count||0,p=u.recentUsage.find(B=>B.categoryId===n.id)?.count||0;return m*(v-p)}case"created":case"modified":return m*t.name.localeCompare(n.name);default:return 0}})},[y,E,u,j,se]),L=i.useMemo(()=>W.filter(s=>E.some(t=>t.id===s.id&&t.isCustomCategory)),[W,E]),U=i.useCallback(async()=>{if(x)try{b(!0),a(null);const s=await Be.organizations.getCategories(x);if(Z(s),be([]),C){const n=await Ne();je(n)}f.debug("[CategoryManagement] ✅ Data loaded successfully")}catch(s){f.error("[CategoryManagement] ❌ Error loading data:",s),a(s instanceof Error?s.message:"Failed to load category data")}finally{b(!1)}},[x,C]),Ne=async()=>({totalCategories:y.length+L.length,enabledUniversal:y.length-1,disabledUniversal:1,customCategories:L.length,activeWarnings:45,recentUsage:[{categoryId:"attendance_punctuality",categoryName:"Attendance & Punctuality",count:15,lastUsed:new Date(Date.now()-2880*60*1e3)},{categoryId:"safety_violations",categoryName:"Safety Violations",count:8,lastUsed:new Date(Date.now()-7200*60*1e3)}]});i.useEffect(()=>{x&&U()},[U,x]);const Se=async s=>{if(!M)try{N(!0),a(null);const t=E.find(n=>n.universalCategoryId===s);t?await DataService.customizeCategory(x,s,{...t,isDisabled:!t.isDisabled}):await DataService.customizeCategory(x,s,{isDisabled:!0}),await U(),h(`Category ${t?.isDisabled?"enabled":"disabled"} successfully`)}catch(t){f.error("[CategoryManagement] Error toggling category:",t),a("Failed to update category status")}finally{N(!1)}},ze=async()=>{if(!(M||!g.name?.trim()))try{N(!0),a(null);const s={name:g.name,description:g.description||"",icon:g.icon||"📋",escalationPath:g.escalationPath||["verbal","first_written","final_written"],examples:g.examples||[],severity:g.severity==="minor"?"low":g.severity==="serious"?"medium":"high"};await DataService.createCustomCategory(x,s),await U(),A({name:"",description:"",severity:"serious",icon:"📋",escalationPath:["counselling","verbal","first_written","final_written"],examples:[],isActive:!0}),X(!1),h("Custom category created successfully")}catch(s){f.error("[CategoryManagement] Error creating custom category:",s),a("Failed to create custom category")}finally{N(!1)}},ke=async s=>{if(!(M||!window.confirm("Are you sure you want to delete this custom category? This action cannot be undone.")))try{N(!0),a(null),await U(),h("Custom category deleted successfully")}catch(n){f.error("[CategoryManagement] Error deleting custom category:",n),a("Failed to delete custom category")}finally{N(!1)}},le=s=>{switch(s){case"minor":case"low":return"#10b981";case"serious":case"medium":return"#f59e0b";case"gross_misconduct":case"high":case"critical":return"#ef4444";default:return"#6b7280"}},oe=s=>{switch(s){case"minor":case"low":return e.jsx(pe,{className:"h-4 w-4"});case"serious":case"medium":return e.jsx(G,{className:"h-4 w-4"});case"gross_misconduct":case"high":case"critical":return e.jsx(ae,{className:"h-4 w-4"});default:return e.jsx(F,{className:"h-4 w-4"})}},Ie=s=>u?u.recentUsage.find(t=>t.categoryId===s):null,Re=s=>E.find(n=>n.universalCategoryId===s)?.isDisabled||!1,We=s=>{const t=E.find(n=>n.universalCategoryId===s.id);return t?{...s,name:t.customName||s.name,description:t.customDescription||s.description,escalationPath:t.customEscalationPath||s.escalationPath,commonExamples:t.customExamples||s.commonExamples,severity:t.customSeverity?t.customSeverity==="low"?"minor":t.customSeverity==="medium"?"serious":"gross_misconduct":s.severity}:s};return i.useEffect(()=>{if(r||k){const s=setTimeout(()=>{h(null),a(null)},5e3);return()=>clearTimeout(s)}},[r,k]),x?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:"1rem"},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"0.75rem",width:"100%",maxWidth:"80rem",maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},children:[e.jsxs("div",{style:{padding:"1.5rem 2rem",borderBottom:"1px solid #e2e8f0",backgroundColor:"#f8fafc",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{backgroundColor:"#3b82f6",color:"white",padding:"0.5rem",borderRadius:"0.5rem"},children:e.jsx(O,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#1e293b",margin:0,marginBottom:"0.25rem"},children:"Category Management"}),e.jsxs("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:0},children:[z?.name," • ",W.length," categories configured"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[!M&&e.jsxs("button",{onClick:()=>X(!0),disabled:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",backgroundColor:"#8b5cf6",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:c?"not-allowed":"pointer",opacity:c?.6:1},children:[e.jsx(V,{className:"h-4 w-4"}),"Add Custom Category"]}),e.jsx("button",{onClick:U,disabled:d||c,style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #d1d5db",borderRadius:"0.375rem",cursor:d||c?"not-allowed":"pointer",display:"flex",alignItems:"center",opacity:d||c?.6:1},children:e.jsx(ue,{className:`h-4 w-4 ${d?"animate-spin":""}`,style:{color:"#6b7280"}})}),o&&e.jsx("button",{onClick:o,style:{padding:"0.5rem",backgroundColor:"white",border:"1px solid #d1d5db",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center"},children:e.jsx(ae,{className:"h-4 w-4",style:{color:"#6b7280"}})})]})]}),(r||k)&&e.jsx("div",{style:{padding:"1rem 2rem",backgroundColor:r?"#f0fdf4":"#fef2f2",borderBottom:"1px solid #e2e8f0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:r?"#16a34a":"#dc2626",fontSize:"0.875rem",fontWeight:"500"},children:[r?e.jsx(Q,{className:"h-4 w-4"}):e.jsx(G,{className:"h-4 w-4"}),r||k]})}),e.jsx("div",{style:{borderBottom:"1px solid #e2e8f0",backgroundColor:"white"},children:e.jsx("div",{style:{display:"flex",gap:0,padding:"0 2rem"},children:[{id:"overview",label:"Overview",icon:ie},{id:"universal",label:"Universal Categories",icon:q},{id:"custom",label:"Custom Categories",icon:O},...C?[{id:"analytics",label:"Analytics",icon:D}]:[]].map(s=>{const t=s.icon,n=l===s.id;return e.jsxs("button",{onClick:()=>I(s.id),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"1rem 1.5rem",border:"none",backgroundColor:"transparent",borderBottom:n?"2px solid #3b82f6":"2px solid transparent",color:n?"#3b82f6":"#64748b",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(t,{className:"h-4 w-4"}),s.label]},s.id)})})}),e.jsx("div",{style:{flex:1,overflow:"auto"},children:d?e.jsxs("div",{style:{padding:"4rem",textAlign:"center",color:"#64748b"},children:[e.jsx(re,{className:"h-8 w-8 mx-auto mb-4 animate-spin"}),e.jsx("p",{style:{margin:0},children:"Loading category configuration..."})]}):e.jsxs(e.Fragment,{children:[l==="overview"&&e.jsxs("div",{style:{padding:"2rem"},children:[u&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth>1024?"repeat(4, 1fr)":window.innerWidth>768?"repeat(2, 1fr)":"1fr",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"0.5rem",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{backgroundColor:"#dbeafe",color:"#3b82f6",padding:"0.5rem",borderRadius:"0.375rem"},children:e.jsx(O,{className:"h-5 w-5"})}),e.jsx("span",{style:{fontSize:"2rem",fontWeight:"700",color:"#1e293b"},children:u.totalCategories})]}),e.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:0},children:"Total Categories"})]}),e.jsxs("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"0.5rem",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{backgroundColor:"#dcfce7",color:"#16a34a",padding:"0.5rem",borderRadius:"0.375rem"},children:e.jsx(Q,{className:"h-5 w-5"})}),e.jsx("span",{style:{fontSize:"2rem",fontWeight:"700",color:"#1e293b"},children:u.enabledUniversal})]}),e.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:0},children:"Universal Categories Enabled"})]}),e.jsxs("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"0.5rem",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{backgroundColor:"#fef3c7",color:"#d97706",padding:"0.5rem",borderRadius:"0.375rem"},children:e.jsx(V,{className:"h-5 w-5"})}),e.jsx("span",{style:{fontSize:"2rem",fontWeight:"700",color:"#1e293b"},children:u.customCategories})]}),e.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:0},children:"Custom Categories"})]}),e.jsxs("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"0.5rem",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{backgroundColor:"#e0e7ff",color:"#6366f1",padding:"0.5rem",borderRadius:"0.375rem"},children:e.jsx(F,{className:"h-5 w-5"})}),e.jsx("span",{style:{fontSize:"2rem",fontWeight:"700",color:"#1e293b"},children:u.activeWarnings})]}),e.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:0},children:"Active Warnings"})]})]}),e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",border:"1px solid #e2e8f0",padding:"1.5rem",marginBottom:"2rem"},children:[e.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"1rem",color:"#1e293b"},children:"Quick Actions"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth>768?"repeat(3, 1fr)":"1fr",gap:"1rem"},children:[e.jsxs("button",{onClick:()=>I("universal"),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem",backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"0.375rem",cursor:"pointer",textAlign:"left",transition:"all 0.2s"},onMouseOver:s=>s.currentTarget.style.backgroundColor="#f1f5f9",onMouseOut:s=>s.currentTarget.style.backgroundColor="#f8fafc",children:[e.jsx(q,{className:"h-5 w-5",style:{color:"#3b82f6"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",color:"#1e293b",marginBottom:"0.25rem"},children:"Configure Universal Categories"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Enable, disable or customize the 8 standard categories"})]})]}),e.jsxs("button",{onClick:()=>I("custom"),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem",backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"0.375rem",cursor:"pointer",textAlign:"left",transition:"all 0.2s"},onMouseOver:s=>s.currentTarget.style.backgroundColor="#f1f5f9",onMouseOut:s=>s.currentTarget.style.backgroundColor="#f8fafc",children:[e.jsx(O,{className:"h-5 w-5",style:{color:"#8b5cf6"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",color:"#1e293b",marginBottom:"0.25rem"},children:"Manage Custom Categories"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Create and manage organization-specific categories"})]})]}),C&&e.jsxs("button",{onClick:()=>I("analytics"),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem",backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"0.375rem",cursor:"pointer",textAlign:"left",transition:"all 0.2s"},onMouseOver:s=>s.currentTarget.style.backgroundColor="#f1f5f9",onMouseOut:s=>s.currentTarget.style.backgroundColor="#f8fafc",children:[e.jsx(D,{className:"h-5 w-5",style:{color:"#10b981"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",color:"#1e293b",marginBottom:"0.25rem"},children:"View Usage Analytics"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:"Analyze category usage patterns and trends"})]})]})]})]}),u&&u.recentUsage.length>0&&e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",border:"1px solid #e2e8f0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1.5rem 1.5rem 0 1.5rem"},children:e.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"1rem",color:"#1e293b"},children:"Recent Category Usage"})}),e.jsx("div",{style:{padding:"0 1.5rem 1.5rem 1.5rem"},children:u.recentUsage.slice(0,5).map((s,t)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 0",borderBottom:t<Math.min(u.recentUsage.length,5)-1?"1px solid #f1f5f9":"none"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"500",color:"#1e293b",marginBottom:"0.25rem"},children:s.categoryName}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:["Last used ",Math.floor((Date.now()-s.lastUsed.getTime())/(1440*60*1e3))," days ago"]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:e.jsxs("div",{style:{padding:"0.25rem 0.5rem",backgroundColor:"#f3f4f6",borderRadius:"0.25rem",fontSize:"0.75rem",fontWeight:"600",color:"#374151"},children:[s.count," warnings"]})})]},s.categoryId))})]})]}),l==="universal"&&e.jsxs("div",{style:{padding:"2rem"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",flexWrap:"wrap"},children:[e.jsx("div",{style:{flex:1,minWidth:"300px"},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(ne,{className:"h-4 w-4",style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),e.jsx("input",{type:"text",placeholder:"Search categories...",value:j.search,onChange:s=>ee(t=>({...t,search:s.target.value})),style:{width:"100%",padding:"0.5rem 0.75rem 0.5rem 2.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"}})]})}),e.jsxs("select",{value:j.severity,onChange:s=>ee(t=>({...t,severity:s.target.value})),style:{padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",backgroundColor:"white",minWidth:"120px"},children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"minor",children:"Minor"}),e.jsx("option",{value:"serious",children:"Serious"}),e.jsx("option",{value:"gross_misconduct",children:"Gross Misconduct"})]}),e.jsxs("select",{value:j.status,onChange:s=>ee(t=>({...t,status:s.target.value})),style:{padding:"0.5rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",backgroundColor:"white",minWidth:"100px"},children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"enabled",children:"Enabled"}),e.jsx("option",{value:"disabled",children:"Disabled"})]})]}),e.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"0.5rem",overflow:"hidden"},children:[te.map((s,t)=>{const n=Re(s.id),m=ve===s.id;J?.id,s.id;const v=Ie(s.id),p=We(s);return e.jsx("div",{children:e.jsxs("div",{style:{padding:"1.5rem",borderBottom:t<te.length-1?"1px solid #f1f5f9":"none",backgroundColor:n?"#f8fafc":"white",opacity:n?.7:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[e.jsx("h4",{style:{fontSize:"1.125rem",fontWeight:"600",color:n?"#6b7280":"#1e293b",margin:0},children:p.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.125rem 0.5rem",borderRadius:"0.75rem",backgroundColor:le(p.severity),color:"white",fontSize:"0.75rem",fontWeight:"600"},children:[oe(p.severity),p.severity.replace("_"," ")]}),v&&v.count>0&&e.jsxs("div",{style:{padding:"0.125rem 0.5rem",backgroundColor:"#f3f4f6",borderRadius:"0.75rem",fontSize:"0.75rem",fontWeight:"500",color:"#374151"},children:[v.count," warnings"]}),n&&e.jsx("div",{style:{padding:"0.125rem 0.5rem",backgroundColor:"#fee2e2",borderRadius:"0.75rem",fontSize:"0.75rem",fontWeight:"500",color:"#dc2626"},children:"Disabled"})]}),e.jsx("p",{style:{fontSize:"0.875rem",color:n?"#9ca3af":"#64748b",margin:"0 0 0.75rem 0",lineHeight:"1.5"},children:p.description}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#6b7280"},children:[e.jsx(D,{className:"h-3 w-3"}),p.escalationPath.length," steps"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#6b7280"},children:[e.jsx(q,{className:"h-3 w-3"}),p.lraSection]}),p.commonExamples.length>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#6b7280"},children:[e.jsx(F,{className:"h-3 w-3"}),p.commonExamples.length," examples"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[!M&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>Se(s.id),disabled:c,style:{padding:"0.5rem",backgroundColor:n?"#10b981":"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:c?"not-allowed":"pointer",fontSize:"0.75rem",fontWeight:"500",opacity:c?.6:1,display:"flex",alignItems:"center",gap:"0.25rem"},children:[n?e.jsx(ie,{className:"h-3 w-3"}):e.jsx(Te,{className:"h-3 w-3"}),n?"Enable":"Disable"]}),e.jsx("button",{onClick:()=>K({type:"universal",id:s.id,data:{}}),style:{padding:"0.5rem",backgroundColor:"#8b5cf6",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center"},children:e.jsx(me,{className:"h-3 w-3"})})]}),e.jsx("button",{onClick:()=>we(m?null:s.id),style:{padding:"0.5rem",backgroundColor:"transparent",border:"1px solid #d1d5db",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center"},children:m?e.jsx(Pe,{className:"h-4 w-4"}):e.jsx(Le,{className:"h-4 w-4"})})]})]}),m&&e.jsx("div",{style:{marginTop:"1.5rem",padding:"1.5rem",backgroundColor:"#f8fafc",borderRadius:"0.5rem",border:"1px solid #e2e8f0"},children:e.jsxs("div",{style:{display:"grid",gap:"1.5rem",gridTemplateColumns:window.innerWidth>1024?"repeat(3, 1fr)":"1fr"},children:[e.jsxs("div",{children:[e.jsxs("h5",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(D,{className:"h-4 w-4"}),"Escalation Path"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:p.escalationPath.map((B,$)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.25rem 0.5rem",backgroundColor:"white",borderRadius:"0.25rem",fontSize:"0.75rem"},children:[e.jsx("span",{style:{backgroundColor:"#3b82f6",color:"white",width:"1.25rem",height:"1.25rem",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.625rem",fontWeight:"600"},children:$+1}),B.replace("_"," ")]},$))})]}),e.jsxs("div",{children:[e.jsxs("h5",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(q,{className:"h-4 w-4"}),"Legal Framework"]}),e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"white",borderRadius:"0.375rem",fontSize:"0.75rem",lineHeight:"1.4"},children:[e.jsx("div",{style:{fontWeight:"500",color:"#1e293b",marginBottom:"0.25rem"},children:p.lraSection}),e.jsx("div",{style:{color:"#6b7280"},children:p.schedule8Reference})]})]}),p.commonExamples.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(F,{className:"h-4 w-4"}),"Common Examples"]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:[p.commonExamples.slice(0,6).map((B,$)=>e.jsx("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:"#dbeafe",color:"#1e40af",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"500"},children:B},$)),p.commonExamples.length>6&&e.jsxs("span",{style:{fontSize:"0.75rem",color:"#6b7280",fontStyle:"italic",alignSelf:"center"},children:["+",p.commonExamples.length-6," more..."]})]})]})]})})]})},s.id)}),te.length===0&&e.jsxs("div",{style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:[e.jsx(ne,{className:"h-8 w-8 mx-auto mb-4",style:{color:"#9ca3af"}}),e.jsx("p",{style:{margin:0,fontSize:"0.875rem"},children:"No categories found matching your filters."})]})]})]}),l==="custom"&&e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"2rem"},children:e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1e293b",margin:0,marginBottom:"0.25rem"},children:"Custom Categories"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:0},children:"Organization-specific categories beyond the universal standards."})]})}),L.length>0?e.jsx("div",{style:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"0.5rem",overflow:"hidden"},children:L.map((s,t)=>e.jsx("div",{style:{padding:"1.5rem",borderBottom:t<L.length-1?"1px solid #f1f5f9":"none"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[e.jsx("h4",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#1e293b",margin:0},children:s.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.125rem 0.5rem",borderRadius:"0.75rem",backgroundColor:le(s.severity),color:"white",fontSize:"0.75rem",fontWeight:"600"},children:[oe(s.severity),s.severity]}),e.jsx("div",{style:{padding:"0.125rem 0.5rem",backgroundColor:"#fef3c7",borderRadius:"0.75rem",fontSize:"0.75rem",fontWeight:"500",color:"#d97706"},children:"Custom"})]}),e.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:"0 0 0.75rem 0",lineHeight:"1.5"},children:s.description||"No description provided"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#6b7280"},children:[e.jsx(D,{className:"h-3 w-3"}),s.escalationPath?.length||0," steps"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#6b7280"},children:[e.jsx(Oe,{className:"h-3 w-3"}),"Created ",new Date(s.createdAt).toLocaleDateString()]})]})]}),!M&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>K({type:"custom",id:s.id,data:s}),style:{padding:"0.5rem",backgroundColor:"#8b5cf6",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center"},children:e.jsx(me,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>ke(s.id),style:{padding:"0.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center"},children:e.jsx(Fe,{className:"h-3 w-3"})})]})]})},s.id))}):e.jsxs("div",{style:{padding:"3rem",textAlign:"center",border:"2px dashed #e2e8f0",borderRadius:"0.5rem",color:"#64748b"},children:[e.jsx(O,{className:"h-12 w-12 mx-auto mb-4",style:{color:"#9ca3af"}}),e.jsx("h4",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"0.5rem",color:"#374151"},children:"No Custom Categories"}),e.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.875rem"},children:"Create organization-specific categories to supplement the universal standards."}),!M&&e.jsxs("button",{onClick:()=>X(!0),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#8b5cf6",color:"white",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer"},children:[e.jsx(V,{className:"h-4 w-4"}),"Create First Custom Category"]})]})]}),l==="analytics"&&C&&e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"2rem"},children:e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1e293b",margin:0,marginBottom:"0.25rem"},children:"Category Usage Analytics"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:0},children:"Insights into how categories are being used across your organization."})]})}),u?e.jsx("div",{style:{display:"grid",gap:"2rem"},children:e.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"0.5rem",padding:"2rem",textAlign:"center"},children:[e.jsx(D,{className:"h-12 w-12 mx-auto mb-4",style:{color:"#9ca3af"}}),e.jsx("h4",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"0.5rem",color:"#374151"},children:"Usage Analytics Coming Soon"}),e.jsx("p",{style:{color:"#64748b",margin:0,fontSize:"0.875rem"},children:"Detailed analytics and charts will be available in a future update."})]})}):e.jsxs("div",{style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:[e.jsx(re,{className:"h-8 w-8 mx-auto mb-4 animate-spin"}),e.jsx("p",{style:{margin:0},children:"Loading analytics data..."})]})]})]})}),Ce&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"2rem",width:"90%",maxWidth:"42rem",maxHeight:"80vh",overflowY:"auto"},children:[e.jsx("h4",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1.5rem",color:"#1e293b"},children:"Create Custom Category"}),e.jsxs("div",{style:{display:"grid",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Category Name *"}),e.jsx("input",{type:"text",value:g.name||"",onChange:s=>A(t=>({...t,name:s.target.value})),placeholder:"e.g., Social Media Policy Violations",style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Description"}),e.jsx("textarea",{value:g.description||"",onChange:s=>A(t=>({...t,description:s.target.value})),placeholder:"Brief description of what this category covers...",rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Severity Level"}),e.jsxs("select",{value:g.severity||"serious",onChange:s=>A(t=>({...t,severity:s.target.value})),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",backgroundColor:"white"},children:[e.jsx("option",{value:"minor",children:"Minor - Correctable behavior issues"}),e.jsx("option",{value:"serious",children:"Serious - Policy violations or misconduct"}),e.jsx("option",{value:"gross_misconduct",children:"Gross Misconduct - Severe violations"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Category Icon"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 1fr)",gap:"0.5rem",padding:"1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:"#f9fafb"},children:["📋","⚠️","📊","🔒","👔","💼","🏢","📞","🖥️","📝","🗂️","📅","🔧","⚡","🎯","📈"].map(s=>e.jsx("button",{type:"button",onClick:()=>A(t=>({...t,icon:s})),style:{width:"3rem",height:"3rem",border:g.icon===s?"2px solid #8b5cf6":"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:g.icon===s?"#f3f4f6":"white",fontSize:"1.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:t=>{g.icon!==s&&(t.currentTarget.style.backgroundColor="#f3f4f6")},onMouseLeave:t=>{g.icon!==s&&(t.currentTarget.style.backgroundColor="white")},children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Common Examples (Optional)"}),e.jsx("textarea",{value:g.examples?.join(`
`)||"",onChange:s=>A(t=>({...t,examples:s.target.value.split(`
`).filter(n=>n.trim())})),placeholder:"Enter examples, one per line...",rows:4,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",resize:"vertical"}}),e.jsx("p",{style:{fontSize:"0.75rem",color:"#6b7280",margin:"0.5rem 0 0 0"},children:"Enter one example per line to help managers understand when to use this category."})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"2rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{X(!1),A({name:"",description:"",severity:"serious",icon:"📋",escalationPath:["counselling","verbal","first_written","final_written"],examples:[],isActive:!0})},style:{padding:"0.75rem 1.5rem",border:"1px solid #d1d5db",backgroundColor:"white",color:"#374151",borderRadius:"0.375rem",fontSize:"0.875rem",cursor:"pointer"},children:"Cancel"}),e.jsxs("button",{onClick:ze,disabled:!g.name?.trim()||c,style:{padding:"0.75rem 1.5rem",border:"none",backgroundColor:!g.name?.trim()||c?"#9ca3af":"#8b5cf6",color:"white",borderRadius:"0.375rem",fontSize:"0.875rem",cursor:!g.name?.trim()||c?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[c?e.jsx(re,{className:"h-4 w-4 animate-spin"}):e.jsx(V,{className:"h-4 w-4"}),c?"Creating...":"Create Category"]})]})]})}),J&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"2rem",width:"90%",maxWidth:"42rem",maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs("h4",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1.5rem",color:"#1e293b"},children:["Edit ",J.type==="universal"?"Universal":"Custom"," Category"]}),e.jsx("div",{style:{padding:"1rem",backgroundColor:"#f0f9ff",border:"1px solid #bae6fd",borderRadius:"0.375rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",color:"#0369a1"},children:[e.jsx(_e,{className:"h-4 w-4"}),"Category editing functionality will be implemented in the next phase."]})}),e.jsx("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:e.jsx("button",{onClick:()=>K(null),style:{padding:"0.75rem 1.5rem",border:"1px solid #d1d5db",backgroundColor:"white",color:"#374151",borderRadius:"0.375rem",fontSize:"0.875rem",cursor:"pointer"},children:"Close"})})]})})]})}):e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"#64748b"},children:[e.jsx(G,{className:"h-12 w-12 mx-auto mb-4",style:{color:"#f59e0b"}}),e.jsx("h3",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"0.5rem",color:"#374151"},children:"Organization Not Found"}),e.jsx("p",{style:{margin:0},children:"Please ensure you're logged into a valid organization to manage categories."})]})},Je=({client:o,isOpen:w,onClose:T,onUpdate:H})=>{const[S,z]=i.useState("general"),[P,x]=i.useState(!1),[R,C]=i.useState(!1),[l,I]=i.useState({totalEmployees:0,totalWarnings:0,totalCategories:0,totalUsers:0,activeWarnings:0,complianceScore:85}),[d,b]=i.useState({name:o.name||"",contactEmail:o.contactEmail||"",contactPhone:o.contactPhone||"",address:o.address||"",sector:o.sector||"",description:o.description||""});i.useEffect(()=>{w&&o.id&&c()},[w,o.id]);const c=async()=>{try{x(!0),f.debug("Loading client organization statistics...",{clientId:o.id});const a=await de.loadEmployees(o.id),r=await de.loadWarnings(o.id),h=await De.queryDocuments(o.id,"categories",[]),y=r.documents.filter(Z=>Z.status==="issued").length,W=Math.max(95-y*3,60);I({totalEmployees:a.documents.length,totalWarnings:r.documents.length,totalCategories:h.documents.length,totalUsers:0,activeWarnings:y,complianceScore:W}),f.success("Client statistics loaded successfully")}catch(a){f.error("Failed to load client statistics:",a)}finally{x(!1)}},N=async()=>{try{C(!0),f.debug("Updating client general information...",d),await H(o.id,d),f.success("Client information updated successfully")}catch(a){f.error("Failed to update client information:",a)}finally{C(!1)}},k=[{id:"general",label:"General Info",icon:ge,description:"Basic organization details"},{id:"categories",label:"Warning Categories",icon:Xe,description:"Manage warning categories and escalation paths"},{id:"users",label:"User Management",icon:_,description:"Organization users and permissions"},{id:"analytics",label:"Analytics",icon:$e,description:"Performance metrics and insights"}];return w?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(ge,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:o.name}),e.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-yellow-500"}),"Client Organization Management"]})]})]}),e.jsx("button",{onClick:T,className:"p-2 hover:bg-gray-200 rounded-lg transition-colors",children:e.jsx(ae,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{className:"p-6 border-b bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.totalEmployees}),e.jsx("div",{className:"text-xs text-gray-600",children:"Employees"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.totalCategories}),e.jsx("div",{className:"text-xs text-gray-600",children:"Categories"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:l.totalWarnings}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Warnings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:l.activeWarnings}),e.jsx("div",{className:"text-xs text-gray-600",children:"Active"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[l.complianceScore,"%"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Compliance"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${l.complianceScore>=80?"text-green-600":l.complianceScore>=60?"text-yellow-600":"text-red-600"}`,children:l.complianceScore>=80?"✓":l.complianceScore>=60?"⚠":"✗"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Status"})]})]})}),e.jsx("div",{className:"border-b",children:e.jsx("nav",{className:"flex space-x-1 p-2",children:k.map(a=>{const r=a.icon;return e.jsxs("button",{onClick:()=>z(a.id),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${S===a.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(r,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:block",children:a.label})]},a.id)})})}),e.jsxs("div",{className:"overflow-y-auto",style:{maxHeight:"calc(90vh - 200px)"},children:[S==="general"&&e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Organization Details"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Update basic organization information"})]}),e.jsxs("button",{onClick:N,disabled:R,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[R?e.jsx(ue,{className:"w-4 h-4 animate-spin"}):e.jsx(Ge,{className:"w-4 h-4"}),R?"Saving...":"Save Changes"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name"}),e.jsx("input",{type:"text",value:d.name,onChange:a=>b({...d,name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter organization name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sector"}),e.jsx("input",{type:"text",value:d.sector,onChange:a=>b({...d,sector:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Manufacturing, Retail, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",value:d.contactEmail,onChange:a=>b({...d,contactEmail:a.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"contact@organization.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone"}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"tel",value:d.contactPhone,onChange:a=>b({...d,contactPhone:a.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+27 XX XXX XXXX"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),e.jsx("textarea",{value:d.address,onChange:a=>b({...d,address:a.target.value}),rows:3,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Full business address"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),e.jsx("textarea",{value:d.description,onChange:a=>b({...d,description:a.target.value}),rows:4,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of the organization..."})]})]})]}),S==="categories"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Warning Categories Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage warning categories and escalation paths for this client organization"})]}),e.jsx("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:e.jsx(Ze,{onClose:()=>{},organizationId:o.id,isEmbedded:!0})})]}),S==="users"&&e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"User Management"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage organization users and their permissions"}),e.jsxs("div",{className:"text-sm text-yellow-700 bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-w-md mx-auto",children:[e.jsx(Y,{className:"w-4 h-4 inline mr-2"}),"This feature is coming soon. Users can be managed directly through the organization's admin interface."]})]})}),S==="analytics"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Analytics"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Insights and metrics for this client organization"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Compliance Score"}),e.jsx(pe,{className:"w-5 h-5 text-green-500"})]}),e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[l.complianceScore,"%"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:l.complianceScore>=80?"Excellent":l.complianceScore>=60?"Good":"Needs Improvement"})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Active Warnings"}),e.jsx(Y,{className:"w-5 h-5 text-orange-500"})]}),e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:l.activeWarnings}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Out of ",l.totalWarnings," total warnings"]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Total Employees"}),e.jsx(_,{className:"w-5 h-5 text-blue-500"})]}),e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:l.totalEmployees}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Managed workforce"})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Quick Recommendations"}),e.jsxs("div",{className:"space-y-3",children:[l.activeWarnings>5&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx(Y,{className:"w-5 h-5 text-orange-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-orange-900",children:"High Active Warnings"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Consider reviewing and resolving active warnings to improve compliance score."})]})]}),l.totalCategories<5&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(D,{className:"w-5 h-5 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-blue-900",children:"Limited Warning Categories"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Consider adding more specific warning categories to improve HR management granularity."})]})]}),l.complianceScore>=90&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(Q,{className:"w-5 h-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-green-900",children:"Excellent Compliance"}),e.jsx("p",{className:"text-sm text-green-700",children:"This organization maintains excellent HR compliance standards."})]})]})]})]})]})]})]})}):null},xs=()=>{const{user:o}=he(),[w,T]=i.useState([]),[H,S]=i.useState(!0),[z,P]=i.useState(""),[x,R]=i.useState("all"),[C,l]=i.useState(null),[I,d]=i.useState(!1);i.useEffect(()=>{o?.resellerId&&b()},[o?.resellerId]);const b=async()=>{if(o?.resellerId)try{S(!0),f.debug("Loading reseller clients...",{resellerId:o.resellerId});const r=await ce.getResellerClients(o.resellerId),h=await Promise.all(r.map(async y=>{const W=await Ue.getClientMetrics(y.id);return{...y,metrics:W}}));T(h),f.success(`Loaded ${h.length} clients`)}catch(r){f.error("Failed to load clients:",r)}finally{S(!1)}},c=w.filter(r=>{const h=r.name.toLowerCase().includes(z.toLowerCase())||r.sector.toLowerCase().includes(z.toLowerCase()),y=x==="all"||r.metrics.subscriptionStatus===x;return h&&y}),N=async(r,h)=>{try{f.debug("Updating client information...",{clientId:r,updates:h}),await ce.updateOrganization(r,h),f.success("Client updated successfully"),await b(),d(!1),l(null)}catch(y){f.error("Failed to update client:",y)}},k=r=>`R${(r/100).toLocaleString("en-ZA",{minimumFractionDigits:2})}`,a=r=>{switch(r){case"active":return"text-green-600 bg-green-100";case"inactive":return"text-red-600 bg-red-100";case"trial":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}};return H?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your clients..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"My Clients"}),e.jsx("p",{className:"text-gray-600",children:"Manage your client organizations"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("span",{className:"text-sm text-gray-600",children:[c.length," of ",w.length," clients"]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clients by name or sector...",value:z,onChange:r=>P(r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:x,onChange:r=>R(r.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"trial",children:"Trial"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"font-medium",children:"Active Clients"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:w.filter(r=>r.metrics.subscriptionStatus==="active").length})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(qe,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"font-medium",children:"Monthly Revenue"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:k(w.reduce((r,h)=>r+h.metrics.monthlyRevenue,0))})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(_,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"font-medium",children:"Total Employees"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:w.reduce((r,h)=>r+h.metrics.employeeCount,0)})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Client Organizations"})}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Organization"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:c.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:r.name}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-2",children:[e.jsx("span",{children:r.sector}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"}),r.metrics.employeeCount," employees"]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:r.contactEmail||"Not provided"})]}),e.jsxs("div",{className:"text-sm flex items-center gap-1",children:[e.jsx(ye,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{children:r.contactPhone||"Not provided"})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${a(r.metrics.subscriptionStatus)}`,children:[r.metrics.subscriptionStatus==="active"&&e.jsx(Q,{className:"w-3 h-3"}),r.metrics.subscriptionStatus==="inactive"&&e.jsx(Y,{className:"w-3 h-3"}),r.metrics.subscriptionStatus==="trial"&&e.jsx(Ye,{className:"w-3 h-3"}),r.metrics.subscriptionStatus.charAt(0).toUpperCase()+r.metrics.subscriptionStatus.slice(1)]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Last active: ",new Date(r.metrics.lastActivity).toLocaleDateString("en-ZA")]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:k(r.metrics.monthlyRevenue)}),e.jsx("div",{className:"text-xs text-gray-500",children:"per month"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[r.metrics.complianceScore,"%"]}),e.jsx("span",{className:"text-gray-500",children:" compliance"})]})}),e.jsxs("div",{className:"text-xs text-gray-500",children:[r.metrics.warningsThisMonth," warnings this month"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{l(r),d(!0)},className:"text-blue-600 hover:text-blue-800",title:"Manage client organization",children:e.jsx(Qe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>window.open(`/organizations/${r.id}`,"_blank"),className:"text-green-600 hover:text-green-800",title:"View organization",children:e.jsx(ie,{className:"w-4 h-4"})})]})})]},r.id))})]}),c.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(xe,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No clients found"}),e.jsx("p",{className:"text-sm text-gray-500",children:z||x!=="all"?"Try adjusting your search or filters":"Your client organizations will appear here"})]})]})]}),C&&e.jsx(Je,{client:C,isOpen:I,onClose:()=>{d(!1),l(null)},onUpdate:N})]})};export{xs as MyClients};
