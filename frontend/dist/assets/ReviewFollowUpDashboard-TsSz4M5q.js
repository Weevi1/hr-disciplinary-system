import{j as e,u as r,f as s,g as a,T as t,p as o}from"./business-owner-dashboard-CK-ZpSaU.js";import{R as l,r as n}from"./react-vendor-BMk1H4su.js";import{a as c}from"./hr-dashboard-CsDff0Dt.js";import{U as i}from"./dashboard-router-BFAzDQx1.js";import{ai as d,T as m,F as x,s as v,c as p,r as u,q as h,ao as y,X as g,n as j,d as b,Y as f,B as N,aA as w}from"./ui-vendor-CMPykBlV.js";import"./pdf-vendor-CbrIsI36.js";import"./firebase-vendor-BIBOIkWK.js";import"./hod-dashboard-DsqlnPCJ.js";const C=l.memo(({tabs:r,activeTab:s,onTabChange:a,className:t="",variant:o="default",size:l="md"})=>{const c={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},i=n.useMemo(()=>({transition:"all 0.2s ease-in-out",cursor:"pointer",borderBottom:"2px solid transparent",display:"flex",alignItems:"center",gap:"0.5rem"}),[]),d=n.useCallback(e=>{const r=e===s;return"minimal"===o?{...i,color:r?"var(--color-nav-tab-active)":"var(--color-nav-tab-inactive)",borderBottomColor:r?"var(--color-nav-tab-active)":"transparent",backgroundColor:"transparent"}:{...i,color:r?"var(--color-nav-tab-active)":"var(--color-nav-tab-inactive)",borderBottomColor:r?"var(--color-nav-tab-active)":"transparent",backgroundColor:r?"var(--color-background-secondary)":"transparent",borderRadius:"0.5rem 0.5rem 0 0"}},[s,o,i]),m=n.useMemo(()=>({color:"var(--color-nav-tab-hover)",backgroundColor:"minimal"===o?"transparent":"var(--color-background-tertiary)"}),[o]),x=n.useCallback((e,r)=>{r!==s&&Object.assign(e.currentTarget.style,m)},[s,m]),v=n.useCallback((e,r)=>{r!==s&&Object.assign(e.currentTarget.style,d(r))},[s,d]),p=n.useCallback(e=>{e.currentTarget.style.boxShadow="0 0 0 2px var(--color-focus-ring)"},[]),u=n.useCallback(e=>{e.currentTarget.style.boxShadow="none"},[]);return e.jsx("div",{className:`flex border-b ${t}`,style:{borderColor:"var(--color-border)"},children:r.map(r=>e.jsxs("button",{className:`${c[l]} font-medium focus:outline-none`,style:d(r.id),onClick:()=>a(r.id),onMouseEnter:e=>x(e,r.id),onMouseLeave:e=>v(e,r.id),onFocus:p,onBlur:u,children:[r.icon&&e.jsx("span",{className:"w-4 h-4 flex-shrink-0",children:r.icon}),e.jsx("span",{children:r.label}),void 0!==r.count&&e.jsx("span",{className:"rounded-full text-xs px-1.5 py-0.5 min-w-[1.25rem] text-center",style:{backgroundColor:r.id===s?"var(--color-badge-primary)":"var(--color-badge-default)",color:r.id===s?"var(--color-badge-primary-text)":"var(--color-badge-default-text)"},children:r.count})]},r.id))})});C.displayName="ThemedTabNavigation";const D=({isOpen:c,onClose:j,warning:b,onReviewComplete:f})=>{const{user:N}=r(),[w,C]=n.useState(""),[D,k]=n.useState(""),[S,W]=n.useState(""),[A,T]=n.useState(""),[R,M]=n.useState(!1),[_,U]=n.useState(null),O=n.useCallback(async()=>{if(b&&w&&N)try{M(!0),U(null),await f(b.id,{reviewOutcome:w,hodFeedback:D.trim()||void 0,hrNotes:S.trim()||void 0,nextSteps:A.trim()||void 0,reviewedBy:N.uid}),j()}catch(e){console.error("Error completing review:",e),U("Failed to save review. Please try again.")}finally{M(!1)}},[b,w,D,S,A,N,f,j]);if(l.useEffect(()=>{c||(C(""),k(""),W(""),T(""),U(null))},[c]),!b)return null;const z=e=>{if(!e)return"N/A";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"})};return e.jsx(i,{isOpen:c,onClose:j,title:"Review Corrective Action Progress",subtitle:`${b.employee?.firstName||""} ${b.employee?.lastName||""} - ${b.employee?.employeeNumber||""}`,size:"xl",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 p-6 overflow-y-auto",style:{maxHeight:"75vh"},children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(s,{padding:"md",children:e.jsxs("div",{className:"flex items-start gap-4",children:[b.employee?.photoUrl?e.jsx("img",{src:b.employee.photoUrl,alt:`${b.employee.firstName} ${b.employee.lastName}`,className:"w-16 h-16 rounded-lg object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--color-background-secondary)"},children:e.jsx(d,{className:"w-8 h-8",style:{color:"var(--color-text-secondary)"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:[b.employee?.firstName," ",b.employee?.lastName]}),e.jsxs("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:[b.employee?.position," • ",b.employee?.department]}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--color-text-secondary)"},children:["Employee #",b.employee?.employeeNumber]})]}),e.jsx(a,{variant:"warning",children:(B=b.level,{counselling:"Counselling",verbal:"Verbal Warning",first_written:"Written Warning",second_written:"Second Written Warning",final_written:"Final Warning",suspension:"Suspension",dismissal:"Ending of Service"}[B]||B)})]})}),e.jsxs(s,{padding:"md",children:[e.jsxs("h4",{className:"text-sm font-semibold mb-3 flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx(m,{className:"w-4 h-4"}),"Original Warning Details"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{style:{color:"var(--color-text-secondary)"},children:"Category:"}),e.jsx("span",{style:{color:"var(--color-text)"},className:"font-medium",children:b.category||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{style:{color:"var(--color-text-secondary)"},children:"Issue Date:"}),e.jsx("span",{style:{color:"var(--color-text)"},children:z(b.issueDate)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{style:{color:"var(--color-text-secondary)"},children:"Review Date:"}),e.jsx("span",{style:{color:"var(--color-text)"},className:"font-medium",children:z(b.reviewDate)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{style:{color:"var(--color-text-secondary)"},children:"Issued By:"}),e.jsx("span",{style:{color:"var(--color-text)"},children:b.managerName||"Unknown"})]})]})]}),e.jsxs(s,{padding:"md",children:[e.jsxs("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx(x,{className:"w-4 h-4"}),"Incident Description"]}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",style:{color:"var(--color-text-secondary)"},children:b.description})]}),b.expectedBehaviorStandards&&e.jsxs(s,{padding:"md",children:[e.jsxs("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx(v,{className:"w-4 h-4"}),"Expected Behavior/Standards"]}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",style:{color:"var(--color-text-secondary)"},children:b.expectedBehaviorStandards})]}),b.improvementCommitments&&b.improvementCommitments.length>0&&e.jsxs(s,{padding:"md",children:[e.jsxs("h4",{className:"text-sm font-semibold mb-3 flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx(p,{className:"w-4 h-4"}),"Improvement Commitments"]}),e.jsx("div",{className:"space-y-3",children:b.improvementCommitments.map((r,s)=>e.jsxs("div",{className:"border-l-2 pl-3",style:{borderColor:"var(--color-border)"},children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--color-text)"},children:r.commitment}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--color-text-secondary)"},children:["Timeline: ",r.timeline]}),r.completedDate&&e.jsx(a,{variant:"success",size:"sm",className:"mt-1",children:"Completed"})]},s))})]})]}),e.jsxs("div",{className:"w-full md:w-96 space-y-4",children:[e.jsxs(s,{padding:"md",children:[e.jsxs("h4",{className:"text-sm font-semibold mb-3 flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx(d,{className:"w-4 h-4"}),"Contact Department Manager"]}),e.jsx("p",{className:"text-sm mb-3",style:{color:"var(--color-text-secondary)"},children:b.managerName||"Department Manager"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:"secondary",size:"sm",className:"flex-1",children:[e.jsx(u,{className:"w-3 h-3 mr-1"}),"Call"]}),e.jsxs(t,{variant:"secondary",size:"sm",className:"flex-1",children:[e.jsx(h,{className:"w-3 h-3 mr-1"}),"Email"]})]})]}),e.jsxs(s,{padding:"md",children:[e.jsxs("label",{className:"block text-sm font-semibold mb-2",style:{color:"var(--color-text)"},children:[e.jsx(y,{className:"w-4 h-4 inline mr-1"}),"Department Manager Feedback"]}),e.jsx("textarea",{value:D,onChange:e=>k(e.target.value),placeholder:"Record verbal feedback from the department manager...",className:"w-full px-3 py-2 border rounded-lg text-sm resize-vertical",style:{backgroundColor:"var(--color-input-background)",borderColor:"var(--color-input-border)",color:"var(--color-text)",minHeight:"80px"}})]}),e.jsxs(s,{padding:"md",children:[e.jsxs("label",{className:"block text-sm font-semibold mb-3",style:{color:"var(--color-text)"},children:["Review Outcome ",e.jsx("span",{style:{color:"var(--color-error)"},children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-start gap-3 p-3 border rounded-lg cursor-pointer hover:bg-opacity-50",style:{borderColor:"satisfactory"===w?"var(--color-success)":"var(--color-border)",backgroundColor:"satisfactory"===w?"var(--color-alert-success-bg)":"transparent"},children:[e.jsx("input",{type:"radio",name:"outcome",value:"satisfactory",checked:"satisfactory"===w,onChange:e=>C(e.target.value),className:"mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-medium flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx(v,{className:"w-4 h-4 text-green-600"}),"Satisfactory"]}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:"var(--color-text-secondary)"},children:"No further action needed"})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-3 border rounded-lg cursor-pointer hover:bg-opacity-50",style:{borderColor:"some_concerns"===w?"var(--color-warning)":"var(--color-border)",backgroundColor:"some_concerns"===w?"var(--color-alert-warning-bg)":"transparent"},children:[e.jsx("input",{type:"radio",name:"outcome",value:"some_concerns",checked:"some_concerns"===w,onChange:e=>C(e.target.value),className:"mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-medium flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx(m,{className:"w-4 h-4 text-orange-600"}),"Some Concerns"]}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:"var(--color-text-secondary)"},children:"Monitor for another period"})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-3 border rounded-lg cursor-pointer hover:bg-opacity-50",style:{borderColor:"unsatisfactory"===w?"var(--color-error)":"var(--color-border)",backgroundColor:"unsatisfactory"===w?"var(--color-alert-error-bg)":"transparent"},children:[e.jsx("input",{type:"radio",name:"outcome",value:"unsatisfactory",checked:"unsatisfactory"===w,onChange:e=>C(e.target.value),className:"mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-medium flex items-center gap-2",style:{color:"var(--color-text)"},children:[e.jsx(g,{className:"w-4 h-4 text-red-600"}),"Unsatisfactory"]}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:"var(--color-text-secondary)"},children:"Issue new warning / escalate"})]})]})]})]}),e.jsxs(s,{padding:"md",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"var(--color-text)"},children:"HR Notes"}),e.jsx("textarea",{value:S,onChange:e=>W(e.target.value),placeholder:"Additional notes about this review...",className:"w-full px-3 py-2 border rounded-lg text-sm resize-vertical",style:{backgroundColor:"var(--color-input-background)",borderColor:"var(--color-input-border)",color:"var(--color-text)",minHeight:"60px"}})]}),"unsatisfactory"===w&&e.jsxs(s,{padding:"md",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"var(--color-text)"},children:"Next Steps"}),e.jsx("textarea",{value:A,onChange:e=>T(e.target.value),placeholder:"Schedule follow-up meeting / Issue new warning / Escalate to next level...",className:"w-full px-3 py-2 border rounded-lg text-sm resize-vertical",style:{backgroundColor:"var(--color-input-background)",borderColor:"var(--color-input-border)",color:"var(--color-text)",minHeight:"60px"}})]}),_&&e.jsx(o,{variant:"error",onClose:()=>U(null),children:_}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(t,{variant:"secondary",onClick:j,className:"flex-1",disabled:R,children:"Cancel"}),e.jsx(t,{variant:"primary",onClick:O,className:"flex-1",disabled:!w||R,children:R?"Saving...":"satisfactory"===w?"Mark Satisfactory":"Submit Review"})]})]})]})});var B},k=()=>e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-24 bg-gray-200 rounded"})]})]}),S=()=>{const{warnings:r,dueSoon:l,overdue:i,completed:x,loading:u,error:h,updateReview:y}=c(),[g,S]=n.useState("due-soon"),[W,A]=n.useState(""),[T,R]=n.useState(""),[M,_]=n.useState(""),[U,O]=n.useState(null),[z,B]=n.useState(!1),E=n.useMemo(()=>{const e=new Date,r=new Date(e);r.setDate(e.getDate()-e.getDay());const s=new Date(e.getFullYear(),e.getMonth(),1);return{dueThisWeek:l.filter(e=>{if(!e.reviewDate)return!1;return(e.reviewDate.toDate?e.reviewDate.toDate():new Date(e.reviewDate))>=r}).length,overdue:i.length,autoSatisfiedThisMonth:x.filter(e=>{if(!e.reviewedAt&&"auto-satisfied"===e.reviewStatus){if(!e.reviewDate)return!1;const r=e.reviewDate.toDate?e.reviewDate.toDate():new Date(e.reviewDate),a=new Date(r);return a.setDate(a.getDate()+7),a>=s}return!1}).length,completedThisMonth:x.filter(e=>{if(!e.reviewedAt)return!1;return(e.reviewedAt instanceof Date?e.reviewedAt:new Date(e.reviewedAt))>=s}).length}},[l,i,x]),F=n.useMemo(()=>{const e=new Set;return r.forEach(r=>{r.employee?.department&&e.add(r.employee.department)}),Array.from(e).sort()},[r]),I=n.useMemo(()=>{let e;switch(g){case"due-soon":e=l;break;case"overdue":e=i;break;case"completed":e=x;break;default:e=[]}if(W){const r=W.toLowerCase();e=e.filter(e=>e.employee?.firstName?.toLowerCase().includes(r)||e.employee?.lastName?.toLowerCase().includes(r)||e.employee?.employeeNumber?.toLowerCase().includes(r))}return T&&(e=e.filter(e=>e.employee?.department===T)),M&&(e=e.filter(e=>e.level===M)),e.sort((e,r)=>{if(!e.reviewDate||!r.reviewDate)return 0;const s=e.reviewDate.toDate?e.reviewDate.toDate():new Date(e.reviewDate),a=r.reviewDate.toDate?r.reviewDate.toDate():new Date(r.reviewDate);return s.getTime()-a.getTime()})},[g,l,i,x,W,T,M]),L=e=>{O(e),B(!0)},$=e=>{if(!e)return"N/A";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"})},H=r=>{switch(r.reviewStatus){case"overdue":return e.jsx(a,{variant:"error",children:"Overdue"});case"auto-satisfied":return e.jsx(a,{variant:"success",children:"Auto-Satisfied"});case"completed":return e.jsx(a,{variant:"success",children:"Completed"});default:return void 0!==r.daysUntilReview&&r.daysUntilReview<=3?e.jsx(a,{variant:"warning",children:"Due Soon"}):e.jsx(a,{variant:"default",children:"Pending"})}},P=[{id:"due-soon",label:"Due Soon",icon:e.jsx(p,{className:"w-4 h-4"}),count:l.length},{id:"overdue",label:"Overdue",icon:e.jsx(m,{className:"w-4 h-4"}),count:i.length},{id:"completed",label:"Completed",icon:e.jsx(v,{className:"w-4 h-4"}),count:x.length}];return u?e.jsx("div",{className:"p-6",children:e.jsx(k,{})}):e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--color-text)"},children:"Corrective Action Reviews"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--color-text-secondary)"},children:"Manage follow-up reviews for employees with improvement commitments"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(s,{padding:"md",hover:!0,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-wide",style:{color:"var(--color-text-secondary)"},children:"Due This Week"}),e.jsx("p",{className:"text-2xl font-bold mt-1",style:{color:"var(--color-text)"},children:E.dueThisWeek})]}),e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"var(--color-background-secondary)"},children:e.jsx(j,{className:"w-5 h-5",style:{color:"var(--color-primary)"}})})]})}),e.jsx(s,{padding:"md",hover:!0,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-wide",style:{color:"var(--color-text-secondary)"},children:"Overdue"}),e.jsx("p",{className:"text-2xl font-bold mt-1",style:{color:"var(--color-error)"},children:E.overdue})]}),e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"var(--color-alert-error-bg)"},children:e.jsx(m,{className:"w-5 h-5 text-red-600"})})]})}),e.jsx(s,{padding:"md",hover:!0,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-wide",style:{color:"var(--color-text-secondary)"},children:"Auto-Satisfied (Month)"}),e.jsx("p",{className:"text-2xl font-bold mt-1",style:{color:"var(--color-text)"},children:E.autoSatisfiedThisMonth})]}),e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"var(--color-alert-success-bg)"},children:e.jsx(v,{className:"w-5 h-5 text-green-600"})})]})}),e.jsx(s,{padding:"md",hover:!0,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-wide",style:{color:"var(--color-text-secondary)"},children:"Completed (Month)"}),e.jsx("p",{className:"text-2xl font-bold mt-1",style:{color:"var(--color-text)"},children:E.completedThisMonth})]}),e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"var(--color-background-secondary)"},children:e.jsx(b,{className:"w-5 h-5",style:{color:"var(--color-primary)"}})})]})})]}),h&&e.jsx(o,{variant:"error",onClose:()=>{},children:h}),e.jsx(s,{padding:"md",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4",style:{color:"var(--color-text-secondary)"}}),e.jsx("input",{type:"text",value:W,onChange:e=>A(e.target.value),placeholder:"Search employees...",className:"w-full pl-10 pr-3 py-2 border rounded-lg text-sm",style:{backgroundColor:"var(--color-input-background)",borderColor:"var(--color-input-border)",color:"var(--color-text)"}})]}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4",style:{color:"var(--color-text-secondary)"}}),e.jsxs("select",{value:T,onChange:e=>R(e.target.value),className:"w-full pl-10 pr-3 py-2 border rounded-lg text-sm appearance-none",style:{backgroundColor:"var(--color-input-background)",borderColor:"var(--color-input-border)",color:"var(--color-text)"},children:[e.jsx("option",{value:"",children:"All Departments"}),F.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4",style:{color:"var(--color-text-secondary)"}}),e.jsxs("select",{value:M,onChange:e=>_(e.target.value),className:"w-full pl-10 pr-3 py-2 border rounded-lg text-sm appearance-none",style:{backgroundColor:"var(--color-input-background)",borderColor:"var(--color-input-border)",color:"var(--color-text)"},children:[e.jsx("option",{value:"",children:"All Levels"}),e.jsx("option",{value:"verbal",children:"Verbal Warning"}),e.jsx("option",{value:"first_written",children:"Written Warning"}),e.jsx("option",{value:"second_written",children:"Second Written Warning"}),e.jsx("option",{value:"final_written",children:"Final Warning"})]})]}),(W||T||M)&&e.jsx(t,{variant:"secondary",size:"sm",onClick:()=>{A(""),R(""),_("")},children:"Clear Filters"})]})}),e.jsx(C,{tabs:P,activeTab:g,onTabChange:e=>S(e)}),e.jsx("div",{className:"space-y-3",children:0===I.length?e.jsx(s,{padding:"lg",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"w-12 h-12 mx-auto mb-3",style:{color:"var(--color-text-secondary)",opacity:.5}}),e.jsxs("p",{className:"text-sm font-medium",style:{color:"var(--color-text)"},children:["No reviews ","due-soon"===g?"due soon":"overdue"===g?"overdue":"completed"]}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--color-text-secondary)"},children:"completed"===g?"Completed reviews will appear here":"All caught up!"})]})}):I.map(r=>{return e.jsx(s,{padding:"md",hover:!0,onClick:()=>L(r),children:e.jsxs("div",{className:"flex items-start gap-4",children:[r.employee?.photoUrl?e.jsx("img",{src:r.employee.photoUrl,alt:`${r.employee.firstName} ${r.employee.lastName}`,className:"w-12 h-12 rounded-lg object-cover flex-shrink-0"}):e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--color-background-secondary)"},children:e.jsx(d,{className:"w-6 h-6",style:{color:"var(--color-text-secondary)"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold",style:{color:"var(--color-text)"},children:[r.employee?.firstName," ",r.employee?.lastName]}),e.jsxs("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:[r.employee?.position," • ",r.employee?.department]})]}),H(r)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--color-text-secondary)"},children:"Warning Level:"}),e.jsx("p",{className:"font-medium mt-0.5",style:{color:"var(--color-text)"},children:(a=r.level,{counselling:"Counselling",verbal:"Verbal Warning",first_written:"Written Warning",second_written:"Second Written Warning",final_written:"Final Warning",suspension:"Suspension",dismissal:"Ending of Service"}[a]||a)})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--color-text-secondary)"},children:"Category:"}),e.jsx("p",{className:"font-medium mt-0.5",style:{color:"var(--color-text)"},children:r.category||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--color-text-secondary)"},children:"Issue Date:"}),e.jsx("p",{className:"font-medium mt-0.5",style:{color:"var(--color-text)"},children:$(r.issueDate)})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--color-text-secondary)"},children:"Review Date:"}),e.jsxs("p",{className:"font-medium mt-0.5",style:{color:"overdue"===r.reviewStatus?"var(--color-error)":"var(--color-text)"},children:[$(r.reviewDate),void 0!==r.daysUntilReview&&r.daysUntilReview>=0&&e.jsxs("span",{className:"ml-1",children:["(",r.daysUntilReview,"d)"]}),void 0!==r.daysSinceReview&&e.jsxs("span",{className:"ml-1",children:["(",r.daysSinceReview,"d ago)"]})]})]})]}),r.improvementCommitments&&r.improvementCommitments.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t",style:{borderColor:"var(--color-border)"},children:[e.jsx("p",{className:"text-xs font-medium mb-1",style:{color:"var(--color-text-secondary)"},children:"Improvement Commitments:"}),e.jsxs("p",{className:"text-xs",style:{color:"var(--color-text)"},children:[r.improvementCommitments[0].commitment,r.improvementCommitments.length>1&&e.jsxs("span",{style:{color:"var(--color-text-secondary)"},children:[" ","+",r.improvementCommitments.length-1," more"]})]})]}),"auto-satisfied"===r.reviewStatus&&e.jsxs("div",{className:"mt-3 pt-3 border-t",style:{borderColor:"var(--color-border)"},children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsxs("span",{style:{color:"var(--color-text-secondary)"},children:["Auto-satisfied on ",$(r.reviewDate&&new Date(r.reviewDate.toDate?r.reviewDate.toDate():r.reviewDate).setDate(new Date(r.reviewDate.toDate?r.reviewDate.toDate():r.reviewDate).getDate()+7))]})]}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--color-text-secondary)"},children:"No action required within 7 days of review date"})]})]}),"completed"!==r.reviewStatus&&"auto-satisfied"!==r.reviewStatus&&e.jsx(t,{variant:"primary",size:"sm",onClick:e=>{e.stopPropagation(),L(r)},children:"Review Now"})]})},r.id);var a})}),e.jsx(n.Suspense,{fallback:e.jsx(k,{}),children:e.jsx(D,{isOpen:z,onClose:()=>{B(!1),O(null)},warning:U,onReviewComplete:async(e,r)=>{await y(e,r),B(!1),O(null)}})})]})};export{S as ReviewFollowUpDashboard,S as default};
