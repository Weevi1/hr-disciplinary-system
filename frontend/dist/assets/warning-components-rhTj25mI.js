const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboard-router-CsxAXVhx.js","assets/business-owner-dashboard-Dq6MrEKt.js","assets/pdf-vendor-CbrIsI36.js","assets/react-vendor-BMk1H4su.js","assets/firebase-vendor-BIBOIkWK.js","assets/ui-vendor-Bx41JZPX.js","assets/hr-dashboard-Dso9aBo_.js","assets/hod-dashboard-CL_RWHxj.js","assets/NotificationDeliveryService-J1vOICqU.js"])))=>i.map(i=>d[i]);
import{n as e,L as t,d as s,a,j as r,g as n,T as i,f as l,o,u as c,A as d,p as m,q as p,N as x}from"./business-owner-dashboard-Dq6MrEKt.js";import{r as u}from"./react-vendor-BMk1H4su.js";import{P as h,u as g,Z as f,a as v}from"./dashboard-router-CsxAXVhx.js";import{a as y}from"./pdf-vendor-CbrIsI36.js";import{L as b,K as j,_ as N,M as w,N as D,O as S,P as C,Q as k,R as E,S as P,U as T,V as I,j as F,k as A,n as _,l as R,q as M,t as L,m as U,p as O,x as $,u as W}from"./firebase-vendor-BIBOIkWK.js";import{X as z,T as B,R as q,L as V,F as G,s as H,ak as K,al as Y,am as J,an as Q,q as Z,a8 as X,ao as ee,ap as te,Z as se,aq as ae,h as re,ar as ne,as as ie,r as le,A as oe,ah as ce,I as de,n as me,at as pe,ag as xe,M as ue,au as he,S as ge,av as fe,u as ve,af as ye,O as be,c as je,Y as Ne,aw as we,ax as De,ay as Se,g as Ce,W as ke,az as Ee,Q as Pe}from"./ui-vendor-Bx41JZPX.js";const Te=e=>{const{isActive:t,onEscape:s,autoFocus:a=!0,returnFocus:r=!0}=e,n=u.useRef(null),i=u.useRef(null),l=u.useCallback(()=>{if(!n.current)return[];const e=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(", "),t=n.current.querySelectorAll(e);return Array.from(t).filter(e=>null!==e.offsetParent&&!e.hasAttribute("hidden")&&"true"!==e.getAttribute("aria-hidden"))},[]),o=u.useCallback(e=>{const t=l();if(0===t.length)return;const s=t[0],a=t[t.length-1];e.shiftKey?document.activeElement===s&&(e.preventDefault(),a.focus()):document.activeElement===a&&(e.preventDefault(),s.focus())},[l]),c=u.useCallback(e=>{if(t)return"Escape"===e.key&&s?(e.preventDefault(),void s()):void("Tab"===e.key&&o(e))},[t,s,o]);return u.useEffect(()=>{if(t){if(i.current=document.activeElement,a){const e=l();e.length>0&&setTimeout(()=>{e[0].focus()},10)}return document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c),r&&i.current&&setTimeout(()=>{i.current?.focus()},10)}}},[t,a,r,l,c]),n},Ie=e=>({containerRef:Te({isActive:e.isOpen,onEscape:e.onClose,autoFocus:e.autoFocus,returnFocus:e.returnFocus}),ariaProps:{role:"dialog","aria-modal":!0,...e.titleId&&{"aria-labelledby":e.titleId},...e.descriptionId&&{"aria-describedby":e.descriptionId}}});var Fe,Ae,_e=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},Re=function(e){if("loading"===document.readyState)return"loading";var t=_e();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},Me=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},Le=function(e,t){var s="";try{for(;e&&9!==e.nodeType;){var a=e,r=a.id?"#"+a.id:Me(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(s.length+r.length>(t||100)-1)return s||r;if(s=s?r+">"+s:r,a.id)break;e=a.parentNode}}catch(e){}return s},Ue=-1,Oe=function(e){addEventListener("pageshow",function(t){t.persisted&&(Ue=t.timeStamp,e(t))},!0)},$e=function(){var e=_e();return e&&e.activationStart||0},We=function(e,t){var s=_e(),a="navigate";return Ue>=0?a="back-forward-cache":s&&(document.prerendering||$e()>0?a="prerender":document.wasDiscarded?a="restore":s.type&&(a=s.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},ze=function(e,t,s){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var a=new PerformanceObserver(function(e){Promise.resolve().then(function(){t(e.getEntries())})});return a.observe(Object.assign({type:e,buffered:!0},s||{})),a}}catch(e){}},Be=function(e,t,s,a){var r,n;return function(i){t.value>=0&&(i||a)&&((n=t.value-(r||0))||void 0===r)&&(r=t.value,t.delta=n,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,s),e(t))}},qe=function(e){requestAnimationFrame(function(){return requestAnimationFrame(function(){return e()})})},Ve=function(e){document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e()})},Ge=function(e){var t=!1;return function(){t||(e(),t=!0)}},He=-1,Ke=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},Ye=function(e){"hidden"===document.visibilityState&&He>-1&&(He="visibilitychange"===e.type?e.timeStamp:0,Qe())},Je=function(){addEventListener("visibilitychange",Ye,!0),addEventListener("prerenderingchange",Ye,!0)},Qe=function(){removeEventListener("visibilitychange",Ye,!0),removeEventListener("prerenderingchange",Ye,!0)},Ze=function(){return He<0&&(He=Ke(),Je(),Oe(function(){setTimeout(function(){He=Ke(),Je()},0)})),{get firstHiddenTime(){return He}}},Xe=function(e){document.prerendering?addEventListener("prerenderingchange",function(){return e()},!0):e()},et=[1800,3e3],tt=[.1,.25],st=function(e,t){!function(e,t){t=t||{},function(e,t){t=t||{},Xe(function(){var s,a=Ze(),r=We("FCP"),n=ze("paint",function(e){e.forEach(function(e){"first-contentful-paint"===e.name&&(n.disconnect(),e.startTime<a.firstHiddenTime&&(r.value=Math.max(e.startTime-$e(),0),r.entries.push(e),s(!0)))})});n&&(s=Be(e,r,et,t.reportAllChanges),Oe(function(a){r=We("FCP"),s=Be(e,r,et,t.reportAllChanges),qe(function(){r.value=performance.now()-a.timeStamp,s(!0)})}))})}(Ge(function(){var s,a=We("CLS",0),r=0,n=[],i=function(e){e.forEach(function(e){if(!e.hadRecentInput){var t=n[0],s=n[n.length-1];r&&e.startTime-s.startTime<1e3&&e.startTime-t.startTime<5e3?(r+=e.value,n.push(e)):(r=e.value,n=[e])}}),r>a.value&&(a.value=r,a.entries=n,s())},l=ze("layout-shift",i);l&&(s=Be(e,a,tt,t.reportAllChanges),Ve(function(){i(l.takeRecords()),s(!0)}),Oe(function(){r=0,a=We("CLS",0),s=Be(e,a,tt,t.reportAllChanges),qe(function(){return s()})}),setTimeout(s,0))}))}(function(t){var s=function(e){var t,s={};if(e.entries.length){var a=e.entries.reduce(function(e,t){return e&&e.value>t.value?e:t});if(a&&a.sources&&a.sources.length){var r=(t=a.sources).find(function(e){return e.node&&1===e.node.nodeType})||t[0];r&&(s={largestShiftTarget:Le(r.node),largestShiftTime:a.startTime,largestShiftValue:a.value,largestShiftSource:r,largestShiftEntry:a,loadState:Re(a.startTime)})}}return Object.assign(e,{attribution:s})}(t);e(s)},t)},at=0,rt=1/0,nt=0,it=function(e){e.forEach(function(e){e.interactionId&&(rt=Math.min(rt,e.interactionId),nt=Math.max(nt,e.interactionId),at=nt?(nt-rt)/7+1:0)})},lt=function(){return Fe?at:performance.interactionCount||0},ot=function(){"interactionCount"in performance||Fe||(Fe=ze("event",it,{type:"event",buffered:!0,durationThreshold:0}))},ct=[],dt=new Map,mt=0,pt=[],xt=function(e){if(pt.forEach(function(t){return t(e)}),e.interactionId||"first-input"===e.entryType){var t=ct[ct.length-1],s=dt.get(e.interactionId);if(s||ct.length<10||e.duration>t.latency){if(s)e.duration>s.latency?(s.entries=[e],s.latency=e.duration):e.duration===s.latency&&e.startTime===s.entries[0].startTime&&s.entries.push(e);else{var a={id:e.interactionId,latency:e.duration,entries:[e]};dt.set(a.id,a),ct.push(a)}ct.sort(function(e,t){return t.latency-e.latency}),ct.length>10&&ct.splice(10).forEach(function(e){return dt.delete(e.id)})}}},ut=function(e){var t=self.requestIdleCallback||self.setTimeout,s=-1;return e=Ge(e),"hidden"===document.visibilityState?e():(s=t(e),Ve(e)),s},ht=[200,500],gt=function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},Xe(function(){var s;ot();var a,r=We("INP"),n=function(e){ut(function(){e.forEach(xt);var t=function(){var e=Math.min(ct.length-1,Math.floor((lt()-mt)/50));return ct[e]}();t&&t.latency!==r.value&&(r.value=t.latency,r.entries=t.entries,a())})},i=ze("event",n,{durationThreshold:null!==(s=t.durationThreshold)&&void 0!==s?s:40});a=Be(e,r,ht,t.reportAllChanges),i&&(i.observe({type:"first-input",buffered:!0}),Ve(function(){n(i.takeRecords()),a(!0)}),Oe(function(){mt=lt(),ct.length=0,dt.clear(),r=We("INP"),a=Be(e,r,ht,t.reportAllChanges)}))}))},ft=[],vt=[],yt=0,bt=new WeakMap,jt=new Map,Nt=-1,wt=function(e){ft=ft.concat(e),Dt()},Dt=function(){Nt<0&&(Nt=ut(St))},St=function(){jt.size>10&&jt.forEach(function(e,t){dt.has(t)||jt.delete(t)});var e=ct.map(function(e){return bt.get(e.entries[0])}),t=vt.length-50;vt=vt.filter(function(s,a){return a>=t||e.includes(s)});for(var s=new Set,a=0;a<vt.length;a++){var r=vt[a];Ct(r.startTime,r.processingEnd).forEach(function(e){s.add(e)})}var n=ft.length-1-50;ft=ft.filter(function(e,t){return e.startTime>yt&&t>n||s.has(e)}),Nt=-1};pt.push(function(e){e.interactionId&&e.target&&!jt.has(e.interactionId)&&jt.set(e.interactionId,e.target)},function(e){var t,s=e.startTime+e.duration;yt=Math.max(yt,e.processingEnd);for(var a=vt.length-1;a>=0;a--){var r=vt[a];if(Math.abs(s-r.renderTime)<=8){(t=r).startTime=Math.min(e.startTime,t.startTime),t.processingStart=Math.min(e.processingStart,t.processingStart),t.processingEnd=Math.max(e.processingEnd,t.processingEnd),t.entries.push(e);break}}t||(t={startTime:e.startTime,processingStart:e.processingStart,processingEnd:e.processingEnd,renderTime:s,entries:[e]},vt.push(t)),(e.interactionId||"first-input"===e.entryType)&&bt.set(e,t),Dt()});var Ct=function(e,t){for(var s,a=[],r=0;s=ft[r];r++)if(!(s.startTime+s.duration<e)){if(s.startTime>t)break;a.push(s)}return a},kt=function(e,t){Ae||(Ae=ze("long-animation-frame",wt)),gt(function(t){var s=function(e){var t=e.entries[0],s=bt.get(t),a=t.processingStart,r=s.processingEnd,n=s.entries.sort(function(e,t){return e.processingStart-t.processingStart}),i=Ct(t.startTime,r),l=e.entries.find(function(e){return e.target}),o=l&&l.target||jt.get(t.interactionId),c=[t.startTime+t.duration,r].concat(i.map(function(e){return e.startTime+e.duration})),d=Math.max.apply(Math,c),m={interactionTarget:Le(o),interactionTargetElement:o,interactionType:t.name.startsWith("key")?"keyboard":"pointer",interactionTime:t.startTime,nextPaintTime:d,processedEventEntries:n,longAnimationFrameEntries:i,inputDelay:a-t.startTime,processingDuration:r-a,presentationDelay:Math.max(d-r,0),loadState:Re(t.startTime)};return Object.assign(e,{attribution:m})}(t);e(s)},t)},Et=[2500,4e3],Pt={},Tt=function(e,t){!function(e,t){t=t||{},Xe(function(){var s,a=Ze(),r=We("LCP"),n=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach(function(e){e.startTime<a.firstHiddenTime&&(r.value=Math.max(e.startTime-$e(),0),r.entries=[e],s())})},i=ze("largest-contentful-paint",n);if(i){s=Be(e,r,Et,t.reportAllChanges);var l=Ge(function(){Pt[r.id]||(n(i.takeRecords()),i.disconnect(),Pt[r.id]=!0,s(!0))});["keydown","click"].forEach(function(e){addEventListener(e,function(){return ut(l)},{once:!0,capture:!0})}),Ve(l),Oe(function(a){r=We("LCP"),s=Be(e,r,Et,t.reportAllChanges),qe(function(){r.value=performance.now()-a.timeStamp,Pt[r.id]=!0,s(!0)})})}})}(function(t){var s=function(e){var t={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:e.value};if(e.entries.length){var s=_e();if(s){var a=s.activationStart||0,r=e.entries[e.entries.length-1],n=r.url&&performance.getEntriesByType("resource").filter(function(e){return e.name===r.url})[0],i=Math.max(0,s.responseStart-a),l=Math.max(i,n?(n.requestStart||n.startTime)-a:0),o=Math.max(l,n?n.responseEnd-a:0),c=Math.max(o,r.startTime-a);t={element:Le(r.element),timeToFirstByte:i,resourceLoadDelay:l-i,resourceLoadDuration:o-l,elementRenderDelay:c-o,navigationEntry:s,lcpEntry:r},r.url&&(t.url=r.url),n&&(t.lcpResourceEntry=n)}}return Object.assign(e,{attribution:t})}(t);e(s)},t)};const It="@firebase/performance",Ft="0.7.7",At=Ft,_t="FB-PERF-TRACE-MEASURE",Rt="_wt_",Mt="_fcp",Lt="_fid",Ut="_lcp",Ot="_inp",$t="_cls",Wt="@firebase/performance/config",zt="@firebase/performance/configexpire",Bt="Performance",qt=new S("performance",Bt,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),Vt=new b(Bt);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Gt,Ht,Kt,Yt;Vt.logLevel=j.INFO;class Jt{constructor(e){if(this.window=e,!e)throw qt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=Tt,this.onINP=kt,this.onCLS=st}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,s){this.performance&&this.performance.measure&&this.performance.measure(e,t,s)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&k()?!!E()||(Vt.info("IndexedDB is not supported by current browser"),!1):(Vt.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(e=>{for(const s of e.getEntries())t(s)}).observe({entryTypes:[e]})}static getInstance(){return void 0===Gt&&(Gt=new Jt(Ht)),Gt}}function Qt(){return Kt}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Zt(e,t){const s=e.length-t.length;if(s<0||s>1)throw qt.create("invalid String merger input");const a=[];for(let r=0;r<e.length;r++)a.push(e.charAt(r)),t.length>r&&a.push(t.charAt(r));return a.join("")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Zt("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Zt("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===Yt&&(Yt=new Xt),Yt}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var es;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}(es||(es={}));const ts=["firebase_","google_","ga_"],ss=new RegExp("^[a-zA-Z]\\w*$");function as(){const e=Jt.getInstance().navigator;return(null==e?void 0:e.serviceWorker)?e.serviceWorker.controller?2:3:1}function rs(){switch(Jt.getInstance().document.visibilityState){case"visible":return es.VISIBLE;case"hidden":return es.HIDDEN;default:return es.UNKNOWN}}function ns(){const e=Jt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function is(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.appId;if(!s)throw qt.create("no app id");return s}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const ls="0.0.1",os={loggingEnabled:!0},cs="FIREBASE_INSTALLATIONS_AUTH";function ds(e,t){const s=function(){const e=Jt.getInstance().localStorage;if(!e)return;const t=e.getItem(zt);if(!(t&&(s=t,Number(s)>Date.now())))return;var s;const a=e.getItem(Wt);if(!a)return;try{return JSON.parse(a)}catch(r){return}}();return s?(ps(s),Promise.resolve()):function(e,t){return function(e){const t=e.getToken();return t.then(e=>{}),t}(e.installations).then(s=>{const a=function(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!s)throw qt.create("no project id");return s}(e.app),r=function(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!s)throw qt.create("no api key");return s}(e.app),n=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${r}`,{method:"POST",headers:{Authorization:`${cs} ${s}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:s,app_id:is(e.app),app_version:At,sdk_version:ls})});return fetch(n).then(e=>{if(e.ok)return e.json();throw qt.create("RC response not ok")})}).catch(()=>{Vt.info(ms)})}(e,t).then(ps).then(e=>function(e){const t=Jt.getInstance().localStorage;if(!e||!t)return;t.setItem(Wt,JSON.stringify(e)),t.setItem(zt,String(Date.now()+60*Xt.getInstance().configTimeToLive*60*1e3))}(e),()=>{})}const ms="Could not fetch config, will use default configs";function ps(e){if(!e)return e;const t=Xt.getInstance(),s=e.entries||{};return void 0!==s.fpr_enabled?t.loggingEnabled="true"===String(s.fpr_enabled):t.loggingEnabled=os.loggingEnabled,s.fpr_log_source?t.logSource=Number(s.fpr_log_source):os.logSource&&(t.logSource=os.logSource),s.fpr_log_endpoint_url?t.logEndPointUrl=s.fpr_log_endpoint_url:os.logEndPointUrl&&(t.logEndPointUrl=os.logEndPointUrl),s.fpr_log_transport_key?t.transportKey=s.fpr_log_transport_key:os.transportKey&&(t.transportKey=os.transportKey),void 0!==s.fpr_vc_network_request_sampling_rate?t.networkRequestsSamplingRate=Number(s.fpr_vc_network_request_sampling_rate):void 0!==os.networkRequestsSamplingRate&&(t.networkRequestsSamplingRate=os.networkRequestsSamplingRate),void 0!==s.fpr_vc_trace_sampling_rate?t.tracesSamplingRate=Number(s.fpr_vc_trace_sampling_rate):void 0!==os.tracesSamplingRate&&(t.tracesSamplingRate=os.tracesSamplingRate),t.logTraceAfterSampling=xs(t.tracesSamplingRate),t.logNetworkAfterSampling=xs(t.networkRequestsSamplingRate),e}function xs(e){return Math.random()<=e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let us,hs=1;function gs(e){return hs=2,us=us||function(e){return function(){const e=Jt.getInstance().document;return new Promise(t=>{if(e&&"complete"!==e.readyState){const s=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",s),t())};e.addEventListener("readystatechange",s)}else t()})}().then(()=>function(e){const t=e.getId();return t.then(e=>{Kt=e}),t}(e.installations)).then(t=>ds(e,t)).then(()=>fs(),()=>fs())}(e),us}function fs(){hs=3}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vs,ys=3,bs=[],js=!1;function Ns(e){setTimeout(()=>{ys<=0||(bs.length>0&&ws(),Ns(1e4))},e)}function ws(){const e=bs.splice(0,1e3),t=e.map(e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)}));(function(e){const t=Xt.getInstance().getFlTransportFullUrl(),s=JSON.stringify(e);return navigator.sendBeacon&&navigator.sendBeacon(t,s)?Promise.resolve():fetch(t,{method:"POST",body:s,keepalive:!0}).then()})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Xt.getInstance().logSource,log_event:t}).then(()=>{ys=3}).catch(()=>{bs=[...e,...bs],ys--,Vt.info(`Tries left: ${ys}.`),Ns(1e4)})}function Ds(e){return(...t)=>{!function(e){if(!e.eventTime||!e.message)throw qt.create("invalid cc log");bs=[...bs,e]}({message:e(...t),eventTime:Date.now()})}}function Ss(){for(;bs.length>0;)ws()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(e,t){vs||(vs={send:Ds(Ps),flush:Ss}),vs.send(e,t)}function ks(e){const t=Xt.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&Jt.getInstance().requiredApisAvailable()&&(3===hs?Es(e):gs(e.performanceController).then(()=>Es(e),()=>Es(e)))}function Es(e){if(!Qt())return;const t=Xt.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&Cs(e,1)}function Ps(e,t){return 0===t?function(e){const t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},s={application_info:Ts(e.performanceController.app),network_request_metric:t};return JSON.stringify(s)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);const s=e.getAttributes();0!==Object.keys(s).length&&(t.custom_attributes=s);const a={application_info:Ts(e.performanceController.app),trace_metric:t};return JSON.stringify(a)}(e)}function Ts(e){return{google_app_id:is(e),app_instance_id:Qt(),web_app_info:{sdk_version:At,page_url:Jt.getInstance().getUrl(),service_worker_status:as(),visibility_state:rs(),effective_connection_type:ns()},application_process_state:0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(e,t){const s=t;if(!s||void 0===s.responseStart)return;const a=Jt.getInstance().getTimeOrigin(),r=Math.floor(1e3*(s.startTime+a)),n=s.responseStart?Math.floor(1e3*(s.responseStart-s.startTime)):void 0,i=Math.floor(1e3*(s.responseEnd-s.startTime));!function(e){const t=Xt.getInstance();if(!t.instrumentationEnabled)return;const s=e.url,a=t.logEndPointUrl.split("?")[0],r=t.flTransportEndpointUrl.split("?")[0];s!==a&&s!==r&&t.loggingEnabled&&t.logNetworkAfterSampling&&Cs(e,0)}({performanceController:e,url:s.name&&s.name.split("?")[0],responsePayloadBytes:s.transferSize,startTimeUs:r,timeToResponseInitiatedUs:n,timeToResponseCompletedUs:i})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs=["_fp",Mt,Lt,Ut,$t,Ot];
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class As{constructor(e,t,s=!1,a){this.performanceController=e,this.name=t,this.isAuto=s,this.state=1,this.customAttributes={},this.counters={},this.api=Jt.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=a||`${_t}-${this.randomId}-${this.name}`,a&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw qt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw qt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ks(this)}record(e,t,s){if(e<=0)throw qt.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw qt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),s&&s.attributes&&(this.customAttributes=Object.assign({},s.attributes)),s&&s.metrics)for(const a of Object.keys(s.metrics))isNaN(Number(s.metrics[a]))||(this.counters[a]=Math.floor(Number(s.metrics[a])));ks(this)}incrementMetric(e,t=1){void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(!function(e,t){return!(0===e.length||e.length>100)&&(t&&t.startsWith(Rt)&&Fs.indexOf(e)>-1||!e.startsWith("_"))}(e,this.name))throw qt.create("invalid custom metric name",{customMetricName:e});this.counters[e]=function(e){const t=Math.floor(e);return t<e&&Vt.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}(null!=t?t:0)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const s=function(e){return!(0===e.length||e.length>40)&&(!ts.some(t=>e.startsWith(t))&&!!e.match(ss))}(e),a=function(e){return 0!==e.length&&e.length<=100}(t);if(s&&a)this.customAttributes[e]=t;else{if(!s)throw qt.create("invalid attribute name",{attributeName:e});if(!a)throw qt.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,s,a,r){const n=Jt.getInstance().getUrl();if(!n)return;const i=new As(e,Rt+n,!0),l=Math.floor(1e3*Jt.getInstance().getTimeOrigin());i.setStartTime(l),t&&t[0]&&(i.setDuration(Math.floor(1e3*t[0].duration)),i.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),i.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),i.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(s){const e=s.find(e=>"first-paint"===e.name);e&&e.startTime&&i.putMetric("_fp",Math.floor(1e3*e.startTime));const t=s.find(e=>"first-contentful-paint"===e.name);t&&t.startTime&&i.putMetric(Mt,Math.floor(1e3*t.startTime)),r&&i.putMetric(Lt,Math.floor(1e3*r))}this.addWebVitalMetric(i,Ut,"lcp_element",a.lcp),this.addWebVitalMetric(i,$t,"cls_largestShiftTarget",a.cls),this.addWebVitalMetric(i,Ot,"inp_interactionTarget",a.inp),ks(i),vs&&vs.flush()}static addWebVitalMetric(e,t,s,a){a&&(e.putMetric(t,Math.floor(1e3*a.value)),a.elementAttribution&&e.putAttribute(s,a.elementAttribution))}static createUserTimingTrace(e,t){ks(new As(e,t,!1,t))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _s,Rs={},Ms=!1;function Ls(e){Qt()&&(setTimeout(()=>function(e){const t=Jt.getInstance();"onpagehide"in window?t.document.addEventListener("pagehide",()=>Os(e)):t.document.addEventListener("unload",()=>Os(e));t.document.addEventListener("visibilitychange",()=>{"hidden"===t.document.visibilityState&&Os(e)}),t.onFirstInputDelay&&t.onFirstInputDelay(e=>{_s=e});t.onLCP(e=>{var t;Rs.lcp={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.element}}),t.onCLS(e=>{var t;Rs.cls={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.largestShiftTarget}}),t.onINP(e=>{var t;Rs.inp={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.interactionTarget}})}(e),0),setTimeout(()=>function(e){const t=Jt.getInstance(),s=t.getEntriesByType("resource");for(const a of s)Is(e,a);t.setupObserver("resource",t=>Is(e,t))}(e),0),setTimeout(()=>function(e){const t=Jt.getInstance(),s=t.getEntriesByType("measure");for(const a of s)Us(e,a);t.setupObserver("measure",t=>Us(e,t))}(e),0))}function Us(e,t){const s=t.name;s.substring(0,21)!==_t&&As.createUserTimingTrace(e,s)}function Os(e){if(!Ms){Ms=!0;const t=Jt.getInstance(),s=t.getEntriesByType("navigation"),a=t.getEntriesByType("paint");setTimeout(()=>{As.createOobTrace(e,s,a,Rs,_s)},0)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),Jt.getInstance().requiredApisAvailable()?C().then(e=>{e&&(js||(Ns(5500),js=!0),gs(this).then(()=>Ls(this),()=>Ls(this)),this.initialized=!0)}).catch(e=>{Vt.info(`Environment doesn't support IndexedDB: ${e}`)}):Vt.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Xt.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Xt.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Xt.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Xt.getInstance().dataCollectionEnabled}}const Ws=(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();if("[DEFAULT]"!==s.name)throw qt.create("FB not default");if("undefined"==typeof window)throw qt.create("no window");!function(e){Ht=e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(window);const r=new $s(s,a);return r._init(t),r};N(new w("performance",Ws,"PUBLIC")),D(It,Ft),D(It,Ft,"esm2017");let zs=null,Bs=!1;function qs(){try{zs=function(e=P()){return e=T(e),I(e,"performance").getImmediate()}(e),Bs=!0,t.debug("ðŸ“Š [PERFORMANCE] Monitoring initialized")}catch(s){t.error("âŒ [PERFORMANCE] Failed to initialize:",s)}}function Vs(e){return Bs&&zs?function(e,t){return e=T(e),new As(e,t)}(zs,e):{start:()=>{},stop:()=>{},putAttribute:()=>{},putMetric:()=>{},incrementMetric:()=>{},getAttribute:()=>null,getMetric:()=>0}}const Gs="generate_warning_pdf";class Hs{static async saveTemplateVersion(e,a,r,n){try{const i=F(s,"organizations",e,"pdfTemplateVersions",a);if((await A(i)).exists())return void t.debug(`ðŸ“‹ Template version ${a} already exists for ${e}`);const l={version:a,settings:r,activatedAt:new Date,activatedBy:n.activatedBy,reason:n.reason||"Template version saved",...n.previousVersion?{previousVersion:n.previousVersion}:{}};await _(i,l),t.info(`âœ… Saved template version ${a} for organization ${e}`)}catch(i){throw t.error("Failed to save template version:",i),new Error("Failed to save PDF template version")}}static async getTemplateVersion(e,a){try{const r=F(s,"organizations",e,"pdfTemplateVersions",a),n=await A(r);return n.exists()?n.data():(t.warn(`âš ï¸ Template version ${a} not found for ${e}`),null)}catch(r){throw t.error(`Failed to retrieve template version ${a}:`,r),new Error("Failed to retrieve PDF template version")}}static async getCurrentTemplateVersion(e){try{const a=F(s,"organizations",e),r=await A(a);if(!r.exists())return t.error(`Organization ${e} not found`),null;const n=r.data(),i=n.pdfSettings?.generatorVersion;return i?this.getTemplateVersion(e,i):(t.warn(`No current template version found for ${e}`),null)}catch(a){throw t.error("Failed to get current template version:",a),new Error("Failed to retrieve current PDF template version")}}static async ensureTemplateVersionExists(e,t,s){const a=t.generatorVersion||"1.0.0";return await this.saveTemplateVersion(e,a,t,{activatedBy:s,reason:"Template version saved during warning creation"}),a}static async getAllTemplateVersions(e){try{const t=R(s,"organizations",e,"pdfTemplateVersions"),a=M(t,L("activatedAt","desc"));return(await U(a)).docs.map(e=>e.data())}catch(a){throw t.error("Failed to get all template versions:",a),new Error("Failed to retrieve PDF template versions")}}}const Ks=e=>{if(!e)return t.warn("âš ï¸ Null timestamp provided to convertFirestoreTimestamp, using current date"),new Date;if(void 0!==e.seconds)return new Date(1e3*e.seconds);if(void 0!==e._seconds)return new Date(1e3*e._seconds);if(e instanceof Date)return e;if("string"==typeof e||"number"==typeof e){const t=new Date(e);if(!isNaN(t.getTime()))return t}return t.warn("âš ï¸ Invalid timestamp format, using current date:",e),new Date},Ys=e=>{if(!e)return e;if(Array.isArray(e))return e.map(e=>Ys(e));if("object"==typeof e&&!(e instanceof Date)){if(void 0!==e.seconds||void 0!==e._seconds)return Ks(e);const t={};for(const s in e)e.hasOwnProperty(s)&&(t[s]=Ys(e[s]));return t}return e},Js=e=>e?e.profile||e.employment?{firstName:e.profile?.firstName||e.firstName||"Unknown",lastName:e.profile?.lastName||e.lastName||"Employee",employeeNumber:e.employment?.employeeNumber||e.employeeNumber||e.id||"N/A",department:e.employment?.department||e.profile?.department||e.department||"Unknown",position:e.employment?.position||e.position||"Unknown",email:e.profile?.email||e.email||"",phone:e.profile?.phoneNumber||e.profile?.phone||e.phone||""}:{firstName:e.firstName||"Unknown",lastName:e.lastName||"Employee",employeeNumber:e.employeeNumber||e.employeeId||e.id||"N/A",department:e.department||"Unknown",position:e.position||"Unknown",email:e.email||"",phone:e.phone||e.phoneNumber||""}:(t.warn("âš ï¸ Null employee provided to flattenEmployeeData"),{firstName:"Unknown",lastName:"Employee",employeeNumber:"N/A",department:"Unknown",position:"Unknown"}),Qs=async(e,s,a)=>{if(t.debug("ðŸ”’ Transforming warning data for PDF generation..."),!e)throw new Error("Cannot transform null warning data for PDF");if(!a)throw new Error("Cannot transform warning data without organization data");const r=Js(s),n=Ks(e.issueDate||e.issuedDate||e.createdAt),i=Ks(e.incidentDate||e.issueDate||e.createdAt);let l;if(e.pdfTemplateVersion&&a.id)try{const s=await Hs.getTemplateVersion(a.id,e.pdfTemplateVersion);s?(l=s.settings,t.debug(`âœ… Fetched template version ${e.pdfTemplateVersion} from collection`)):(t.warn(`âš ï¸ Template version ${e.pdfTemplateVersion} not found, using current org settings`),l=a.pdfSettings)}catch(c){t.error("âŒ Failed to fetch template version:",c),l=a.pdfSettings}else l=e.pdfSettings||a.pdfSettings||void 0,e.pdfSettings?t.debug("ðŸ“‹ Using legacy pdfSettings from warning document (old format)"):a.pdfSettings?t.debug("ðŸ“‹ Using pdfSettings from organization:",{hasSettings:!0,version:a.pdfSettings.generatorVersion,hasContent:!!a.pdfSettings.content,hasBranding:!!a.pdfSettings.branding}):t.warn("âš ï¸ No pdfSettings found in warning or organization data - will use defaults");const o={warningId:e.id||e.warningId||`WRN_${Date.now()}`,organizationId:e.organizationId||a.id,status:e.status||"issued",pdfGeneratorVersion:e.pdfGeneratorVersion||h,pdfSettings:l,issuedByName:e.signatures?.managerName||e.issuedByName||"",issuedDate:n,incidentDate:i,employee:r,warningLevel:e.level||e.warningLevel||"counselling",category:e.category||e.categoryName||"General Misconduct",description:e.description||e.incidentDescription||"",incidentTime:e.incidentTime||"09:00",incidentLocation:e.incidentLocation||"",organization:a,signatures:e.signatures||{},additionalNotes:e.additionalNotes||"",validityPeriod:e.validityPeriod||6,disciplineRecommendation:(()=>{const t=e.disciplineRecommendation||e.lraRecommendation;return Ys(t)})(),legalCompliance:e.legalCompliance,deliveryChoice:e.deliveryChoice,appealDetails:e.appealDetails,appealOutcome:e.appealOutcome,appealDecisionDate:e.appealDecisionDate?Ks(e.appealDecisionDate):void 0,appealReasoning:e.appealReasoning,hrNotes:e.hrNotes,followUpRequired:e.followUpRequired,followUpDate:e.followUpDate?Ks(e.followUpDate):void 0,employeeStatement:e.employeeStatement||void 0,expectedBehaviorStandards:e.expectedBehaviorStandards||void 0,factsLeadingToDecision:e.factsLeadingToDecision||void 0,improvementCommitments:(()=>{const t=e.improvementCommitments||e.actionSteps;if(t&&Array.isArray(t))return t.map(e=>({commitment:e.commitment||e.action||"",timeline:e.timeline||"",completedDate:e.completedDate?Ks(e.completedDate):void 0}))})(),reviewDate:e.reviewDate?Ks(e.reviewDate):void 0,interventionDetails:e.interventionDetails||void 0,resourcesProvided:e.resourcesProvided||void 0,trainingProvided:e.trainingProvided||void 0};return t.debug("âœ… PDF data transformation complete:",{warningId:o.warningId,pdfGeneratorVersion:o.pdfGeneratorVersion,employee:`${o.employee.firstName} ${o.employee.lastName}`,warningLevel:o.warningLevel}),o},Zs=Object.freeze(Object.defineProperty({__proto__:null,convertAllTimestamps:Ys,convertFirestoreTimestamp:Ks,flattenEmployeeData:Js,transformWarningDataForPDF:Qs},Symbol.toStringTag,{value:"Module"})),Xs=({isOpen:e,onClose:s,warningData:n,deliveryChoice:i,onPDFGenerated:l,showPreview:o=!0,title:c="Warning Document"})=>{const{organization:d}=a();g(e);const[m,p]=u.useState(null),[x,h]=u.useState(null),[v,b]=u.useState(""),[j,N]=u.useState(!1),[w,D]=u.useState(null),[S,C]=u.useState(""),[k,E]=u.useState(!1);u.useEffect(()=>{const e=()=>E(window.innerWidth<768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const P=u.useMemo(()=>{if(!n||!d)return null;const e=n.wizardState||n,t=e.selectedEmployee||n.selectedEmployee||n.employee,s=e.selectedCategory||n.selectedCategory,a=e.formData||n.formData||{};return{wizardState:e,selectedEmployee:t,selectedCategory:s,formData:a,signatures:e.signatures||n.signatures||{},lraRecommendation:e.lraRecommendation||n.lraRecommendation,employee:{firstName:t?.profile?.firstName||t?.firstName||"Unknown",lastName:t?.profile?.lastName||t?.lastName||"Employee"},category:s?.name||a.category||"General Misconduct",description:a.incidentDescription||a.description||"",incidentLocation:a.incidentLocation||"",additionalNotes:a.additionalNotes||"",isComplete:!(!t||!s||!a.incidentDescription&&!a.description)}},[n,i,d]),T=u.useMemo(()=>{if(!P)return"Warning_Document.pdf";const e=`${P.employee.firstName}_${P.employee.lastName}`,t=(new Date).toISOString().split("T")[0];return`Warning_${(P.category||"Warning").replace(/\s+/g,"_").substring(0,20)}_${e}_${t}.pdf`},[P]),I=u.useCallback(async()=>{if(!P||!d)return void D("Missing required data for PDF generation");if(!(P.description||P.incidentLocation||P.additionalNotes))return void D("Insufficient incident data. Please complete the form first.");N(!0),D(null);const e=["Preparing document...","Applying branding...","Formatting content...","Finalizing PDF..."];try{for(let t=0;t<e.length;t++)C(e[t]),await new Promise(e=>setTimeout(e,400));const s={id:P.formData.id||P.formData.warningId||`WRN_${Date.now()}`,organizationId:P.wizardState.organizationId||n.organizationId,level:P.formData.level||P.lraRecommendation?.suggestedLevel||"counselling",category:P.selectedCategory?.name||P.formData.category||"General Misconduct",description:P.formData.incidentDescription||P.formData.description||"",incidentDate:P.formData.incidentDate,incidentTime:P.formData.incidentTime||"09:00",incidentLocation:P.formData.incidentLocation||"",issueDate:P.formData.issueDate||P.formData.issuedDate,validityPeriod:P.formData.validityPeriod||6,signatures:P.signatures,additionalNotes:P.formData.additionalNotes||"",status:P.formData.status,disciplineRecommendation:P.lraRecommendation,pdfTemplateVersion:P.formData.pdfTemplateVersion||n.pdfTemplateVersion,pdfGeneratorVersion:P.formData.pdfGeneratorVersion||n.pdfGeneratorVersion,legalCompliance:{isCompliant:!0,framework:"LRA Section 188",requirements:P.lraRecommendation?.legalRequirements||[]},deliveryChoice:i?{method:i.method,timestamp:new Date,chosenBy:"Manager",contactDetails:i.contactDetails}:void 0,employeeStatement:P.formData.employeeStatement||n.employeeStatement,expectedBehaviorStandards:P.formData.expectedBehaviorStandards||n.expectedBehaviorStandards,factsLeadingToDecision:P.formData.factsLeadingToDecision||n.factsLeadingToDecision,actionSteps:P.formData.actionSteps||n.actionSteps,reviewDate:P.formData.reviewDate||n.reviewDate,interventionDetails:P.formData.interventionDetails||n.interventionDetails,resourcesProvided:P.formData.resourcesProvided||n.resourcesProvided},a=await Qs(s,P.selectedEmployee,d),{PDFGenerationService:r}=await y(async()=>{const{PDFGenerationService:e}=await import("./dashboard-router-CsxAXVhx.js").then(e=>e.d);return{PDFGenerationService:e}},__vite__mapDeps([0,1,2,3,4,5,6,7])),o=await async function(e,t,s){const a=Vs(e);try{a.start(),s&&Object.entries(s).forEach(([e,t])=>{a.putAttribute(e,t)});const e=await t();return a.stop(),e}catch(w){throw a.putAttribute("error","true"),a.stop(),w}}(Gs,()=>r.generateWarningPDF(a,a.pdfGeneratorVersion,a.pdfSettings),{employee:`${a.employee.firstName} ${a.employee.lastName}`,category:a.category,pdfGeneratorVersion:a.pdfGeneratorVersion});p(o),b(T);const c=URL.createObjectURL(o);h(c),t.success("âœ… PDF generated:",{employee:`${a.employee.firstName} ${a.employee.lastName}`,size:`${(o.size/1024).toFixed(1)} KB`}),l&&await l(o,T)}catch(s){t.error("âŒ PDF generation failed:",s),D(`Failed to generate PDF: ${s instanceof Error?s.message:"Unknown error"}`)}finally{N(!1),C("")}},[P,d,T,i,l,n]);u.useCallback(()=>{if(!m||!v)return;const e=URL.createObjectURL(m),s=document.createElement("a");s.href=e,s.download=v,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(e),t.success("ðŸ“¥ PDF downloaded successfully")},[m,v]);const F=u.useCallback(()=>{x&&window.open(x,"_blank")},[x]),A=u.useRef(!1);return u.useEffect(()=>{e&&P&&P.isComplete&&!m&&!j&&!A.current&&(A.current=!0,I()),e||(A.current=!1)},[e,P,m,j,I]),u.useEffect(()=>{e&&window.scrollTo({top:0,behavior:"smooth"})},[e]),u.useEffect(()=>()=>{x&&URL.revokeObjectURL(x)},[x]),e?k?r.jsx(r.Fragment,{children:r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",style:{zIndex:f.modal},onClick:s,children:r.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[r.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between flex-shrink-0",children:[r.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:c}),r.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(z,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[w&&r.jsxs("div",{className:"bg-red-50 border-l-4 border-red-400 p-3 rounded-r-lg",children:[r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(B,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),r.jsx("p",{className:"text-sm text-red-700 mt-1",children:w})]})]}),r.jsxs("button",{onClick:I,className:"mt-2 text-sm text-red-700 hover:text-red-900 font-medium flex items-center gap-1",children:[r.jsx(q,{className:"w-4 h-4"}),"Retry"]})]}),j&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(V,{className:"w-6 h-6 text-blue-600 animate-spin"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-blue-800 font-medium",children:"Generating PDF"}),S&&r.jsx("p",{className:"text-blue-600 text-sm",children:S})]})]})}),P&&!P.isComplete&&!j&&r.jsxs("div",{className:"bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(B,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-sm font-semibold text-amber-800 mb-2",children:"Incomplete Warning Data"}),r.jsxs("div",{className:"text-sm text-amber-700 space-y-1",children:[!P.hasEmployee&&r.jsx("p",{children:"â€¢ Employee not selected"}),!P.hasCategory&&r.jsx("p",{children:"â€¢ Category not selected"}),!P.description&&r.jsx("p",{children:"â€¢ Incident description missing"})]}),r.jsx("p",{className:"text-sm text-amber-800 mt-3 font-medium",children:"Please complete the warning wizard before generating the PDF."})]})]}),r.jsx("button",{onClick:s,className:"mt-3 w-full bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors font-medium",children:"Return to Wizard"})]}),m&&!j&&P&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center flex-shrink-0",children:r.jsx(G,{className:"w-5 h-5 text-green-600"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("h3",{className:"font-semibold text-gray-900 text-base mb-1",children:[P.employee.firstName," ",P.employee.lastName]}),r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:P.category}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[r.jsx(G,{className:"w-3 h-3"}),r.jsx("span",{className:"truncate",children:v})]}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(m.size/1024).toFixed(1)," KB"]})]}),r.jsx(H,{className:"w-6 h-6 text-green-600 flex-shrink-0"})]})}),r.jsx("div",{className:"space-y-3",children:r.jsxs("button",{onClick:F,className:"w-full flex items-center justify-center gap-2 bg-white text-gray-700 border border-gray-300 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors font-medium",style:{minHeight:"48px"},children:[r.jsx(K,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm",children:"Open in New Tab"})]})})]}),!P&&!j&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx(G,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Data Available"}),r.jsx("p",{className:"text-gray-500 mb-4",children:"Complete the warning wizard first."}),r.jsx("button",{onClick:s,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Return to Wizard"})]})]})]})})}):r.jsx(r.Fragment,{children:r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",style:{zIndex:f.modal},children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full h-[90vh] overflow-hidden flex",children:[r.jsxs("div",{className:"w-80 border-r border-gray-200 flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center",children:r.jsx(Y,{className:"w-5 h-5 text-white"})}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:c})]}),P&&r.jsxs("div",{className:"mt-3",children:[r.jsxs("p",{className:"font-medium text-gray-900 text-base",children:[P.employee.firstName," ",P.employee.lastName]}),r.jsx("p",{className:"text-sm text-gray-600",children:P.category})]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[w&&r.jsxs("div",{className:"bg-red-50 border-l-4 border-red-400 p-3 rounded-r-lg",children:[r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(B,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),r.jsx("p",{className:"text-xs text-red-700 mt-1",children:w})]})]}),r.jsxs("button",{onClick:I,className:"mt-2 text-sm text-red-700 hover:text-red-900 font-medium flex items-center gap-1",children:[r.jsx(q,{className:"w-4 h-4"}),"Retry"]})]}),j&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(V,{className:"w-5 h-5 text-blue-600 animate-spin flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-blue-800 font-medium text-sm",children:"Generating PDF"}),S&&r.jsx("p",{className:"text-blue-600 text-xs mt-1",children:S})]})]})}),P&&!P.isComplete&&!j&&r.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-400 p-3 rounded-r-lg",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(B,{className:"w-5 h-5 text-amber-400 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-sm font-semibold text-amber-800 mb-2",children:"Incomplete Data"}),r.jsxs("div",{className:"text-xs text-amber-700 space-y-1",children:[!P.hasEmployee&&r.jsx("p",{children:"â€¢ No employee selected"}),!P.hasCategory&&r.jsx("p",{children:"â€¢ No category selected"}),!P.description&&r.jsx("p",{children:"â€¢ No incident description"})]}),r.jsx("p",{className:"text-xs text-amber-800 mt-2 font-medium",children:"Complete the wizard first."})]})]})}),m&&!j&&r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(H,{className:"w-5 h-5 text-green-600"}),r.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Ready to Download"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-xs text-gray-600 truncate",title:v,children:v}),r.jsxs("p",{className:"text-xs text-gray-500",children:[(m.size/1024).toFixed(1)," KB"]})]})]}),m&&!j&&r.jsx("div",{className:"space-y-3 pt-2",children:r.jsxs("button",{onClick:F,className:"w-full flex items-center justify-center gap-2 bg-white text-gray-700 border border-gray-300 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:[r.jsx(K,{className:"w-4 h-4"}),r.jsx("span",{children:"Open in New Tab"})]})})]}),r.jsx("div",{className:"p-6 border-t border-gray-200",children:r.jsx("button",{onClick:s,className:"w-full px-4 py-2 text-gray-600 hover:text-gray-800 font-medium transition-colors",children:"Close"})})]}),r.jsxs("div",{className:"flex-1 bg-gray-50 flex flex-col",children:[r.jsx("div",{className:"p-4 flex justify-end",children:r.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(z,{className:"w-5 h-5"})})}),r.jsx("div",{className:"flex-1 p-6 pt-0",children:x&&o?r.jsx("div",{className:"h-full bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:r.jsx("iframe",{src:x,className:"w-full h-full border-0",title:"PDF Preview"})}):j?r.jsx("div",{className:"h-full flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(V,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Generating preview..."})]})}):r.jsx("div",{className:"h-full flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(G,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-500",children:"No preview available"})]})})})]})]})})}):null},ea={email:{icon:Z,name:"Email",color:"blue",requiresProof:!0,instructions:["Send the warning document via email","Take a screenshot of the sent email","Include timestamp and recipient email visible","Upload the screenshot as proof of delivery"],screenshotTips:["Windows: Press Ctrl + Shift + S","Mac: Press Cmd + Shift + 4","Chrome: Press Ctrl + Shift + Alt + 3"]},whatsapp:{icon:Q,name:"WhatsApp Business",color:"green",requiresProof:!0,instructions:["Send the warning document via WhatsApp Business","Wait for delivery confirmation (double blue ticks)","Take a screenshot showing the sent message","Include timestamp and delivery status visible","Upload the screenshot as proof of delivery"],screenshotTips:["Windows: Press Ctrl + Shift + S","Mac: Press Cmd + Shift + 4","Phone: Use screenshot function (varies by device)"]},printed:{icon:J,name:"Print & Hand Delivery",color:"purple",requiresProof:!1,instructions:["Print the warning document","Hand deliver to the employee","Get employee acknowledgment signature on physical copy","File the signed copy in employee records","Confirm delivery completion below"]}},ta=({isOpen:e,onClose:s,warningId:n,employeeName:i,employeeEmail:l,deliveryMethod:o,warningData:c,onDeliveryConfirmed:d})=>{const{organization:m}=a(),[p,x]=u.useState(null),[h,v]=u.useState(null),[b,j]=u.useState(!1),[N,w]=u.useState(!1),[D,S]=u.useState(null),[C,k]=u.useState(!1),E=u.useRef(null);g(e);const P=ea[o],T=`Warning Notice - ${c?.category||"Disciplinary Action"}`,I=`Dear ${i},\n\nPlease find attached your formal warning notice regarding ${c?.category||"the recent incident"}.\n\nThis document outlines:\n- The incident details and circumstances\n- The warning level issued\n- Your rights and the next steps\n- The validity period of this warning\n\nPlease review the attached PDF carefully. If you have any questions or wish to discuss this matter, please contact your HR department.\n\nThis is an official HR document and should be kept for your records.\n\nBest regards,\n${m?.companyName||"HR Department"}`,F=l?`mailto:${l}?subject=${encodeURIComponent(T)}&body=${encodeURIComponent(I)}`:"#",A=u.useCallback(e=>{const t=e.target.files?.[0];if(!t)return;if(!t.type.startsWith("image/"))return void S("Please select an image file (PNG, JPG, etc.)");if(t.size>5242880)return void S("Image must be less than 5MB");S(null),x(t);const s=new FileReader;s.onload=e=>{v(e.target?.result)},s.readAsDataURL(t)},[]),_=u.useCallback(e=>{e.preventDefault(),e.stopPropagation()},[]),R=u.useCallback(e=>{e.preventDefault(),e.stopPropagation();const t=e.dataTransfer.files;if(t.length>0){const e=t[0];if(e.type.startsWith("image/")){A({target:{files:[e]}})}}},[A]),M=u.useCallback(async()=>{if(!P.requiresProof||p){j(!0),S(null);try{await d({warningId:n,deliveryMethod:o,deliveredAt:new Date,proofImage:p||void 0})}catch(e){S(e instanceof Error?e.message:"Failed to confirm delivery")}finally{j(!1)}}else S("Please upload proof of delivery screenshot")},[P.requiresProof,p,d,n,o]),L=u.useCallback(()=>{x(null),v(null),E.current&&(E.current.value="")},[]),U=u.useCallback(async()=>{try{await navigator.clipboard.writeText(I),k(!0),setTimeout(()=>k(!1),2e3)}catch(e){t.error("Failed to copy to clipboard:",e)}},[I]),O=u.useCallback(async()=>{if(c&&m){w(!0),S(null);try{const e={firstName:c.employeeName?.split(" ")[0]||"Unknown",lastName:c.employeeName?.split(" ").slice(1).join(" ")||"Employee",employeeNumber:c.employeeNumber||"N/A",department:c.department||"Unknown",position:c.position||"Unknown",email:l||""},s=Qs(c,e,m);t.debug("ðŸ“„ Generating PDF with unified transformer data:",{warningId:s.warningId,employee:`${s.employee.firstName} ${s.employee.lastName}`,category:s.category,pdfGeneratorVersion:s.pdfGeneratorVersion});const{PDFGenerationService:a}=await y(async()=>{const{PDFGenerationService:e}=await import("./dashboard-router-CsxAXVhx.js").then(e=>e.d);return{PDFGenerationService:e}},__vite__mapDeps([0,1,2,3,4,5,6,7])),r=await a.generateWarningPDF(s,s.pdfGeneratorVersion,s.pdfSettings),n=(new Date).toISOString().split("T")[0],o=`Warning_${(c.category||"Document").replace(/\s+/g,"_")}_${i.replace(/\s+/g,"_")}_${n}.pdf`,d=URL.createObjectURL(r),p=document.createElement("a");p.href=d,p.download=o,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(d),t.success("âœ… PDF downloaded:",o)}catch(e){t.error("âŒ PDF download failed:",e),S(e instanceof Error?e.message:"Failed to download PDF")}finally{w(!1)}}else S("Missing warning data or organization information")},[c,m,n,i,l]);if(!e)return null;const $=P.icon;return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:f.modalNested1},children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[r.jsx("div",{className:`bg-gradient-to-r from-${P.color}-600 to-${P.color}-700 p-6 text-white`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"bg-white/20 p-3 rounded-xl",children:r.jsx($,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold",children:"Confirm Delivery"}),r.jsxs("p",{className:"text-sm opacity-90",children:[P.name," delivery for ",i]})]})]}),r.jsx("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:r.jsx(z,{className:"w-5 h-5"})})]})}),r.jsxs("div",{className:"p-6 max-h-[calc(90vh-140px)] overflow-y-auto",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"ðŸ“‹ Step-by-Step Instructions"}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("ol",{className:"space-y-2",children:[r.jsxs("li",{className:"flex items-start gap-3 text-sm",children:[r.jsx("span",{className:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-medium flex-shrink-0 mt-0.5",children:"1"}),r.jsx("span",{className:"text-gray-700",children:"Download the warning PDF document using the button below"})]}),r.jsxs("li",{className:"flex items-start gap-3 text-sm",children:[r.jsx("span",{className:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-medium flex-shrink-0 mt-0.5",children:"2"}),r.jsx("span",{className:"text-gray-700",children:"Copy the email message text below"})]}),r.jsxs("li",{className:"flex items-start gap-3 text-sm",children:[r.jsx("span",{className:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-medium flex-shrink-0 mt-0.5",children:"3"}),r.jsx("span",{className:"text-gray-700",children:'Click "Open Email" to launch your email client with pre-filled message'})]}),r.jsxs("li",{className:"flex items-start gap-3 text-sm",children:[r.jsx("span",{className:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-medium flex-shrink-0 mt-0.5",children:"4"}),r.jsx("span",{className:"text-gray-700",children:"Attach the downloaded PDF to your email and send"})]}),r.jsxs("li",{className:"flex items-start gap-3 text-sm",children:[r.jsx("span",{className:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-medium flex-shrink-0 mt-0.5",children:"5"}),r.jsx("span",{className:"text-gray-700",children:"Take a screenshot of the sent email (timestamp and recipient visible)"})]}),r.jsxs("li",{className:"flex items-start gap-3 text-sm",children:[r.jsx("span",{className:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-medium flex-shrink-0 mt-0.5",children:"6"}),r.jsx("span",{className:"text-gray-700",children:"Upload the screenshot as proof of delivery below"})]})]})})]}),"email"===o&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-6",children:[r.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(X,{className:"w-4 h-4 text-blue-600"}),"Step 1: Download Warning PDF"]}),r.jsx("button",{onClick:O,disabled:N,className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:N?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"w-5 h-5 animate-spin"}),"Generating PDF..."]}):r.jsxs(r.Fragment,{children:[r.jsx(X,{className:"w-5 h-5"}),"Download Warning PDF"]})})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(ee,{className:"w-4 h-4 text-blue-600"}),"Step 2: Copy Email Message"]}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[r.jsx("span",{className:"text-xs font-semibold text-gray-600",children:"EMAIL SUBJECT:"}),r.jsx("button",{onClick:U,className:"text-xs flex items-center gap-1 text-blue-600 hover:text-blue-700 font-medium",children:C?r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-3 h-3"}),"Copied!"]}):r.jsxs(r.Fragment,{children:[r.jsx(ee,{className:"w-3 h-3"}),"Copy Message"]})})]}),r.jsx("div",{className:"bg-white border border-gray-300 rounded p-2 mb-3",children:r.jsx("p",{className:"text-sm font-medium text-gray-900",children:T})}),r.jsx("span",{className:"text-xs font-semibold text-gray-600 block mb-2",children:"EMAIL BODY:"}),r.jsx("div",{className:"bg-white border border-gray-300 rounded p-3 max-h-48 overflow-y-auto",children:r.jsx("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap font-sans",children:I})})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(K,{className:"w-4 h-4 text-blue-600"}),"Step 3: Open Your Email Client"]}),l?r.jsxs("a",{href:F,className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-6 py-3 rounded-lg font-semibold transition-all",children:[r.jsx(Z,{className:"w-5 h-5"}),"Open Email to ",l]}):r.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[r.jsx(B,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Employee email not available. Please send email manually."})]})})]})]}),P.requiresProof&&"email"===o&&r.jsxs("div",{className:"mb-6",children:[r.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(te,{className:"w-4 h-4 text-gray-600"}),"Step 5: Screenshot Instructions"]}),r.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:P.screenshotTips?.map((e,t)=>r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[r.jsx("kbd",{className:"bg-gray-200 px-2 py-1 rounded text-xs font-mono",children:e.split(": ")[1]}),r.jsx("span",{className:"text-xs",children:e.split(": ")[0]})]},t))})})]}),P.requiresProof&&r.jsxs("div",{className:"mb-6",children:[r.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(se,{className:"w-4 h-4 text-blue-600"}),"email"===o?"Step 6: Upload Proof of Delivery":"Upload Proof of Delivery"]}),p?r.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start gap-4",children:[h&&r.jsx("img",{src:h,alt:"Proof of delivery",className:"w-24 h-24 object-cover rounded-lg border"}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:p.name}),r.jsxs("p",{className:"text-sm text-gray-500",children:[(p.size/1024).toFixed(1)," KB"]})]}),r.jsx("button",{onClick:L,className:"text-red-600 hover:text-red-700 p-1",children:r.jsx(z,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[r.jsx(H,{className:"w-4 h-4 text-green-600"}),r.jsx("span",{className:"text-sm text-green-700",children:"Ready to upload"})]})]})]})}):r.jsxs("div",{onDragOver:_,onDrop:R,className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors cursor-pointer",onClick:()=>E.current?.click(),children:[r.jsx(ae,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),r.jsx("p",{className:"text-gray-600 mb-2",children:"Drop screenshot here or click to browse"}),r.jsx("p",{className:"text-sm text-gray-500",children:"PNG, JPG up to 5MB"}),r.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:A,className:"hidden"})]})]}),D&&r.jsx("div",{className:"mb-6 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[r.jsx(B,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:D})]})}),r.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:s,disabled:b,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium transition-colors disabled:opacity-50",children:"Cancel"}),r.jsx("button",{onClick:M,disabled:b||P.requiresProof&&!p,className:`flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-${P.color}-600 to-${P.color}-700 hover:from-${P.color}-700 hover:to-${P.color}-800 text-white rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed`,children:b?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"w-4 h-4 animate-spin"}),"Confirming..."]}):r.jsxs(r.Fragment,{children:[r.jsx(re,{className:"w-4 h-4"}),"Confirm Delivery"]})})]})]})]})})},sa=({isOpen:e,onClose:t,onMethodSelected:s,employeeRequestedMethod:a,employeeName:l,employeeEmail:o,employeePhone:c})=>{const[d,m]=u.useState(null);g(e);const{containerRef:p,ariaProps:x}=Ie({isOpen:e,onClose:t,titleId:"delivery-method-title",descriptionId:"delivery-method-description"}),h=[{id:"email",name:"Email",icon:Z,description:"Send PDF via email client",available:!!o,unavailableReason:o?void 0:"No email address on file",colorClass:"text-blue-600",bgClass:"bg-blue-50"},{id:"whatsapp",name:"WhatsApp",icon:Q,description:"Send via WhatsApp Web",available:!!c,unavailableReason:c?void 0:"No phone number on file",colorClass:"text-green-600",bgClass:"bg-green-50"},{id:"printed",name:"Print & Deliver",icon:J,description:"Print and hand deliver",available:!0,colorClass:"text-purple-600",bgClass:"bg-purple-50"}],v=()=>{m(null),t()},y=e=>{if(!e)return"Not specified";return{email:"Email",whatsapp:"WhatsApp",printed:"Print & Deliver"}[e]};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:f.modalNested1},children:r.jsxs("div",{ref:p,...x,className:"bg-white rounded-2xl max-w-3xl w-full max-h-[90vh] flex flex-col shadow-2xl",children:[r.jsx("div",{className:"p-6 border-b flex-shrink-0",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{id:"delivery-method-title",className:"text-2xl font-bold text-gray-900 mb-1",children:"Select Delivery Method"}),r.jsxs("p",{id:"delivery-method-description",className:"text-sm text-gray-600",children:["Choose how to deliver the warning to ",r.jsx("span",{className:"font-semibold",children:l})]})]}),r.jsx("button",{onClick:v,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close delivery method selection modal",children:r.jsx(z,{className:"w-5 h-5 text-gray-500"})})]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 min-h-0",children:[a&&r.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(ne,{className:"w-5 h-5 text-blue-600 fill-blue-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Employee's Preference"}),r.jsx(n,{variant:"info",size:"xs",children:"REQUESTED"})]}),r.jsxs("p",{className:"text-sm text-gray-700",children:["The employee asked to receive this warning via"," ",r.jsx("span",{className:"font-bold text-blue-700",children:y(a)})]}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"You can choose a different method if their contact details are missing or incorrect"})]})]})}),r.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[r.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Employee Contact Details"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(ie,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-gray-600 min-w-[60px]",children:"Email:"}),o?r.jsx("span",{className:"font-medium text-gray-900",children:o}):r.jsxs("span",{className:"text-red-600 flex items-center gap-1",children:[r.jsx(B,{className:"w-3 h-3"}),"Not available"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(le,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-gray-600 min-w-[60px]",children:"Phone:"}),c?r.jsx("span",{className:"font-medium text-gray-900",children:c}):r.jsxs("span",{className:"text-red-600 flex items-center gap-1",children:[r.jsx(B,{className:"w-3 h-3"}),"Not available"]})]})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"Choose Delivery Method"}),r.jsx("div",{className:"grid grid-cols-1 gap-3",children:h.map(e=>{const t=e.icon,s=d===e.id,i=a===e.id;return r.jsx("button",{onClick:()=>{return e.available&&(t=e.id,void m(t));var t},disabled:!e.available,className:`\n                      relative p-4 rounded-xl border-2 transition-all text-left\n                      ${s?"border-blue-500 bg-blue-50 shadow-md":e.available?"border-gray-200 bg-white hover:border-gray-300 hover:shadow-sm":"border-gray-200 bg-gray-100 cursor-not-allowed"}\n                    `,children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`p-3 rounded-lg ${e.bgClass} flex-shrink-0`,children:r.jsx(t,{className:`w-6 h-6 ${e.available?e.colorClass:"text-gray-400"}`})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h4",{className:"font-semibold text-base "+(e.available?"text-gray-900":"text-gray-500"),children:e.name}),i&&r.jsx(n,{variant:"success",size:"xs",children:"REQUESTED"})]}),r.jsx("p",{className:"text-sm "+(e.available?"text-gray-600":"text-gray-500"),children:e.description}),!e.available&&e.unavailableReason&&r.jsxs("div",{className:"mt-2 flex items-center gap-1.5 text-xs text-red-600",children:[r.jsx(B,{className:"w-3 h-3"}),r.jsx("span",{children:e.unavailableReason})]})]}),s&&r.jsx("div",{className:"flex-shrink-0",children:r.jsx(H,{className:"w-6 h-6 text-blue-600 fill-blue-50"})})]})},e.id)})})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:r.jsxs("p",{className:"text-xs text-blue-800",children:[r.jsx("strong",{children:"Note:"})," After selecting a method, you'll be guided through a step-by-step delivery process with pre-written templates."]})})]}),r.jsx("div",{className:"p-6 border-t bg-gray-50 flex-shrink-0",children:r.jsxs("div",{className:"flex items-center justify-between gap-4",children:[r.jsx(i,{variant:"secondary",onClick:v,size:"lg",children:"Cancel"}),r.jsx(i,{variant:"primary",onClick:()=>{d&&s(d)},disabled:!d,size:"lg",className:"flex items-center gap-2",children:d?r.jsxs(r.Fragment,{children:["Proceed with ",y(d),r.jsx(oe,{className:"w-4 h-4"})]}):"Select a method to continue"})]})})]})}):null},aa=[{value:"procedural_unfair",label:"Procedural Unfairness",description:"The disciplinary process was not followed correctly"},{value:"substantive_unfair",label:"Substantive Unfairness",description:"The warning was not justified by the facts"},{value:"bias_prejudice",label:"Bias or Prejudice",description:"The decision was influenced by bias or unfair treatment"},{value:"insufficient_evidence",label:"Insufficient Evidence",description:"Not enough evidence to support the warning"},{value:"inconsistent_treatment",label:"Inconsistent Treatment",description:"Others were treated differently for similar conduct"},{value:"other",label:"Other Grounds",description:"Different reason (explain in details below)"}],ra=({isOpen:e,onClose:t,warning:s,onAppealSubmit:a})=>{const[n,i]=u.useState(""),[l,o]=u.useState(""),[c,d]=u.useState(""),[m,p]=u.useState(!1),[x,h]=u.useState(null);g(e);const{containerRef:v,ariaProps:y}=Ie({isOpen:e,onClose:t,titleId:"appeal-modal-title",descriptionId:"appeal-modal-description"}),b=s.issueDate?.seconds?new Date(1e3*s.issueDate.seconds):new Date(s.issueDate),j=new Date(b);j.setDate(j.getDate()+30);const N=u.useCallback(async()=>{if(n)if(l.trim())if(c.trim()){p(!0),h(null);try{await a({warningId:s.id,grounds:n,additionalDetails:l.trim(),requestedOutcome:c.trim()})}catch(e){h(e instanceof Error?e.message:"Failed to submit appeal")}finally{p(!1)}}else h("Please specify what outcome you are requesting");else h("Please provide details explaining your appeal");else h("Please select grounds for your appeal")},[n,l,c,a,s.id]);return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:f.modal},children:r.jsxs("div",{ref:v,...y,className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[r.jsx("div",{className:"bg-gradient-to-r from-amber-600 to-orange-700 p-6 text-white flex-shrink-0",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"bg-white/20 p-3 rounded-xl",children:r.jsx(G,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h2",{id:"appeal-modal-title",className:"text-xl font-bold",children:"Appeal Disciplinary Warning"}),r.jsx("p",{id:"appeal-modal-description",className:"text-sm opacity-90",children:"Submit formal appeal as per Labour Relations Act"})]})]}),r.jsx("button",{onClick:t,disabled:m,className:"p-2 hover:bg-white/20 rounded-lg transition-colors disabled:opacity-50","aria-label":"Close appeal modal",children:r.jsx(z,{className:"w-5 h-5"})})]})}),r.jsxs("div",{className:"p-6 flex-1 overflow-y-auto min-h-0",children:[r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6",children:[r.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(ce,{className:"w-4 h-4"}),"Warning Details"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Employee:"}),r.jsx("div",{className:"font-medium",children:s.employeeName})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Warning Level:"}),r.jsx("div",{className:"font-medium capitalize",children:s.level.replace("_"," ")})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Category:"}),r.jsx("div",{className:"font-medium",children:s.category})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Issue Date:"}),r.jsx("div",{className:"font-medium",children:b.toLocaleDateString()})]})]}),r.jsxs("div",{className:"mt-3",children:[r.jsx("span",{className:"text-gray-600 text-sm",children:"Description:"}),r.jsx("div",{className:"text-sm mt-1 p-2 bg-white rounded border",children:s.description})]})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(de,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"text-sm",children:[r.jsx("p",{className:"text-blue-800 font-medium mb-2",children:"Your Appeal Rights"}),r.jsxs("ul",{className:"text-blue-700 space-y-1 text-xs",children:[r.jsxs("li",{children:["â€¢ Appeals must be submitted within ",r.jsx("strong",{children:"30 days"})," of the warning (deadline: ",j.toLocaleDateString(),")"]}),r.jsx("li",{children:"â€¢ You have the right to fair treatment under the Labour Relations Act"}),r.jsx("li",{children:"â€¢ All internal procedures must be exhausted before CCMA referral"}),r.jsx("li",{children:"â€¢ You may be assisted by a shop steward or fellow employee"})]})]})]})}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-3",children:"Grounds for Appeal *"}),r.jsx("div",{className:"space-y-2",children:aa.map(e=>r.jsxs("label",{className:"flex items-start gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"appealGrounds",value:e.value,checked:n===e.value,onChange:e=>i(e.target.value),className:"mt-1"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-sm text-gray-900",children:e.label}),r.jsx("div",{className:"text-xs text-gray-600",children:e.description})]})]},e.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Appeal Details *"}),r.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Explain in detail why you believe the warning is unfair and what evidence supports your appeal."}),r.jsx("textarea",{value:l,onChange:e=>o(e.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm",placeholder:"Provide specific facts, dates, witnesses, and any other relevant information that supports your appeal..."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Requested Outcome *"}),r.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Specify what you would like to happen if your appeal is successful."}),r.jsx("textarea",{value:c,onChange:e=>d(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm",placeholder:"E.g., 'Remove warning from my record', 'Reduce warning level', 'Replace with verbal counselling', etc."})]})]}),x&&r.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[r.jsx(B,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:x})]})})]}),r.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx(me,{className:"w-4 h-4"}),r.jsxs("span",{children:["Appeal deadline: ",j.toLocaleDateString()]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:t,disabled:m,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium transition-colors disabled:opacity-50",children:"Cancel"}),r.jsx("button",{onClick:N,disabled:m||!n||!l.trim()||!c.trim(),className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-amber-600 to-orange-700 hover:from-amber-700 hover:to-orange-800 text-white rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:m?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"w-4 h-4 animate-spin"}),"Submitting Appeal..."]}):r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-4 h-4"}),"Submit Appeal"]})})]})]})]})}):null},na=[{value:"upheld",label:"Uphold Warning",icon:ge,color:"text-green-600",bgColor:"bg-green-50",description:"Warning is justified and remains unchanged"},{value:"reduced",label:"Reduce Warning Level",icon:fe,color:"text-orange-600",bgColor:"bg-orange-50",description:"Warning is justified but level should be reduced"},{value:"modified",label:"Modify Warning",icon:ve,color:"text-blue-600",bgColor:"bg-blue-50",description:"Warning content needs modification"},{value:"overturned",label:"Overturn Warning",icon:q,color:"text-red-600",bgColor:"bg-red-50",description:"Warning is not justified and should be removed"}],ia=[{value:"counselling",label:"Counselling",severity:1},{value:"verbal",label:"Verbal Warning",severity:2},{value:"first_written",label:"Written Warning",severity:3},{value:"second_written",label:"Second Written Warning",severity:4},{value:"final_written",label:"Final Written Warning",severity:5}],la={procedural_unfair:"Procedural Unfairness",substantive_unfair:"Substantive Unfairness",bias_prejudice:"Bias or Prejudice",insufficient_evidence:"Insufficient Evidence",inconsistent_treatment:"Inconsistent Treatment",other:"Other Grounds"},oa=({isOpen:e,onClose:s,warning:a,onDecisionSubmit:n})=>{const[i,l]=u.useState(""),[o,c]=u.useState(""),[d,m]=u.useState(""),[p,x]=u.useState(a.level),[h,v]=u.useState(a.description),[y,b]=u.useState(!1),[j,N]=u.useState(""),[w,D]=u.useState(!1);g(e);const{containerRef:S,ariaProps:C}=Ie({isOpen:e,onClose:s,titleId:"appeal-review-title",descriptionId:"appeal-review-description"}),k=e=>{if(!e)return"Unknown";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-ZA",{year:"numeric",month:"long",day:"numeric"})},E=u.useCallback(async()=>{if(i&&o.trim()){D(!0);try{await n({warningId:a.id,decision:i,reasoning:o.trim(),newLevel:"reduced"===i||"modified"===i?p:void 0,newDescription:"modified"===i?h:void 0,hrNotes:d.trim(),followUpRequired:y,followUpDate:y&&j?new Date(j):void 0}),s()}catch(e){t.error("Failed to submit appeal decision:",e),alert("Failed to submit decision. Please try again.")}finally{D(!1)}}else alert("Please select a decision and provide reasoning.")},[i,o,d,p,h,y,j,a.id,n,s]),P=ia.find(e=>e.value===a.level)?.severity||0,T=ia.filter(e=>e.severity<P);return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:f.modal},children:r.jsxs("div",{ref:S,...C,className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:r.jsx(pe,{className:"w-6 h-6 text-purple-600"})}),r.jsxs("div",{children:[r.jsx("h2",{id:"appeal-review-title",className:"text-xl font-semibold text-gray-900",children:"Appeal Review"}),r.jsx("p",{id:"appeal-review-description",className:"text-sm text-gray-600",children:"Review and decide on employee appeal"})]})]}),r.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close appeal review modal",children:r.jsx(z,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 min-h-0",children:[r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(G,{className:"w-5 h-5 text-gray-600"}),"Original Warning Details"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ce,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm font-medium",children:"Employee:"}),r.jsxs("span",{className:"text-sm",children:[a.employeeName," (",a.employeeNumber,")"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xe,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm font-medium",children:"Department:"}),r.jsx("span",{className:"text-sm",children:a.department})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(me,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm font-medium",children:"Issue Date:"}),r.jsx("span",{className:"text-sm",children:k(a.issueDate)})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium",children:"Category:"}),r.jsx("span",{className:"text-sm ml-2",children:a.category})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium",children:"Level:"}),r.jsx("span",{className:"ml-2 px-2 py-1 text-xs rounded-full "+("final_written"===a.level?"bg-red-100 text-red-800":"second_written"===a.level?"bg-orange-100 text-orange-800":"first_written"===a.level?"bg-yellow-100 text-yellow-800":"verbal"===a.level?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:ia.find(e=>e.value===a.level)?.label||a.level})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium",children:"Description:"}),r.jsx("p",{className:"text-sm mt-1 text-gray-700",children:a.description})]})]})]})]}),a.appealDetails&&r.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(ue,{className:"w-5 h-5 text-blue-600"}),"Employee's Appeal"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Appeal Grounds:"}),r.jsx("p",{className:"text-sm mt-1 px-3 py-2 bg-white rounded border",children:la[a.appealDetails.grounds]||a.appealDetails.grounds})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Employee's Statement:"}),r.jsx("p",{className:"text-sm mt-1 px-3 py-2 bg-white rounded border",children:a.appealDetails.additionalDetails})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Requested Outcome:"}),r.jsx("p",{className:"text-sm mt-1 px-3 py-2 bg-white rounded border",children:a.appealDetails.requestedOutcome})]}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-600",children:[r.jsxs("span",{children:["Submitted: ",k(a.appealDetails.submittedDate)]}),r.jsxs("span",{children:["By: ",a.appealDetails.submittedBy]})]})]})]}),r.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2",children:[r.jsx(he,{className:"w-5 h-5 text-gray-600"}),"HR Decision"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:na.map(e=>{const t=e.icon;return r.jsx("button",{onClick:()=>l(e.value),className:"p-4 rounded-lg border-2 transition-all "+(i===e.value?`border-purple-500 ${e.bgColor}`:"border-gray-200 hover:border-gray-300"),children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(t,{className:`w-5 h-5 ${e.color}`}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"font-medium text-sm",children:e.label}),r.jsx("div",{className:"text-xs text-gray-600",children:e.description})]})]})},e.value)})}),("reduced"===i||"modified"===i)&&r.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"reduced"===i?"Reduce to Level:":"New Warning Level:"}),r.jsx("select",{value:p,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:"reduced"===i?T.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value)):ia.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),"modified"===i&&r.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modified Warning Description:"}),r.jsx("textarea",{value:h,onChange:e=>v(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter the modified warning description..."})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r.jsx("span",{className:"text-red-500",children:"*"})," Decision Reasoning (Legal Documentation)"]}),r.jsx("textarea",{value:o,onChange:e=>c(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Provide detailed reasoning for your decision. This will be part of the legal record and may be reviewed by labor courts or CCMA...",required:!0})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"HR Internal Notes (Optional)"}),r.jsx("textarea",{value:d,onChange:e=>m(e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Internal notes for HR records (not shared with employee)..."})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("label",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",checked:y,onChange:e=>b(e.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Follow-up Required"})]}),y&&r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date:"}),r.jsx("input",{type:"date",value:j,onChange:e=>N(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[r.jsx(de,{className:"w-4 h-4"}),r.jsx("span",{children:"This decision will be automatically documented and employee will be notified"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium transition-colors",children:"Cancel"}),r.jsx("button",{onClick:E,disabled:!i||!o.trim()||w,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors flex items-center gap-2",children:w?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ye,{className:"w-4 h-4"}),"Submit Decision"]})})]})]})]})}):null},ca=({notification:e,currentStep:s,onStepComplete:a,onDeliveryComplete:n,isProcessing:c})=>{const[d,m]=u.useState(!1),[p,x]=u.useState(!1),[h,g]=u.useState(!1),[f,v]=u.useState(null),[y,b]=u.useState(null),[j,N]=u.useState(!1),[w,D]=u.useState(!1),S=u.useCallback(()=>{const t=e.contactDetails.phone||e.employeePhone||"",s=t.replace(/[^\d]/g,"");return{message:`Hi ${e.employeeName},\n\nI hope this message finds you well. I'm writing to inform you that we need to discuss a ${e.warningLevel.toLowerCase()} regarding ${e.warningCategory.toLowerCase()}.\n\nI've attached the formal warning document for your review. Please read through it carefully and let me know if you have any questions or would like to schedule a meeting to discuss this matter further.\n\nThis is an important workplace matter that requires your immediate attention. Please confirm receipt of this message and the attached document.\n\nThank you for your cooperation.\n\nBest regards,\nHR Department`,phoneNumber:s,formattedPhone:t}},[e])();return r.jsxs("div",{className:"space-y-6",children:[0===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-green-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx(Q,{className:"w-5 h-5 text-green-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Prepare WhatsApp Message"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Copy the pre-written script and download the PDF attachment"})]})]}),r.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(le,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Employee Phone Number:"})]}),r.jsx("div",{className:"text-lg font-semibold text-gray-900",children:S.formattedPhone||r.jsxs("span",{className:"text-red-500 text-sm",children:[r.jsx(B,{className:"w-4 h-4 inline mr-1"}),"No phone number on file"]})})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WhatsApp Message Script:"}),r.jsxs("div",{className:"relative",children:[r.jsx("textarea",{value:S.message,readOnly:!0,className:"w-full h-48 p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm font-mono resize-none",style:{color:"var(--color-text)"}}),r.jsx(i,{variant:d?"success":"primary",size:"sm",onClick:async()=>{try{await navigator.clipboard.writeText(S.message),m(!0),setTimeout(()=>m(!1),3e3)}catch(e){t.error("Failed to copy script:",e)}},className:"absolute top-2 right-2",children:d?r.jsxs(r.Fragment,{children:[r.jsx(re,{className:"w-4 h-4 mr-1"}),"Copied!"]}):r.jsxs(r.Fragment,{children:[r.jsx(ee,{className:"w-4 h-4 mr-1"}),"Copy Script"]})})]})]}),r.jsxs("div",{className:"mb-6 space-y-3",children:[r.jsxs("div",{className:"flex gap-3",children:[r.jsxs(i,{variant:"secondary",onClick:()=>{D(!0)},className:"flex items-center gap-2",children:[r.jsx(be,{className:"w-4 h-4"}),"Preview & Download PDF"]}),p&&r.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(H,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:"PDF Downloaded"})]})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Use the preview to download the PDF, then attach it to your WhatsApp message"})]}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm "+(d?"text-green-600":"text-gray-500"),children:[d?r.jsx(H,{className:"w-4 h-4"}):r.jsx(je,{className:"w-4 h-4"}),"Script copied to clipboard"]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm "+(p?"text-green-600":"text-gray-500"),children:[p?r.jsx(H,{className:"w-4 h-4"}):r.jsx(je,{className:"w-4 h-4"}),"PDF downloaded for attachment"]})]}),r.jsx(i,{variant:"primary",onClick:()=>{d&&p&&a(0)},disabled:!d||!p,className:"w-full",children:d&&p?r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"Continue to Send Message"]}):r.jsxs(r.Fragment,{children:[r.jsx(je,{className:"w-4 h-4 mr-2"}),"Complete preparation steps above"]})})]}),1===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(K,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Send via WhatsApp"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Open WhatsApp Web and send the message with PDF attachment"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(o,{variant:"info",children:r.jsxs("div",{className:"text-sm",children:[r.jsx("strong",{children:"Instructions:"}),r.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[r.jsx("li",{children:'Click "Open WhatsApp Web" below'}),r.jsx("li",{children:"The message will be pre-filled with the script"}),r.jsx("li",{children:"Attach the downloaded PDF file"}),r.jsx("li",{children:"Send the message"}),r.jsx("li",{children:"Wait for delivery confirmation (double blue ticks)"})]})]})}),r.jsxs(i,{variant:"primary",onClick:()=>{const e=encodeURIComponent(S.message),t=`https://web.whatsapp.com/send?phone=${S.phoneNumber}&text=${e}`;window.open(t,"_blank"),g(!0)},disabled:!S.phoneNumber,size:"lg",className:"w-full",children:[r.jsx(K,{className:"w-5 h-5 mr-2"}),"Open WhatsApp Web"]}),h&&r.jsxs("div",{className:"mt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm mb-4",children:[r.jsx(H,{className:"w-4 h-4"}),"WhatsApp Web opened"]}),r.jsxs(i,{variant:"primary",onClick:()=>{h&&a(1)},className:"w-full",children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"I've sent the message"]})]})]})]}),2===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-green-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx(se,{className:"w-5 h-5 text-green-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: Confirm Delivery"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Upload screenshot proof of successful delivery"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(o,{variant:"info",children:r.jsxs("div",{className:"text-sm",children:[r.jsx("strong",{children:"Screenshot Requirements:"}),r.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[r.jsx("li",{children:"Show the sent message with timestamp"}),r.jsx("li",{children:"Display delivery confirmation (double blue ticks)"}),r.jsx("li",{children:"Include employee's phone number visible"}),r.jsx("li",{children:"Capture PDF attachment in the message"})]})]})}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){v(t);const e=new FileReader;e.onload=e=>{b(e.target?.result)},e.readAsDataURL(t)}},className:"hidden",id:"proof-upload"}),r.jsx("label",{htmlFor:"proof-upload",className:"cursor-pointer",children:y?r.jsxs("div",{className:"space-y-3",children:[r.jsx("img",{src:y,alt:"Delivery proof",className:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}),r.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[r.jsx(H,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Screenshot uploaded"})]})]}):r.jsxs("div",{className:"space-y-3",children:[r.jsx(Ne,{className:"w-12 h-12 mx-auto text-gray-400"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-medium text-gray-700",children:"Upload Screenshot"}),r.jsx("div",{className:"text-sm text-gray-500",children:"Click to select image file"})]})]})})]}),r.jsx(i,{variant:"success",onClick:async()=>{if(f){N(!0);try{await n({warningId:e.warningId,deliveryMethod:"whatsapp",deliveredAt:new Date,proofImage:f,phoneNumber:S.formattedPhone})}catch(s){t.error("Failed to complete delivery:",s)}finally{N(!1)}}},disabled:!f||j,size:"lg",className:"w-full",children:j?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Delivery..."]}):r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"Complete WhatsApp Delivery"]})})]})]}),w&&r.jsx(Xs,{isOpen:w,onClose:()=>D(!1),warningData:{employee:{firstName:e.employeeName.split(" ")[0]||e.employeeName,lastName:e.employeeName.split(" ").slice(1).join(" ")||"",employeeNumber:"EMP001",department:"N/A"},category:e.warningCategory,level:e.warningLevel,description:"Warning document details",incidentDate:new Date,issueDate:new Date},onDownload:()=>{x(!0)}})]})},da=({notification:e,currentStep:s,onStepComplete:a,onDeliveryComplete:n,isProcessing:c})=>{const[d,m]=u.useState(!1),[p,x]=u.useState(!1),[h,g]=u.useState(!1),[f,v]=u.useState(null),[y,b]=u.useState(null),[j,N]=u.useState(!1),[w,D]=u.useState(!1),S=u.useCallback(()=>{const t=e.contactDetails.email||e.employeeEmail||"";return{subject:`Important: ${e.warningLevel} - ${e.warningCategory}`,body:`Dear ${e.employeeName},\n\nI hope this email finds you well. I am writing to formally notify you of a disciplinary matter that requires your immediate attention.\n\nSubject: ${e.warningLevel}\nCategory: ${e.warningCategory}\n\nPlease find attached the formal warning document that outlines the details of this matter. It is crucial that you review this document thoroughly and understand its contents.\n\nKey Points:\nâ€¢ This is a formal disciplinary action\nâ€¢ Please read the attached document carefully\nâ€¢ You have the right to respond or appeal this decision\nâ€¢ Further incidents may result in additional disciplinary action\n\nIf you have any questions or wish to discuss this matter, please do not hesitate to contact me or schedule a meeting with HR.\n\nPlease confirm receipt of this email and the attached document by replying to this message.\n\nThank you for your attention to this matter.\n\nBest regards,\n${e.createdByName||"HR Department"}\nHuman Resources Department`,to:t}},[e])();return r.jsxs("div",{className:"space-y-6",children:[0===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(Z,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Prepare Email"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Copy the professional email template and download the PDF attachment"})]})]}),r.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(ce,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Employee Email:"})]}),r.jsx("div",{className:"text-lg font-semibold text-gray-900",children:S.to||r.jsxs("span",{className:"text-red-500 text-sm",children:[r.jsx(B,{className:"w-4 h-4 inline mr-1"}),"No email address on file"]})})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Subject:"}),r.jsx("div",{className:"relative",children:r.jsx("input",{value:S.subject,readOnly:!0,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm font-medium",style:{color:"var(--color-text)"}})})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Message Template:"}),r.jsxs("div",{className:"relative",children:[r.jsx("textarea",{value:S.body,readOnly:!0,className:"w-full h-64 p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm resize-none",style:{color:"var(--color-text)"}}),r.jsxs("div",{className:"absolute top-2 right-2 space-x-2",children:[r.jsx(i,{variant:d?"success":"primary",size:"sm",onClick:async()=>{try{const e=`To: ${S.to}\nSubject: ${S.subject}\n\n${S.body}`;await navigator.clipboard.writeText(e),m(!0),setTimeout(()=>m(!1),3e3)}catch(e){t.error("Failed to copy template:",e)}},children:d?r.jsxs(r.Fragment,{children:[r.jsx(re,{className:"w-4 h-4 mr-1"}),"Copied!"]}):r.jsxs(r.Fragment,{children:[r.jsx(ee,{className:"w-4 h-4 mr-1"}),"Copy Full Email"]})}),r.jsxs(i,{variant:"secondary",size:"sm",onClick:async()=>{try{await navigator.clipboard.writeText(S.body),m(!0),setTimeout(()=>m(!1),3e3)}catch(e){t.error("Failed to copy email body:",e)}},children:[r.jsx(ee,{className:"w-4 h-4 mr-1"}),"Body Only"]})]})]})]}),r.jsxs("div",{className:"mb-6 space-y-3",children:[r.jsxs("div",{className:"flex gap-3",children:[r.jsxs(i,{variant:"secondary",onClick:()=>{D(!0)},className:"flex items-center gap-2",children:[r.jsx(be,{className:"w-4 h-4"}),"Preview & Download PDF"]}),p&&r.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(H,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:"PDF Downloaded"})]})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Use the preview to download the PDF, then attach it to your email"})]}),r.jsxs("div",{className:"space-y-2 mb-6",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm "+(d?"text-green-600":"text-gray-500"),children:[d?r.jsx(H,{className:"w-4 h-4"}):r.jsx(je,{className:"w-4 h-4"}),"Email template copied to clipboard"]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm "+(p?"text-green-600":"text-gray-500"),children:[p?r.jsx(H,{className:"w-4 h-4"}):r.jsx(je,{className:"w-4 h-4"}),"PDF downloaded for attachment"]})]}),r.jsx(i,{variant:"primary",onClick:()=>{d&&p&&a(0)},disabled:!d||!p,className:"w-full",children:d&&p?r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"Continue to Send Email"]}):r.jsxs(r.Fragment,{children:[r.jsx(je,{className:"w-4 h-4 mr-2"}),"Complete preparation steps above"]})})]}),1===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-green-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx(we,{className:"w-5 h-5 text-green-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Send Email"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Open your email client and send the message with PDF attachment"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(o,{variant:"info",children:r.jsxs("div",{className:"text-sm",children:[r.jsx("strong",{children:"Instructions:"}),r.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[r.jsx("li",{children:'Click "Open Email Client" below'}),r.jsx("li",{children:"Your default email application will open with pre-filled content"}),r.jsx("li",{children:"Attach the downloaded PDF file"}),r.jsx("li",{children:"Review the email content and recipient"}),r.jsx("li",{children:"Send the email"}),r.jsx("li",{children:"Wait for delivery confirmation if available"})]})]})}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{className:"font-medium text-gray-700",children:"To:"}),r.jsx("span",{className:"text-gray-900",children:S.to})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("span",{className:"font-medium text-gray-700",children:"Subject:"}),r.jsx("span",{className:"text-gray-900",children:S.subject})]})]}),r.jsxs(i,{variant:"primary",onClick:()=>{const e=encodeURIComponent(S.subject),t=encodeURIComponent(S.body),s=`mailto:${encodeURIComponent(S.to)}?subject=${e}&body=${t}`;window.location.href=s,g(!0)},disabled:!S.to,size:"lg",className:"w-full",children:[r.jsx(K,{className:"w-5 h-5 mr-2"}),"Open Email Client"]}),h&&r.jsxs("div",{className:"mt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm mb-4",children:[r.jsx(H,{className:"w-4 h-4"}),"Email client opened"]}),r.jsxs(i,{variant:"primary",onClick:()=>{h&&a(1)},className:"w-full",children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"I've sent the email"]})]})]})]}),2===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-purple-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:r.jsx(se,{className:"w-5 h-5 text-purple-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: Confirm Delivery"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Upload screenshot proof of successful email delivery"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(o,{variant:"info",children:r.jsxs("div",{className:"text-sm",children:[r.jsx("strong",{children:"Screenshot Requirements:"}),r.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[r.jsx("li",{children:'Show the sent email in your "Sent" folder'}),r.jsx("li",{children:"Display recipient email address clearly"}),r.jsx("li",{children:"Include timestamp/date sent"}),r.jsx("li",{children:"Show PDF attachment in the email"}),r.jsx("li",{children:"Capture any delivery confirmation if available"})]})]})}),r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){v(t);const e=new FileReader;e.onload=e=>{b(e.target?.result)},e.readAsDataURL(t)}},className:"hidden",id:"proof-upload"}),r.jsx("label",{htmlFor:"proof-upload",className:"cursor-pointer",children:y?r.jsxs("div",{className:"space-y-3",children:[r.jsx("img",{src:y,alt:"Delivery proof",className:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}),r.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[r.jsx(H,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Screenshot uploaded"})]})]}):r.jsxs("div",{className:"space-y-3",children:[r.jsx(Ne,{className:"w-12 h-12 mx-auto text-gray-400"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-medium text-gray-700",children:"Upload Screenshot"}),r.jsx("div",{className:"text-sm text-gray-500",children:"Click to select image file"})]})]})})]}),r.jsx(i,{variant:"success",onClick:async()=>{if(f){N(!0);try{await n({warningId:e.warningId,deliveryMethod:"email",deliveredAt:new Date,proofImage:f,emailAddress:S.to})}catch(s){t.error("Failed to complete delivery:",s)}finally{N(!1)}}},disabled:!f||j,size:"lg",className:"w-full",children:j?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Delivery..."]}):r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"Complete Email Delivery"]})})]})]}),w&&r.jsx(Xs,{isOpen:w,onClose:()=>D(!1),warningData:{employee:{firstName:e.employeeName.split(" ")[0]||e.employeeName,lastName:e.employeeName.split(" ").slice(1).join(" ")||"",employeeNumber:"EMP001",department:"N/A"},category:e.warningCategory,level:e.warningLevel,description:"Warning document details",incidentDate:new Date,issueDate:new Date},onDownload:()=>{x(!0)}})]})},ma=({notification:e,currentStep:s,onStepComplete:a,onDeliveryComplete:n,isProcessing:m})=>{const{organization:p}=c(),[x,h]=u.useState(!1),[g,f]=u.useState(!1),[v,b]=u.useState([{id:"hand_delivered",label:"Hand delivered to employee",completed:!1,required:!0,description:"Personally delivered the printed warning to the employee"}]),[j,N]=u.useState([{id:"delivery_complete",label:"Delivery process completed",completed:!1,required:!0,description:"Confirm warning has been delivered to employee"}]),[w,D]=u.useState({deliveryDate:(new Date).toISOString().split("T")[0],deliveryTime:(new Date).toTimeString().split(" ")[0].slice(0,5),deliveryLocation:"",witnessName:"",additionalNotes:""}),S=u.useCallback(async()=>{if(!p)return alert("Organization data not loaded"),null;try{f(!0),t.debug("ðŸ“„ Fetching warning data to generate PDF:",e.warningId);const s=await d.warnings.getById(e.warningId,p.id);if(!s)throw new Error("Warning data not found");t.debug("âœ… Warning data fetched, fetching employee data...");const a=await d.employees.getById(s.employeeId,p.id);if(!a)throw new Error("Employee data not found");t.debug("âœ… Employee data fetched, generating PDF...");const r=Qs(s,a,p);t.debug("ðŸ“„ Transformed PDF data:",{warningId:r.warningId,pdfGeneratorVersion:r.pdfGeneratorVersion,employee:`${r.employee.firstName} ${r.employee.lastName}`});const{PDFGenerationService:n}=await y(async()=>{const{PDFGenerationService:e}=await import("./dashboard-router-CsxAXVhx.js").then(e=>e.d);return{PDFGenerationService:e}},__vite__mapDeps([0,1,2,3,4,5,6,7])),i=await n.generateWarningPDF(r,r.pdfGeneratorVersion,r.pdfSettings);return t.success("âœ… PDF generated successfully"),i}catch(s){return t.error("âŒ Failed to generate PDF:",s),alert("Failed to generate PDF. Please try again."),null}finally{f(!1)}},[e.warningId,p]),C=u.useCallback(async()=>{if(e.pdfUrl){const t=window.open(e.pdfUrl,"_blank");return void(t&&(t.onload=()=>{t.print(),h(!0)}))}const t=await S();if(t){const e=URL.createObjectURL(t),s=window.open(e,"_blank");s&&(s.onload=()=>{s.print(),h(!0)})}},[e.pdfUrl,S]),k=(e,t)=>{"delivery"===e?b(e=>e.map(e=>e.id===t?{...e,completed:!e.completed}:e)):N(e=>e.map(e=>e.id===t?{...e,completed:!e.completed}:e))},E=v.filter(e=>e.required).every(e=>e.completed),P=j.filter(e=>e.required).every(e=>e.completed);return r.jsxs("div",{className:"space-y-6",children:[0===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-purple-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:r.jsx(J,{className:"w-5 h-5 text-purple-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Print Warning Document"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Print the official warning document for hand delivery"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(o,{variant:"info",children:r.jsxs("div",{className:"text-sm",children:[r.jsx("strong",{children:"Printing Requirements:"}),r.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[r.jsx("li",{children:"Use high-quality paper (minimum 80gsm)"}),r.jsx("li",{children:"Ensure all text is clearly legible"}),r.jsx("li",{children:"Print multiple copies (original + HR copy)"})]})]})}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(ce,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"font-medium",children:"Employee:"}),r.jsx("span",{children:e.employeeName})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(G,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"font-medium",children:"Warning Type:"}),r.jsx("span",{children:e.warningLevel})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(me,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"font-medium",children:"Issue Date:"}),r.jsx("span",{children:e.createdAt.toLocaleDateString()})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex gap-3",children:[r.jsx(i,{variant:"secondary",onClick:async()=>{if(e.pdfUrl)return void window.open(e.pdfUrl,"_blank");const t=await S();if(t){const e=URL.createObjectURL(t);window.open(e,"_blank")}},disabled:g,className:"flex items-center gap-2",children:g?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"w-4 h-4 animate-spin"}),"Generating PDF..."]}):r.jsxs(r.Fragment,{children:[r.jsx(be,{className:"w-4 h-4"}),"Preview Document"]})}),r.jsx(i,{variant:"primary",onClick:C,disabled:g,className:"flex items-center gap-2",children:g?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"w-4 h-4 animate-spin"}),"Generating PDF..."]}):r.jsxs(r.Fragment,{children:[r.jsx(J,{className:"w-4 h-4"}),"Print Document"]})})]}),x&&r.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[r.jsx(H,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Document printed successfully"})]})]}),r.jsx(i,{variant:"primary",onClick:()=>{x&&a(0)},disabled:!x,className:"w-full",children:x?r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"Continue to Hand Delivery"]}):r.jsxs(r.Fragment,{children:[r.jsx(je,{className:"w-4 h-4 mr-2"}),"Print document to continue"]})})]})]}),1===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-green-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx(ce,{className:"w-5 h-5 text-green-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Hand Delivery to Employee"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Deliver the printed document and obtain employee acknowledgment"})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Date"}),r.jsx("input",{type:"date",value:w.deliveryDate,onChange:e=>D(t=>({...t,deliveryDate:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Time"}),r.jsx("input",{type:"time",value:w.deliveryTime,onChange:e=>D(t=>({...t,deliveryTime:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Location"}),r.jsx("input",{type:"text",placeholder:"e.g., Employee's office, HR meeting room",value:w.deliveryLocation,onChange:e=>D(t=>({...t,deliveryLocation:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]})]}),r.jsxs("div",{children:[r.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[r.jsx(H,{className:"w-5 h-5 text-green-600"}),"Delivery Checklist"]}),r.jsx("div",{className:"space-y-3",children:v.map(e=>r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[r.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>k("delivery",e.id),className:"mt-1 w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"font-medium "+(e.completed?"text-green-600":"text-gray-900"),children:[e.label,e.required&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),r.jsx("div",{className:"text-sm text-gray-600",children:e.description})]}),e.completed&&r.jsx(H,{className:"w-5 h-5 text-green-600 mt-1"})]},e.id))})]}),r.jsx(i,{variant:"primary",onClick:()=>{E&&a(1)},disabled:!E,className:"w-full",children:E?r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"Continue to Filing"]}):r.jsxs(r.Fragment,{children:[r.jsx(je,{className:"w-4 h-4 mr-2"}),"Complete all required items above"]})})]})]}),2===s&&r.jsxs(l,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(De,{className:"w-5 h-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: Finalize Delivery"}),r.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Confirm delivery completion"})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{children:r.jsx("div",{className:"space-y-3",children:j.map(e=>r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[r.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>k("filing",e.id),className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"font-medium "+(e.completed?"text-blue-600":"text-gray-900"),children:[e.label,e.required&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),r.jsx("div",{className:"text-sm text-gray-600",children:e.description})]}),e.completed&&r.jsx(H,{className:"w-5 h-5 text-blue-600 mt-1"})]},e.id))})}),r.jsx(i,{variant:"success",onClick:async()=>{if(P)try{await n({warningId:e.warningId,deliveryMethod:"printed",deliveredAt:new Date(`${w.deliveryDate}T${w.deliveryTime}`),deliveryLocation:w.deliveryLocation,witnessName:w.witnessName,additionalNotes:w.additionalNotes,deliveryChecklist:v,filingChecklist:j})}catch(s){t.error("Failed to complete delivery:",s)}},disabled:!P||m,size:"lg",className:"w-full",children:m?r.jsxs(r.Fragment,{children:[r.jsx(V,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Process..."]}):r.jsxs(r.Fragment,{children:[r.jsx(H,{className:"w-4 h-4 mr-2"}),"Complete Delivery"]})})]})]})]})},pa=({notification:e,onDeliveryComplete:t,onClose:s,isOpen:a})=>{const[l,c]=u.useState(0),[d,m]=u.useState([]),[p,x]=u.useState(!1),[h,g]=u.useState(null);u.useEffect(()=>{m((()=>{switch(e.deliveryMethod){case"whatsapp":return[{id:"prepare",label:"Prepare Message",completed:!1,inProgress:!0,description:"Copy pre-written script and download PDF"},{id:"send",label:"Send via WhatsApp",completed:!1,inProgress:!1,description:"Open WhatsApp and send message with attachment"},{id:"confirm",label:"Confirm Delivery",completed:!1,inProgress:!1,description:"Upload screenshot proof and complete delivery"}];case"email":return[{id:"prepare",label:"Prepare Email",completed:!1,inProgress:!0,description:"Copy email template and download PDF attachment"},{id:"send",label:"Send Email",completed:!1,inProgress:!1,description:"Open email client and send message"},{id:"confirm",label:"Confirm Delivery",completed:!1,inProgress:!1,description:"Upload screenshot proof and complete delivery"}];case"printed":return[{id:"print",label:"Print Document",completed:!1,inProgress:!0,description:"Print warning PDF document"},{id:"deliver",label:"Hand Deliver",completed:!1,inProgress:!1,description:"Deliver to employee and obtain signature"},{id:"file",label:"File Documentation",completed:!1,inProgress:!1,description:"File signed copy and confirm completion"}];default:return[]}})())},[e.deliveryMethod]);const f=(()=>{switch(e.deliveryMethod){case"whatsapp":return{icon:Q,name:"WhatsApp Business",color:"green",bgClass:"bg-green-50 border-green-200",textClass:"text-green-700"};case"email":return{icon:Z,name:"Email",color:"blue",bgClass:"bg-blue-50 border-blue-200",textClass:"text-blue-700"};case"printed":return{icon:J,name:"Print & Hand Delivery",color:"purple",bgClass:"bg-purple-50 border-purple-200",textClass:"text-purple-700"};default:return{icon:G,name:"Unknown",color:"gray",bgClass:"bg-gray-50 border-gray-200",textClass:"text-gray-700"}}})(),v=e=>{m(t=>t.map((t,s)=>s===e?{...t,completed:!0,inProgress:!1}:s===e+1?{...t,inProgress:!0}:t)),e<d.length-1&&c(e+1)},y=async a=>{x(!0);try{await t(e.id,{...a,deliveryMethod:e.deliveryMethod,completedAt:new Date,steps:d}),s()}catch(r){g("Failed to complete delivery. Please try again.")}finally{x(!1)}};return a?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[95vh] flex flex-col shadow-2xl",children:[r.jsx("div",{className:`p-6 border-b flex-shrink-0 ${f.bgClass}`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"p-3 rounded-xl bg-white shadow-sm",children:r.jsx(f.icon,{className:`w-6 h-6 ${f.textClass}`})}),r.jsxs("div",{children:[r.jsxs("h2",{className:"text-xl font-bold",style:{color:"var(--color-text)"},children:[f.name," Delivery"]}),r.jsxs("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:["Guided delivery workflow for ",e.employeeName]})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(n,{variant:e.priority,size:"sm",children:e.priority.toUpperCase()}),r.jsx(i,{variant:"ghost",size:"sm",onClick:s,children:r.jsx(z,{className:"w-4 h-4"})})]})]})}),r.jsxs("div",{className:"p-4 bg-gray-50 border-b flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ce,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"font-semibold text-gray-900",children:e.employeeName})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ge,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-600",children:e.warningLevel})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(G,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-600",children:e.warningCategory})]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[r.jsx(me,{className:"w-4 h-4"}),e.createdAt.toLocaleDateString()]})]}),(e.contactDetails.email||e.contactDetails.phone)&&r.jsxs("div",{className:"mt-3 flex items-center gap-4",children:[e.contactDetails.email&&r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(Z,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-gray-600",children:e.contactDetails.email})]}),e.contactDetails.phone&&r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(le,{className:"w-4 h-4 text-gray-400"}),r.jsx("span",{className:"text-gray-600",children:e.contactDetails.phone})]})]})]}),r.jsx("div",{className:"p-6 border-b bg-white flex-shrink-0",children:r.jsx("div",{className:"flex items-center justify-between",children:d.map((e,t)=>r.jsxs("div",{className:"flex items-center",children:[r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:`\n                    w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium transition-all\n                    ${e.completed?"bg-green-500 text-white":e.inProgress?"bg-blue-500 text-white animate-pulse":"bg-gray-200 text-gray-500"}\n                  `,children:e.completed?r.jsx(H,{className:"w-5 h-5"}):e.inProgress?r.jsx(je,{className:"w-5 h-5"}):t+1}),r.jsxs("div",{className:"mt-2 text-center",children:[r.jsx("div",{className:"text-sm font-medium "+(e.completed||e.inProgress?"text-gray-900":"text-gray-500"),children:e.label}),r.jsx("div",{className:"text-xs text-gray-500 mt-1 max-w-32",children:e.description})]})]}),t<d.length-1&&r.jsx(oe,{className:"w-5 h-5 mx-4 "+(e.completed?"text-green-500":"text-gray-300")})]},e.id))})}),h&&r.jsx("div",{className:"p-4 flex-shrink-0",children:r.jsx(o,{variant:"error",children:h})}),r.jsxs("div",{className:"p-6 flex-1 overflow-y-auto min-h-0",children:["whatsapp"===e.deliveryMethod&&r.jsx(ca,{notification:e,currentStep:l,onStepComplete:v,onDeliveryComplete:y,isProcessing:p}),"email"===e.deliveryMethod&&r.jsx(da,{notification:e,currentStep:l,onStepComplete:v,onDeliveryComplete:y,isProcessing:p}),"printed"===e.deliveryMethod&&r.jsx(ma,{notification:e,currentStep:l,onStepComplete:v,onDeliveryComplete:y,isProcessing:p})]}),r.jsxs("div",{className:"p-4 border-t bg-gray-50 flex items-center justify-between flex-shrink-0",children:[r.jsxs("div",{className:"text-sm text-gray-500",children:["Step ",l+1," of ",d.length]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(i,{variant:"ghost",size:"sm",onClick:s,children:"Cancel"}),p&&r.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[r.jsx(q,{className:"w-4 h-4 animate-spin"}),"Processing..."]})]})]})]})}):null},xa=Object.freeze(Object.defineProperty({__proto__:null,EnhancedDeliveryWorkflow:pa,default:pa},Symbol.toStringTag,{value:"Module"}));class ua{static async createDeliveryNotification(e){try{t.debug("ðŸ“¬ Creating delivery notification for HR...",e);const a=this.determinePriority(e.warningLevel),r=this.prepareContactDetails(e),n={organizationId:e.organizationId,warningId:e.warningId,employeeId:e.employeeId,employeeName:e.employeeName,employeeEmail:e.employeeEmail,employeePhone:e.employeePhone,warningLevel:e.warningLevel,warningCategory:e.warningCategory,incidentDate:e.incidentDate,employeeRequestedDeliveryMethod:e.employeeRequestedDeliveryMethod,contactDetails:r,status:"pending",priority:a,deliveryAttempts:0,createdAt:O(),updatedAt:O(),createdBy:e.createdBy,createdByName:e.createdByName},i=await $(R(s,"organizations",e.organizationId,"deliveryNotifications"),n);return t.success(3842),await this.createSystemNotification(e,i.id),i.id}catch(a){throw t.error("âŒ Failed to create delivery notification:",a),a}}static async updateDeliveryStatus(e,s,a,r){try{const n={status:s,updatedAt:O()};"delivered"===s&&(n.deliveryDate=O(),n.deliveredBy=r),a&&(n.deliveryNotes=a),t.debug("ðŸ“ Updating delivery status:",e,s)}catch(n){throw t.error("âŒ Failed to update delivery status:",n),n}}static async updateDeliveryMethod(e,a,r){try{t.debug("ðŸ“ Updating delivery method:",{notificationId:a,deliveryMethod:r});const n=F(s,"organizations",e,"deliveryNotifications",a);await W(n,{deliveryMethod:r,status:"in_progress",updatedAt:O()}),t.success("âœ… Delivery method updated successfully")}catch(n){throw t.error("âŒ Failed to update delivery method:",n),n}}static determinePriority(e){switch(e.toLowerCase()){case"dismissal":case"suspension":return"urgent";case"final_written":case"final written warning":return"high";default:return"normal"}}static prepareContactDetails(e){const t={};return e.employeeEmail&&(t.email=e.employeeEmail),e.employeePhone&&(t.phone=e.employeePhone),t.address="To be confirmed by HR",t}static async createSystemNotification(e,s){try{const{QuickNotifications:s}=await y(async()=>{const{QuickNotifications:e}=await import("./NotificationDeliveryService-J1vOICqU.js");return{QuickNotifications:e}},__vite__mapDeps([8,1,2,3,4,5]));await s.warningNeedsDelivery(e.organizationId,e.employeeName,e.warningLevel,this.getDeliveryMethodName(e.deliveryMethod)),t.debug("ðŸ”” Role-based notification sent to HR team")}catch(a){t.error("âŒ Failed to create system notification:",a)}}static generateNotificationMessage(e){const t=this.getDeliveryMethodName(e.deliveryMethod),s=e.isEmployeePreference?" (employee's preferred method)":" (selected by manager)";return`Warning issued to ${e.employeeName} requires delivery via ${t}${s}. Warning level: ${e.warningLevel}.`}static getDeliveryMethodName(e){switch(e){case"email":return"Email";case"whatsapp":return"WhatsApp";case"printed":return"Print & Hand Delivery";default:return e}}}const ha=(e,t="Unknown")=>null==e?t:"string"==typeof e?e:"number"==typeof e?e.toString():"boolean"==typeof e?e?"Yes":"No":e instanceof Date?e.toLocaleDateString():"object"==typeof e?e.name?String(e.name):e.title?String(e.title):e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:t:String(e),ga=e=>e?e instanceof Date?e:e.seconds?new Date(1e3*e.seconds):new Date(e):new Date,fa=e=>{if(!e.issueDate)return!1;const t=ga(e.issueDate),s=new Date(t);s.setDate(s.getDate()+30);return new Date<=s},va=({organizationId:e,onClose:s,PDFGenerationService:a,DataService:n,canTakeAction:i=!1,userRole:l="viewer",initialEmployeeFilter:o,selectedWarning:h,showDetails:g,onViewDetails:f,onCloseDetails:y,onWarningUpdated:b})=>{const{user:j,organization:N}=c(),w=e||N?.id;t.debug("ðŸ”§ [WarningsReviewDashboard] Using API layer version");const[D,S]=u.useState([]),[C,k]=u.useState([]),[E,P]=u.useState([]),[T,I]=u.useState(!0),[F,A]=u.useState(null),[_,R]=u.useState(1),[M,L]=u.useState(o?.name||""),[U,O]=u.useState("all"),[$,W]=u.useState("all"),[V,K]=u.useState("all"),[Y,J]=u.useState("date"),[Q,Z]=u.useState("desc"),[X,ee]=u.useState(null),[te,se]=u.useState(!1),[ae,re]=u.useState(!1),[ne,ie]=u.useState(!1),[le,oe]=u.useState(null),[ce,de]=u.useState(!1),[me,xe]=u.useState(null),[ue,he]=u.useState(!1),[fe,ve]=u.useState({}),ye=v(),[Ne,we]=u.useState(!1),[De,Te]=u.useState(null),[Ie,Fe]=u.useState("warnings"),Ae=u.useCallback(async()=>{if(!w)return t.warn("No organization ID available for loading warnings"),void I(!1);try{let e;if(I(!0),A(null),m())if(t.debug("ðŸ”„ Loading warnings via NestedDataService for org:",w),p()){e=(await x.getOrganizationWarnings(w,{},{pageSize:500,orderField:"issueDate",orderDirection:"desc"})).warnings,t.debug(`ðŸ“ [NESTED] Loaded ${e.length} warnings via collection group`)}else t.debug("ðŸ“‹ [FALLBACK] Collection group disabled, using flat structure"),e=await d.warnings.getAll(w);else t.debug("ðŸ”„ Loading warnings via API layer for org:",w),e=await d.warnings.getAll(w),t.debug(`ðŸ” [DEBUG] Loaded ${e.length} warnings with IDs:`,e.map(e=>`${e.employeeName}: id="${e.id}"`));const s=e.filter(e=>!e.isArchived&&"expired"!==e.status&&"overturned"!==e.status),a=e.filter(e=>"expired"===e.status||"overturned"===e.status),r=s.sort((e,t)=>new Date(t.createdAt||0).getTime()-new Date(e.createdAt||0).getTime()),n=a.sort((e,t)=>new Date(t.appealDecisionDate||t.updatedAt||0).getTime()-new Date(e.appealDecisionDate||e.updatedAt||0).getTime());t.debug(`ðŸ” [DEBUG] After filtering/sorting, ${r.length} active warnings, ${n.length} archived with IDs:`,r.map(e=>`${e.employeeName}: id="${e.id}"`)),S(r),k(r),P(n),t.success(`ðŸ“Š Loaded ${r.length} active warnings, ${n.length} archived (${m()?"NESTED":"SHARDED"} structure)`)}catch(e){t.error("âŒ Failed to load warnings:",e);const s=e instanceof Error?e.message:"Unknown error";A(`Failed to load warnings: ${s}`)}finally{I(!1)}},[w]);u.useEffect(()=>{w?Ae():I(!1)},[w,Ae]),u.useEffect(()=>{let e=[...D];if(M){const t=M.toLowerCase();e=e.filter(e=>e.employeeName?.toLowerCase().includes(t)||e.employeeNumber?.toLowerCase().includes(t)||e.category?.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t))}"all"!==U&&(e=e.filter(e=>e.status===U)),"all"!==$&&(e=e.filter(e=>e.level===$)),"all"!==V&&(e=e.filter(e=>e.department===V)),e.sort((e,t)=>{let s,a;switch(Y){case"employee":s=e.employeeName,a=t.employeeName;break;case"level":s=e.level,a=t.level;break;case"status":s=e.status||"",a=t.status||"";break;default:s=new Date(e.createdAt||0).getTime(),a=new Date(t.createdAt||0).getTime()}return s<a?"asc"===Q?-1:1:s>a?"asc"===Q?1:-1:0}),k(e),R(1)},[D,M,U,$,V,Y,Q]);const _e=u.useMemo(()=>{const e=new Set(D.map(e=>e.department).filter(e=>e));return Array.from(e).sort()},[D]),Re=u.useMemo(()=>{const e=10*(_-1),s=e+10,a=C.slice(e,s);return t.debug(`ðŸ” [DEBUG] Paginated warnings (page ${_}) with IDs:`,a.map(e=>`${e.employeeName}: id="${e.id}"`)),a},[C,_]),Me=Math.ceil(C.length/10),Le=u.useCallback(e=>{t.debug("Opening warning details for:",e.id),f?f(e):(ee(e),se(!0))},[f]);u.useCallback(()=>{t.debug("Closing warning details modal"),y?y():(se(!1),ee(null))},[y]);const Ue=u.useCallback(async e=>{try{if(I(!0),!e.warningId)throw new Error("Warning ID is missing. Please try again.");if(!w)throw new Error("Organization ID is missing. Please try again.");t.debug(`ðŸ“ Submitting appeal for warning: ${e.warningId}`),await d.warnings.update(e.warningId,{appealSubmitted:!0,appealDate:new Date,status:"appealed",appealDetails:{grounds:e.grounds,details:e.additionalDetails,requestedOutcome:e.requestedOutcome,submittedAt:new Date,submittedBy:j?.email||"Employee"}},w),t.success(`Legal appeal submitted for warning ${e.warningId}`),await Ae(),ye.close(),alert("Appeal submitted successfully. HR will review your appeal within 5 working days as per company policy.")}catch(s){throw t.error("Failed to submit appeal:",s),new Error("Failed to submit appeal. Please try again.")}finally{I(!1)}},[Ae,j]);u.useCallback(async(e,s)=>{try{I(!0),await d.warnings.update(e,{status:"overturned"===s?"expired":"acknowledged",appealOutcome:s,appealDate:new Date},w),t.success(`Appeal ${s} for warning ${e}`),await Ae()}catch(a){t.error("Failed to process appeal:",a),A("Failed to process appeal")}finally{I(!1)}},[Ae]);const Oe=u.useCallback(async e=>{try{I(!0);let s="acknowledged";"overturned"===e.decision&&(s="overturned");const a={status:s,appealOutcome:e.decision,appealDecisionDate:new Date,appealReasoning:e.reasoning,hrNotes:e.hrNotes,followUpRequired:e.followUpRequired,followUpDate:e.followUpDate};"reduced"!==e.decision&&"modified"!==e.decision||(e.newLevel&&(a.level=e.newLevel),e.newDescription&&(a.description=e.newDescription)),await d.warnings.update(e.warningId,a,w),"overturned"===e.decision?(await d.warnings.archive(e.warningId,w,"overturned"),t.success("Warning overturned and archived")):"upheld"===e.decision&&t.info("Warning upheld - remains active"),await Ae(),t.success("Appeal decision recorded successfully")}catch(s){throw t.error("Failed to record appeal decision:",s),new Error("Failed to record appeal decision. Please try again.")}finally{I(!1)}},[Ae]);u.useCallback(e=>{t.debug("Opening warning details:",e.id),setSelectedWarning(e),setShowDetails(!0)},[]);const $e=u.useCallback(async e=>{try{confirm("Are you sure you want to archive this warning? It will be moved to the archive.")&&(I(!0),await d.warnings.archive(e,w,"manual"),t.success("Warning archived successfully"),await Ae())}catch(s){t.error("Failed to archive warning:",s),A("Failed to archive warning")}finally{I(!1)}},[w,Ae]);return T?r.jsx("div",{className:"p-4",children:r.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[r.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mb-3"}),r.jsx("h3",{className:"text-md font-medium text-gray-900 mb-1",children:"Loading Warnings"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Please wait..."})]})}):F?r.jsx("div",{className:"p-4",children:r.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[r.jsx(B,{className:"w-8 h-8 text-red-500 mb-3"}),r.jsx("h3",{className:"text-md font-medium text-gray-900 mb-1",children:"Error Loading Warnings"}),r.jsx("p",{className:"text-sm text-red-600 mb-3",children:F}),r.jsxs("button",{onClick:Ae,className:"bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 text-sm",children:[r.jsx(q,{className:"w-4 h-4"}),"Retry Loading"]})]})}):r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Warning Management"}),r.jsxs("span",{className:"text-xs sm:text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[D.length," active"]}),E.length>0&&r.jsxs("span",{className:"text-xs sm:text-sm text-gray-500 bg-orange-100 px-2 py-1 rounded-full",children:[E.length," archived"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>Fe("archive"===Ie?"warnings":"archive"),className:"flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm "+("archive"===Ie?"bg-blue-600 hover:bg-blue-700 text-white":"bg-orange-600 hover:bg-orange-700 text-white"),children:[r.jsx(Se,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"archive"===Ie?"Active Warnings":"Archive"})]}),r.jsx("button",{onClick:Ae,disabled:T,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(q,{className:"w-4 h-4 "+(T?"animate-spin":"")})}),s&&r.jsx("button",{onClick:s,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(z,{className:"w-4 h-4"})})]})]}),"archive"===Ie?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[r.jsx(Se,{className:"w-5 h-5 text-gray-600"}),"Warning Archive"]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View expired and overturned warnings with appeal decision history"})]}),r.jsxs("button",{onClick:()=>Fe("warnings"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm flex items-center gap-2",children:[r.jsx(Ce,{className:"w-4 h-4 rotate-90"}),"Back to Active Warnings"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Se,{className:"w-8 h-8 text-gray-600"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:E.length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Total Archived"})]})]})}),r.jsx("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(q,{className:"w-8 h-8 text-orange-600"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl font-bold text-orange-900",children:E.filter(e=>"overturned"===e.status).length}),r.jsx("div",{className:"text-sm text-orange-700",children:"Overturned Appeals"})]})]})}),r.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(je,{className:"w-8 h-8 text-blue-600"}),r.jsxs("div",{children:[r.jsx("div",{className:"text-2xl font-bold text-blue-900",children:E.filter(e=>"expired"===e.status).length}),r.jsx("div",{className:"text-sm text-blue-700",children:"Naturally Expired"})]})]})})]}),0===E.length?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[r.jsx(Se,{className:"w-16 h-16 text-gray-300 mx-auto mb-3"}),r.jsx("p",{className:"text-gray-500 font-medium",children:"No archived warnings"}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Expired and overturned warnings will appear here"})]}):r.jsx("div",{className:"space-y-3",children:E.map((e,t)=>r.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:ha(e.employeeName)}),r.jsxs("span",{className:"text-xs text-gray-500",children:[ha(e.employeeNumber)," â€¢ ",ha(e.department)]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Warning Level"}),r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"counselling"===e.level?"Counselling":"verbal"===e.level?"Verbal":"first_written"===e.level?"Written":"second_written"===e.level?"Second Written":"final_written"===e.level?"Final Written":ha(e.level,"Unknown")})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Category"}),r.jsx("p",{className:"text-sm font-medium text-gray-900",children:ha(e.category)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Issue Date"}),r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.issueDate?new Date(e.issueDate.seconds?1e3*e.issueDate.seconds:e.issueDate).toLocaleDateString():"N/A"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Status"}),r.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+("overturned"===e.status?"bg-orange-100 text-orange-800":"expired"===e.status?"bg-gray-100 text-gray-800":"bg-gray-100 text-gray-600"),children:"overturned"===e.status?"Overturned":"expired"===e.status?"Expired":ha(e.status,"Archived")})]})]}),"overturned"===e.status&&e.appealDecisionDate&&r.jsx("div",{className:"bg-orange-50 rounded-lg p-3 border border-orange-200 mt-3",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(pe,{className:"w-4 h-4 text-orange-600 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-xs font-medium text-orange-900 mb-1",children:"Appeal Decision"}),r.jsxs("p",{className:"text-xs text-orange-800 mb-2",children:[r.jsx("strong",{children:"Outcome:"})," ","overturned"===e.appealOutcome?"Warning Overturned":ha(e.appealOutcome)]}),e.appealReasoning&&r.jsxs("p",{className:"text-xs text-orange-800 mb-2",children:[r.jsx("strong",{children:"Reasoning:"})," ",ha(e.appealReasoning)]}),e.hrNotes&&r.jsxs("p",{className:"text-xs text-orange-800 mb-2",children:[r.jsx("strong",{children:"HR Notes:"})," ",ha(e.hrNotes)]}),r.jsxs("p",{className:"text-xs text-orange-700",children:[r.jsx("strong",{children:"Decision Date:"})," ",new Date(e.appealDecisionDate).toLocaleDateString()]})]})]})}),"expired"===e.status&&r.jsx("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200 mt-3",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(je,{className:"w-4 h-4 text-blue-600 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-xs font-medium text-blue-900 mb-1",children:"Natural Expiry"}),r.jsx("p",{className:"text-xs text-blue-800",children:"This warning expired after its validity period completed without further incidents."}),e.expiryDate&&r.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:[r.jsx("strong",{children:"Expired On:"})," ",new Date(e.expiryDate).toLocaleDateString()]})]})]})})]}),r.jsxs("button",{onClick:()=>Le(e),className:"px-3 py-1.5 text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors flex items-center gap-1",children:[r.jsx(be,{className:"w-4 h-4"}),"View"]})]})},e.id||`archived-${t}`))})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search warnings...",value:M,onChange:e=>L(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:U,onChange:e=>O(e.target.value),className:"flex-1 sm:flex-initial px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"issued",children:"Issued"}),r.jsx("option",{value:"acknowledged",children:"Acknowledged"}),r.jsx("option",{value:"appealed",children:"Under Appeal"}),r.jsx("option",{value:"expired",children:"Expired"})]}),r.jsxs("select",{value:$,onChange:e=>W(e.target.value),className:"flex-1 sm:flex-initial px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"all",children:"All Levels"}),r.jsx("option",{value:"counselling",children:"Counselling"}),r.jsx("option",{value:"verbal",children:"Verbal"}),r.jsx("option",{value:"first_written",children:"Written"}),r.jsx("option",{value:"second_written",children:"Second Written"}),r.jsx("option",{value:"final_written",children:"Final Written"})]}),r.jsxs("button",{onClick:()=>re(!ae),className:"px-3 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors text-sm items-center gap-2 sm:flex hidden",children:[r.jsx(Ee,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden lg:inline",children:"More"}),ae?r.jsx(Pe,{className:"w-4 h-4"}):r.jsx(Ce,{className:"w-4 h-4"})]})]})]}),ae&&r.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3",children:[r.jsxs("select",{value:V,onChange:e=>K(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"all",children:"All Departments"}),_e.map(e=>r.jsx("option",{value:e,children:e},e))]}),r.jsxs("select",{value:`${Y}-${Q}`,onChange:e=>{const[t,s]=e.target.value.split("-");J(t),Z(s)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"date-desc",children:"Newest First"}),r.jsx("option",{value:"date-asc",children:"Oldest First"}),r.jsx("option",{value:"employee-asc",children:"Employee A-Z"}),r.jsx("option",{value:"employee-desc",children:"Employee Z-A"}),r.jsx("option",{value:"level-asc",children:"Level (Low to High)"}),r.jsx("option",{value:"level-desc",children:"Level (High to Low)"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Show:"}),r.jsxs("select",{value:10,onChange:e=>setItemsPerPage(Number(e.target.value)),className:"px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:10,children:"10"}),r.jsx("option",{value:25,children:"25"}),r.jsx("option",{value:50,children:"50"}),r.jsx("option",{value:100,children:"100"})]})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[r.jsx("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Total"}),r.jsx("p",{className:"text-lg font-bold text-gray-900",children:D.length})]}),r.jsx(G,{className:"w-5 h-5 text-gray-500"})]})}),r.jsx("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-green-600 text-xs font-medium",children:"Active"}),r.jsx("p",{className:"text-lg font-bold text-green-900",children:D.filter(e=>e.isActive).length})]}),r.jsx(H,{className:"w-5 h-5 text-green-500"})]})}),r.jsx("div",{className:"bg-orange-50 p-3 rounded-lg border border-orange-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-orange-600 text-xs font-medium",children:"Undelivered"}),r.jsx("p",{className:"text-lg font-bold text-orange-900",children:D.filter(e=>"delivered"!==e.deliveryStatus).length})]}),r.jsx(je,{className:"w-5 h-5 text-orange-500"})]})}),r.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-red-600 text-xs font-medium",children:"Critical"}),r.jsx("p",{className:"text-lg font-bold text-red-900",children:D.filter(e=>"final"===e.level||"dismissal"===e.level).length})]}),r.jsx(B,{className:"w-5 h-5 text-red-500"})]})})]}),r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsxs("p",{className:"text-sm text-gray-600",children:[C.length," warnings ",C.length!==D.length&&`(filtered from ${D.length})`]}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs("span",{className:"text-xs text-gray-500",children:["Page ",_," of ",Me]})})]}),r.jsx("div",{className:"md:hidden space-y-3 mb-4",children:Re.map((e,t)=>r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:ha(e.employeeName)}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[ha(e.employeeNumber)," â€¢ ",ha(e.department)]})]}),r.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+("issued"===e.status?"bg-blue-100 text-blue-800":"acknowledged"===e.status?"bg-green-100 text-green-800":"appealed"===e.status?"bg-orange-100 text-orange-800":"expired"===e.status?"bg-gray-100 text-gray-800":"bg-gray-100 text-gray-600"),children:"issued"===e.status?"Issued":"acknowledged"===e.status?"Acknowledged":"appealed"===e.status?"Under Appeal":"expired"===e.status?"Expired":ha(e.status,"Pending")})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Level"}),r.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full mt-1 "+("counselling"===e.level?"bg-green-100 text-green-800":"verbal"===e.level?"bg-blue-100 text-blue-800":"first_written"===e.level?"bg-yellow-100 text-yellow-800":"second_written"===e.level?"bg-orange-100 text-orange-800":"final_written"===e.level?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:"counselling"===e.level?"Counselling":"verbal"===e.level?"Verbal":"first_written"===e.level?"1st Written":"second_written"===e.level?"2nd Written":"final_written"===e.level?"Final":ha(e.level,"Unknown")})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Category"}),r.jsx("p",{className:"text-sm font-medium text-gray-900 mt-1",children:ha(e.category)})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:[r.jsx("p",{className:"text-xs text-gray-500",children:e.issueDate?new Date(e.issueDate.seconds?1e3*e.issueDate.seconds:e.issueDate).toLocaleDateString():"N/A"}),r.jsx("button",{onClick:()=>Le(e),className:"text-blue-600 hover:text-blue-800 text-sm font-medium px-3 py-1.5 hover:bg-blue-50 rounded transition-colors",children:"View Details"})]})]},e.id||`warning-${t}`))}),r.jsx("div",{className:"hidden md:block bg-white rounded-lg border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wide",children:"Employee"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wide",children:"Warning"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wide",children:"Category"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wide",children:"Date"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wide",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wide",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:Re.map((e,s)=>r.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:ha(e.employeeName)}),r.jsxs("div",{className:"text-xs text-gray-500",children:[ha(e.employeeNumber)," â€¢ ",ha(e.department)]})]})}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+("counselling"===e.level?"bg-green-100 text-green-800":"verbal"===e.level?"bg-blue-100 text-blue-800":"first_written"===e.level?"bg-yellow-100 text-yellow-800":"second_written"===e.level?"bg-orange-100 text-orange-800":"final_written"===e.level?"bg-red-100 text-red-800":"written"===e.level?"bg-yellow-100 text-yellow-800":"final"===e.level||"dismissal"===e.level?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:"counselling"===e.level?"Counselling":"verbal"===e.level?"Verbal":"first_written"===e.level?"Written":"second_written"===e.level?"Second Written":"final_written"===e.level?"Final Written":"written"===e.level?"Written":"final"===e.level?"Final":"dismissal"===e.level?"Dismissal":ha(e.level,"Unknown")})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ha(e.category)}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:e.issueDate?new Date(e.issueDate.seconds?1e3*e.issueDate.seconds:e.issueDate).toLocaleDateString():"N/A"}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+("issued"===e.status?"bg-blue-100 text-blue-800":"acknowledged"===e.status?"bg-green-100 text-green-800":"appealed"===e.status?"bg-orange-100 text-orange-800":"expired"===e.status?"bg-gray-100 text-gray-800":"bg-gray-100 text-gray-600"),children:"issued"===e.status?"Issued":"acknowledged"===e.status?"Acknowledged":"appealed"===e.status?"Under Appeal":"expired"===e.status?"Expired":ha(e.status,"Pending")})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{onClick:()=>Le(e),className:"text-blue-600 hover:text-blue-800 text-xs px-2 py-1 hover:bg-blue-50 rounded transition-colors",children:"View"}),"appealed"===e.status&&r.jsxs("button",{onClick:()=>{Te(e),we(!0)},className:"text-purple-600 hover:text-purple-800 text-xs px-2 py-1 hover:bg-purple-50 rounded transition-colors flex items-center gap-1",title:"Review Appeal with Enhanced Decision Options",children:[r.jsx(pe,{className:"w-3 h-3"}),"Review Appeal"]}),"delivered"!==e.deliveryStatus&&"appealed"!==e.status&&r.jsx("button",{onClick:async()=>{try{t.debug("ðŸ“¬ Opening delivery method selection for warning:",e.id),oe(e),t.debug("ðŸ“‡ Fetching employee contact details for:",e.employeeId);const s=await d.employees.getById(e.employeeId,w);s?(ve({email:s.profile.email,phone:s.profile.phoneNumber||s.profile.whatsappNumber}),t.debug("âœ… Employee contact details fetched:",{email:s.profile.email,phone:s.profile.phoneNumber})):(t.warn("âš ï¸ Employee not found:",e.employeeId),ve({})),de(!0)}catch(s){t.error("âŒ Failed to fetch employee contact details:",s),ve({}),de(!0)}},className:"text-orange-600 hover:text-orange-800 text-xs px-2 py-1 hover:bg-orange-50 rounded transition-colors",children:"Deliver"}),"appealed"!==e.status&&fa(e)&&r.jsx("button",{onClick:()=>{t.debug("ðŸ“‹ Opening appeal modal for warning:",{id:e.id,employeeName:e.employeeName}),ye.open(e)},className:"text-amber-600 hover:text-amber-800 text-xs px-2 py-1 hover:bg-amber-50 rounded transition-colors",title:(()=>{const t=e.issueDate.seconds?new Date(1e3*e.issueDate.seconds):new Date(e.issueDate),s=new Date(t);return s.setDate(s.getDate()+30),`Appeal this warning (deadline: ${s.toLocaleDateString()})`})(),children:"Appeal"}),"appealed"!==e.status&&!fa(e)&&r.jsx("span",{className:"text-gray-500 text-xs px-2 py-1",title:"Appeal period has expired",children:"Appeal Expired"}),("acknowledged"===e.status||"expired"===e.status||!fa(e))&&r.jsx("button",{onClick:()=>$e(e.id),className:"text-gray-600 hover:text-gray-800 text-xs px-2 py-1 hover:bg-gray-50 rounded transition-colors",title:"Archive this warning",children:r.jsx(Se,{className:"w-3 h-3"})})]})})]},e.id||`warning-${s}`))})]})})}),0===C.length&&!T&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx(ge,{className:"w-8 h-8 text-gray-400 mx-auto mb-3"}),r.jsx("h3",{className:"text-md font-medium text-gray-900 mb-1",children:"No warnings found"}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:M||"all"!==U||"all"!==$||"all"!==V?"Try adjusting your search criteria or filters.":"No warnings have been created yet."}),(M||"all"!==U||"all"!==$||"all"!==V)&&r.jsx("button",{onClick:()=>{L(""),O("all"),W("all"),K("all")},className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Clear all filters"})]}),Me>1&&r.jsxs("div",{className:"flex items-center justify-center mt-4 gap-2",children:[r.jsx("button",{onClick:()=>R(Math.max(1,_-1)),disabled:1===_,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),r.jsxs("span",{className:"px-3 py-2 text-sm text-gray-600 bg-gray-50 rounded-lg",children:[_," of ",Me]}),r.jsx("button",{onClick:()=>R(Math.min(Me,_+1)),disabled:_===Me,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]}),ce&&le&&r.jsx(sa,{isOpen:ce,onClose:()=>{de(!1),xe(null),ve({})},onMethodSelected:async e=>{try{t.debug("ðŸ“ HR selected delivery method:",e),w&&le.deliveryNotificationId&&await ua.updateDeliveryMethod(w,le.deliveryNotificationId,e),xe(e),de(!1),he(!0)}catch(s){t.error("Failed to update delivery method:",s),alert("Failed to update delivery method. Please try again.")}},employeeRequestedMethod:le.employeeRequestedDeliveryMethod,employeeName:le.employeeName||"Unknown",employeeEmail:fe.email,employeePhone:fe.phone}),ue&&le&&me&&r.jsx(pa,{isOpen:ue,notification:{id:le.deliveryNotificationId||le.id,warningId:le.id,employeeName:le.employeeName||"Unknown",employeeEmail:fe.email,employeePhone:fe.phone,warningLevel:le.level||"counselling",warningCategory:le.category||"General",deliveryMethod:me,priority:"normal",status:"in_progress",createdAt:ga(le.issueDate),createdByName:le.createdByName||"Manager",pdfUrl:le.pdfUrl,contactDetails:{email:fe.email,phone:fe.phone}},onDeliveryComplete:async(e,s)=>{try{t.debug("âœ… Delivery completed:",s),await d.warnings.update(le.id,{status:"delivered",deliveredAt:s.deliveredAt,deliveryMethod:s.deliveryMethod,proofImage:s.proofImage},N?.id),await Ae(),b?.(),he(!1),oe(null),xe(null),ve({})}catch(a){throw t.error("Failed to complete delivery:",a),a}},onClose:()=>{he(!1),oe(null),xe(null),ve({})}}),le&&r.jsx(ta,{isOpen:ne,onClose:()=>{ie(!1),oe(null),ve({})},warningId:le.id||"",employeeName:le.employeeName||"Unknown",employeeEmail:fe.email,deliveryMethod:le.deliveryMethod||"email",warningData:le,onDeliveryConfirmed:async e=>{try{await d.warnings.updateDeliveryStatus(e.warningId,{status:"delivered",deliveredAt:e.deliveredAt,deliveryMethod:e.deliveryMethod,proofImage:e.proofImage}),await Ae(),ie(!1),oe(null),ve({})}catch(s){throw t.error("Failed to confirm delivery:",s),s}}}),ye.isOpen&&ye.data&&r.jsx(ra,{isOpen:ye.isOpen,onClose:ye.close,warning:{id:ye.data.id,employeeName:ye.data.employeeName,category:ye.data.category,level:ye.data.level,issueDate:ye.data.issueDate,description:ye.data.description||"No description provided"},onAppealSubmit:Ue}),Ne&&De&&r.jsx(oa,{isOpen:Ne,onClose:()=>{we(!1),Te(null)},warning:{id:De.id,employeeName:De.employeeName,employeeNumber:De.employeeNumber,category:De.category,level:De.level,issueDate:De.issueDate,description:De.description||"No description provided",appealDetails:De.appealDetails},onDecisionSubmit:Oe})]})]})},ya=Object.freeze(Object.defineProperty({__proto__:null,WarningsReviewDashboard:va,default:va},Symbol.toStringTag,{value:"Module"}));export{xa as E,Xs as P,ya as R,Ie as a,qs as i,Zs as p,Te as u};
