import{u as e,a as s,j as a,A as t,L as l,k as i,D as o}from"./business-owner-dashboard-DOtdDQPt.js";import{r}from"./react-vendor-BMk1H4su.js";import{U as n}from"./UniversalEmployeeSelector-zGtNx42b.js";import{X as d,s as c,n as m,t as h,F as u}from"./ui-vendor-DcCoi79t.js";import"./pdf-vendor-CbrIsI36.js";import"./firebase-vendor-BIBOIkWK.js";const x=({isOpen:x,onClose:N})=>{const{user:p}=e(),{organization:j}=s(),[v,f]=r.useState(null),[b,_]=r.useState(""),[g,y]=r.useState(""),[w,S]=r.useState(""),[k,C]=r.useState(null),[q,R]=r.useState(!1),[E,H]=r.useState(!1),[M,D]=r.useState(null),[F,T]=r.useState(!1),[U,I]=r.useState([]);r.useEffect(()=>{x&&(async()=>{if(p?.id&&j?.id)try{const e=(await t.employees.getByManager(p.id,j.id)).map(e=>({id:e.id,firstName:e.profile?.firstName||e.firstName||"Unknown",lastName:e.profile?.lastName||e.lastName||"Employee",position:e.profile?.position||e.employment?.position||"Unknown Position",department:e.profile?.department||e.employment?.department||"Unknown",email:e.profile?.email||e.contact?.email||e.email||"",...e}));I(e)}catch(e){l.error("Failed to load employees:",e),D("Failed to load employees")}})()},[p?.id,j?.id,x]);const $=()=>v&&b.trim().length>=20;return r.useEffect(()=>{x||(f(null),_(""),y(""),S(""),C(null),R(!1),D(null),T(!1))},[x]),F?x?a.jsx("div",{className:"modal-system",children:a.jsxs("div",{className:"modal-container",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("div",{className:"modal-header__left",children:a.jsxs("div",{children:[a.jsx("h2",{className:"modal-header__title",children:"Meeting Request Submitted"}),a.jsx("p",{className:"modal-header__subtitle",children:"HR will be notified and will schedule the meeting"})]})}),a.jsx("button",{onClick:N,className:"modal-header__close-button",children:a.jsx(d,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"modal-content",children:a.jsx("div",{className:"modal-content__scrollable",children:a.jsxs("div",{className:"p-4 sm:p-6 text-center",children:[a.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full mb-6 bg-green-100",children:a.jsx(c,{className:"h-8 w-8 text-green-600"})}),a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Meeting Request Submitted"}),a.jsxs("p",{className:"mb-6 text-gray-600",children:["Your meeting request for ",v?.firstName," ",v?.lastName," has been successfully submitted to HR. They will review the request and schedule the meeting accordingly."]}),a.jsxs("div",{className:"flex items-start gap-3 p-3 rounded",style:{backgroundColor:"var(--color-info-bg)",border:"1px solid var(--color-primary)"},children:[a.jsx(m,{className:"w-5 h-5 shrink-0 mt-0.5",style:{color:"var(--color-primary)"}}),a.jsx("div",{className:"flex-1",children:a.jsx("span",{className:"text-sm",style:{color:"var(--color-text)"},children:"You will receive notification once the meeting is scheduled"})})]})]})})}),a.jsx("div",{className:"modal-footer",children:a.jsx("div",{className:"modal-footer__nav",children:a.jsx("button",{onClick:N,className:"modal-footer__button modal-footer__button--primary",children:"Close"})})})]})}):null:x?a.jsx("div",{className:"modal-system",children:a.jsxs("div",{className:"modal-container",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("div",{className:"modal-header__left",children:a.jsxs("div",{children:[a.jsx("h2",{className:"modal-header__title",children:"Book HR Meeting"}),a.jsx("p",{className:"modal-header__subtitle",children:"Schedule intervention meeting with HR"})]})}),a.jsx("button",{onClick:N,className:"modal-header__close-button",children:a.jsx(d,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"modal-header__center",children:a.jsx("div",{className:"modal-header__progress-mobile modal-responsive-hide-mobile",children:a.jsx("div",{className:"mobile-step-indicator",children:a.jsx("div",{className:"mobile-step-dots",children:a.jsx("div",{className:"mobile-step-dot mobile-step-dot--active",children:"1"})})})})}),a.jsx("div",{className:"modal-content",children:a.jsx("div",{className:"modal-content__scrollable",children:a.jsxs("div",{className:"space-y-4",children:[M&&a.jsxs("div",{className:"flex items-start gap-3 p-3 rounded",style:{backgroundColor:"var(--color-error-bg)",border:"1px solid var(--color-error)"},children:[a.jsx(h,{className:"w-5 h-5 shrink-0 mt-0.5",style:{color:"var(--color-error)"}}),a.jsx("div",{className:"flex-1",children:a.jsx("span",{style:{color:"var(--color-text)"},children:M})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx(n,{employees:U,selectedEmployeeId:v?.id||null,onEmployeeSelect:e=>{const s=U.find(s=>s.id===e);f(s||null)},title:"Select Employee",subtitle:"Choose the team member for this HR meeting"}),a.jsxs("div",{className:"form-section",children:[a.jsxs("div",{className:"unified-section-header",children:[a.jsx("div",{className:"unified-section-header__icon",children:a.jsx(u,{className:"w-5 h-5"})}),a.jsxs("div",{className:"unified-section-header__content",children:[a.jsx("h3",{className:"unified-section-header__title",children:"Meeting Context"}),a.jsx("p",{className:"unified-section-header__subtitle",children:"Describe the situation that requires HR intervention"})]})]}),a.jsx("textarea",{value:b,onChange:e=>_(e.target.value),placeholder:"Describe the situation that requires HR intervention...",className:"unified-field-input",rows:4,minLength:20,maxLength:1e3}),a.jsxs("div",{className:"unified-field-hint",children:[b.length,"/1000 characters (minimum 20)"]})]})]})]})})}),a.jsx("div",{className:"modal-footer",children:a.jsxs("div",{className:"modal-footer__nav",children:[a.jsx("button",{onClick:N,className:"modal-footer__button modal-footer__button--secondary",children:"Cancel"}),a.jsx("button",{onClick:async()=>{if(p&&v&&j?.id&&$())try{H(!0),D(null);const e={organizationId:j.id,managerId:p.id,managerName:`${p.firstName} ${p.lastName}`,employeeId:v.id,employeeName:`${v.firstName} ${v.lastName}`,context:b.trim(),employeeConsent:!1,status:"pending",requestDate:i.getServerTimestamp(),createdAt:i.getServerTimestamp(),updatedAt:i.getServerTimestamp()};await o.createDocument(j.id,"meetings",e),T(!0),setTimeout(()=>{N()},3e3)}catch(e){l.error("Failed to submit meeting request:",e),D("Failed to submit meeting request. Please try again.")}finally{H(!1)}},disabled:!$()||E,className:"modal-footer__button modal-footer__button--primary "+(E?"modal-footer__button--loading":""),children:"Submit Meeting Request"})]})})]})}):null};export{x as UnifiedBookHRMeeting};
