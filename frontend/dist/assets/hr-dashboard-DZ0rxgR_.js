const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PDFGenerationService-Cg7oHxh4.js","assets/pdf-vendor-tUwojRr6.js","assets/business-owner-dashboard-Cigg9BdB.js","assets/react-vendor-CWjEGAcE.js","assets/firebase-vendor-Cc210LOb.js","assets/ui-vendor-B2Ap5xvl.js"])))=>i.map(i=>d[i]);
import{u as e,a as t,L as s,d as a,D as r,b as n,s as i,j as l,c as o,e as c,T as d,U as m,f as x,g as h,h as u,i as g,k as p,l as y,E as f,m as v}from"./business-owner-dashboard-Cigg9BdB.js";import{r as b,b as j,u as N}from"./react-vendor-CWjEGAcE.js";import{q as w,l as k,t as C,C as S,E as D,G as T,H as E,x as I,p as P,L as A,I as R,_ as M,J as _,K as F,M as L,N as U,O as z,P as O,Q as W,R as $,S as q}from"./firebase-vendor-Cc210LOb.js";import{WarningsReviewDashboard as H}from"./warning-components-H-WSija0.js";import{a as B}from"./pdf-vendor-tUwojRr6.js";import{Y as V,X as G,D as Q,b as K,R as Y,Z as J,_ as X,a as Z,$ as ee,e as te,f as se,i as ae,Q as re,a0 as ne,U as ie,w as le,a1 as oe,L as ce,F as de,I as me,a2 as xe,a3 as he,C as ue,p as ge,a4 as pe,k as ye,a5 as fe,a6 as ve,a7 as be,v as je,a8 as Ne,z as we,a9 as ke,M as Ce,aa as Se,ab as De,ac as Te,ad as Ee,ae as Ie,af as Pe,ag as Ae,J as Re,O as Me}from"./ui-vendor-B2Ap5xvl.js";class _e{static{this.EXPIRY_HOURS=1}static async generateTemporaryLink(e){e.filename,e.pdfBlob.size,e.employeeId,e.warningId,e.organizationId;try{const t=n.currentUser;if(!t)throw s.error("❌ [TemporaryLinkService] User not authenticated"),new Error("User not authenticated");s.success(2228);const a=this.generateTokenId(),r=Date.now(),l=Math.random().toString(36).substr(2,12),o=e.filename.replace(/[^a-zA-Z0-9.-]/g,"_"),c=`temp-downloads/${e.organizationId||"default"}/${r}_${l}_${o}`,d=D(i,c),m={contentType:"application/pdf",customMetadata:{organizationId:e.organizationId||"",employeeId:e.employeeId||"",warningId:e.warningId||"",filename:e.filename,tokenId:a,createdAt:(new Date).toISOString(),size:e.pdfBlob.size.toString(),uploadedBy:t.uid,purpose:"temporary-download"}};await T(d,e.pdfBlob,m);const x=await E(d),h=new Date(Date.now()+60*this.EXPIRY_HOURS*60*1e3);await this.trackTemporaryFile({tokenId:a,storagePath:c,downloadUrl:x,filename:e.filename,organizationId:e.organizationId,employeeId:e.employeeId,warningId:e.warningId,uploadedBy:t.uid,expiresAt:h,createdAt:new Date}),s.success(4558);const u=await this.generateQRCode(x),g=new Date(Date.now()+60*this.EXPIRY_HOURS*60*1e3);return g.toISOString(),x.substring(0,60),{downloadUrl:x,qrCodeData:u,expiresAt:g.toISOString(),tokenId:a,filename:e.filename}}catch(t){throw s.error("❌ [TemporaryLinkService] Failed to generate temporary link:",t),new Error(`Failed to generate temporary link: ${t instanceof Error?t.message:"Unknown error"}`)}}static async validateTemporaryToken(e){return!0}static async revokeTemporaryToken(e){return!0}static generateTokenId(){return`tmp_${Date.now()}_${Math.random().toString(36).substr(2,12)}`}static async blobToBase64(e){return new Promise((t,s)=>{const a=new FileReader;a.onload=()=>{const e=a.result;t(e.split(",")[1])},a.onerror=s,a.readAsDataURL(e)})}static async generateQRCode(e){try{const t=`${"https://api.qrserver.com/v1/create-qr-code/"}?${new URLSearchParams({size:"300x300",data:e,format:"png",ecc:"M",margin:"10"}).toString()}`,s=await fetch(t);if(!s.ok)throw new Error("QR code generation failed");const a=await s.blob();return new Promise((e,t)=>{const s=new FileReader;s.onload=()=>e(s.result),s.onerror=t,s.readAsDataURL(a)})}catch(t){return s.error("❌ QR Code generation failed:",t),`data:text/plain;base64,${btoa(e)}`}}static formatExpiryTime(e){const t=new Date(e),s=new Date,a=t.getTime()-s.getTime();if(a<=0)return"Expired";const r=Math.floor(a/6e4),n=Math.floor(r/60),i=r%60;return n>0?`${n}h ${i}m remaining`:`${i}m remaining`}static isExpired(e){return new Date(e).getTime()<=Date.now()}static async trackTemporaryFile(e){try{await I(k(a,"temporaryFiles"),{tokenId:e.tokenId,storagePath:e.storagePath,downloadUrl:e.downloadUrl,filename:e.filename,fileType:"pdf",organizationId:e.organizationId||"",employeeId:e.employeeId||"",warningId:e.warningId||"",uploadedBy:e.uploadedBy,expiresAt:e.expiresAt,createdAt:P(),isExpired:!1,fileSize:0}),s.success(10578)}catch(t){s.error("❌ [TemporaryLinkService] Failed to track temporary file:",t)}}}const Fe=({isOpen:e,onClose:t,pdfBlob:a,filename:r,employeeId:n,warningId:i,organizationId:o,employeeName:c,onLinkGenerated:d})=>{const[m,x]=b.useState(!1),[h,u]=b.useState(null),[g,p]=b.useState(null),[y,f]=b.useState({hours:0,minutes:0,seconds:0,expired:!1}),[v,j]=b.useState(!1),N=b.useCallback(async()=>{if(a&&(a.size/1024).toFixed(1),a)try{x(!0),p(null);const e=await _e.generateTemporaryLink({pdfBlob:a,filename:r,employeeId:n,warningId:i,organizationId:o});s.success(2764),u(e),d?.(e)}catch(e){s.error("❌ QR link generation failed:",e),p(e.message||"Failed to generate QR code")}finally{x(!1)}else s.error("❌ [QRCodeDownloadModal] No PDF blob provided")},[a,r,n,i,o,d]);b.useEffect(()=>{if(!h?.expiresAt)return;const e=()=>{const e=(new Date).getTime(),t=new Date(h.expiresAt).getTime()-e;if(t<=0)return void f({hours:0,minutes:0,seconds:0,expired:!0});const s=Math.floor(t/36e5),a=Math.floor(t%36e5/6e4),r=Math.floor(t%6e4/1e3);f({hours:s,minutes:a,seconds:r,expired:!1})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[h?.expiresAt]);const w=b.useCallback(async()=>{if(h?.downloadUrl)try{await navigator.clipboard.writeText(h.downloadUrl),j(!0),setTimeout(()=>j(!1),2e3)}catch(e){s.error("❌ Failed to copy link:",e)}},[h?.downloadUrl]),k=b.useCallback(async()=>{if(h?.tokenId)try{await _e.revokeTemporaryToken(h.tokenId),u(null),f({hours:0,minutes:0,seconds:0,expired:!1})}catch(e){s.error("❌ Failed to revoke link:",e)}},[h?.tokenId]),C=b.useCallback(()=>{h?.downloadUrl&&window.open(h.downloadUrl,"_blank")},[h?.downloadUrl]);return b.useEffect(()=>{e&&a&&!h&&!m&&N()},[e,a,h,m,N]),b.useEffect(()=>{e||(u(null),p(null),f({hours:0,minutes:0,seconds:0,expired:!1}),j(!1))},[e]),e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"bg-white/20 p-2 rounded-lg",children:l.jsx(V,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-semibold",children:"Mobile Download"}),l.jsx("p",{className:"text-blue-100 text-sm",children:"Scan to download on your phone"})]})]}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:l.jsx(G,{className:"w-5 h-5"})})]})}),l.jsxs("div",{className:"p-6 max-h-[calc(90vh-120px)] overflow-y-auto",children:[l.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:l.jsx(Q,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:"font-medium text-gray-900 truncate",children:r}),c&&l.jsxs("p",{className:"text-sm text-gray-600",children:["For: ",c]}),l.jsxs("p",{className:"text-xs text-gray-500",children:["Size: ",(a.size/1024).toFixed(1)," KB"]})]})]})}),m&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Generating secure download link..."}),l.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This may take a moment"})]}),g&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(K,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-red-800 font-medium",children:"Generation Failed"}),l.jsx("p",{className:"text-red-700 text-sm",children:g})]})]}),l.jsxs("button",{onClick:N,className:"mt-3 flex items-center space-x-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",disabled:m,children:[l.jsx(Y,{className:"w-4 h-4"}),l.jsx("span",{children:"Try Again"})]})]}),h&&!y.expired&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(J,{className:"w-5 h-5 text-amber-500"}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-amber-800 font-medium",children:"Time-Limited Access"}),l.jsxs("p",{className:"text-amber-700 text-sm",children:["Link expires in: ",y.hours>0&&`${y.hours}h `,y.minutes,"m ",y.seconds,"s"]})]})]})}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"bg-white p-6 rounded-xl border-2 border-gray-200 inline-block",children:l.jsx("img",{src:h.qrCodeData,alt:"Download QR Code",className:"w-64 h-64 mx-auto",style:{imageRendering:"pixelated"}})}),l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"flex items-center justify-center space-x-2 text-gray-600 mb-2",children:[l.jsx(X,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm",children:"Point your camera at the QR code"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"No app needed - works with built-in camera on iOS & Android"})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("button",{onClick:w,className:"w-full flex items-center justify-center space-x-3 bg-gray-100 text-gray-700 px-4 py-3 rounded-lg hover:bg-gray-200 transition-colors",children:v?l.jsxs(l.Fragment,{children:[l.jsx(Z,{className:"w-5 h-5 text-green-500"}),l.jsx("span",{children:"Link Copied!"})]}):l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-5 h-5"}),l.jsx("span",{children:"Copy Download Link"})]})}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{onClick:C,className:"flex items-center justify-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[l.jsx(te,{className:"w-4 h-4"}),l.jsx("span",{children:"Test Link"})]}),l.jsxs("button",{onClick:k,className:"flex items-center justify-center space-x-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",children:[l.jsx(se,{className:"w-4 h-4"}),l.jsx("span",{children:"Revoke"})]})]})]}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(ae,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-blue-800 font-medium text-sm",children:"Security Features"}),l.jsxs("ul",{className:"text-blue-700 text-xs mt-1 space-y-1",children:[l.jsx("li",{children:"• Link expires automatically in 1 hour"}),l.jsx("li",{children:"• Single-use download link"}),l.jsx("li",{children:"• Encrypted token authentication"}),l.jsx("li",{children:"• Can be revoked instantly"})]})]})]})})]}),h&&y.expired&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"bg-red-100 p-4 rounded-full w-16 h-16 mx-auto mb-4",children:l.jsx(re,{className:"w-8 h-8 text-red-500 mx-auto"})}),l.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Link Expired"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"The download link has expired for security reasons."}),l.jsx("button",{onClick:N,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",disabled:m,children:"Generate New Link"})]})]})]})}):null};var Le,Ue,ze=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},Oe=function(e){if("loading"===document.readyState)return"loading";var t=ze();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},We=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},$e=function(e,t){var s="";try{for(;e&&9!==e.nodeType;){var a=e,r=a.id?"#"+a.id:We(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(s.length+r.length>(t||100)-1)return s||r;if(s=s?r+">"+s:r,a.id)break;e=a.parentNode}}catch(e){}return s},qe=-1,He=function(e){addEventListener("pageshow",function(t){t.persisted&&(qe=t.timeStamp,e(t))},!0)},Be=function(){var e=ze();return e&&e.activationStart||0},Ve=function(e,t){var s=ze(),a="navigate";return qe>=0?a="back-forward-cache":s&&(document.prerendering||Be()>0?a="prerender":document.wasDiscarded?a="restore":s.type&&(a=s.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},Ge=function(e,t,s){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var a=new PerformanceObserver(function(e){Promise.resolve().then(function(){t(e.getEntries())})});return a.observe(Object.assign({type:e,buffered:!0},s||{})),a}}catch(e){}},Qe=function(e,t,s,a){var r,n;return function(i){t.value>=0&&(i||a)&&((n=t.value-(r||0))||void 0===r)&&(r=t.value,t.delta=n,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,s),e(t))}},Ke=function(e){requestAnimationFrame(function(){return requestAnimationFrame(function(){return e()})})},Ye=function(e){document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e()})},Je=function(e){var t=!1;return function(){t||(e(),t=!0)}},Xe=-1,Ze=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},et=function(e){"hidden"===document.visibilityState&&Xe>-1&&(Xe="visibilitychange"===e.type?e.timeStamp:0,st())},tt=function(){addEventListener("visibilitychange",et,!0),addEventListener("prerenderingchange",et,!0)},st=function(){removeEventListener("visibilitychange",et,!0),removeEventListener("prerenderingchange",et,!0)},at=function(){return Xe<0&&(Xe=Ze(),tt(),He(function(){setTimeout(function(){Xe=Ze(),tt()},0)})),{get firstHiddenTime(){return Xe}}},rt=function(e){document.prerendering?addEventListener("prerenderingchange",function(){return e()},!0):e()},nt=[1800,3e3],it=[.1,.25],lt=function(e,t){!function(e,t){t=t||{},function(e,t){t=t||{},rt(function(){var s,a=at(),r=Ve("FCP"),n=Ge("paint",function(e){e.forEach(function(e){"first-contentful-paint"===e.name&&(n.disconnect(),e.startTime<a.firstHiddenTime&&(r.value=Math.max(e.startTime-Be(),0),r.entries.push(e),s(!0)))})});n&&(s=Qe(e,r,nt,t.reportAllChanges),He(function(a){r=Ve("FCP"),s=Qe(e,r,nt,t.reportAllChanges),Ke(function(){r.value=performance.now()-a.timeStamp,s(!0)})}))})}(Je(function(){var s,a=Ve("CLS",0),r=0,n=[],i=function(e){e.forEach(function(e){if(!e.hadRecentInput){var t=n[0],s=n[n.length-1];r&&e.startTime-s.startTime<1e3&&e.startTime-t.startTime<5e3?(r+=e.value,n.push(e)):(r=e.value,n=[e])}}),r>a.value&&(a.value=r,a.entries=n,s())},l=Ge("layout-shift",i);l&&(s=Qe(e,a,it,t.reportAllChanges),Ye(function(){i(l.takeRecords()),s(!0)}),He(function(){r=0,a=Ve("CLS",0),s=Qe(e,a,it,t.reportAllChanges),Ke(function(){return s()})}),setTimeout(s,0))}))}(function(t){var s=function(e){var t,s={};if(e.entries.length){var a=e.entries.reduce(function(e,t){return e&&e.value>t.value?e:t});if(a&&a.sources&&a.sources.length){var r=(t=a.sources).find(function(e){return e.node&&1===e.node.nodeType})||t[0];r&&(s={largestShiftTarget:$e(r.node),largestShiftTime:a.startTime,largestShiftValue:a.value,largestShiftSource:r,largestShiftEntry:a,loadState:Oe(a.startTime)})}}return Object.assign(e,{attribution:s})}(t);e(s)},t)},ot=0,ct=1/0,dt=0,mt=function(e){e.forEach(function(e){e.interactionId&&(ct=Math.min(ct,e.interactionId),dt=Math.max(dt,e.interactionId),ot=dt?(dt-ct)/7+1:0)})},xt=function(){return Le?ot:performance.interactionCount||0},ht=function(){"interactionCount"in performance||Le||(Le=Ge("event",mt,{type:"event",buffered:!0,durationThreshold:0}))},ut=[],gt=new Map,pt=0,yt=[],ft=function(e){if(yt.forEach(function(t){return t(e)}),e.interactionId||"first-input"===e.entryType){var t=ut[ut.length-1],s=gt.get(e.interactionId);if(s||ut.length<10||e.duration>t.latency){if(s)e.duration>s.latency?(s.entries=[e],s.latency=e.duration):e.duration===s.latency&&e.startTime===s.entries[0].startTime&&s.entries.push(e);else{var a={id:e.interactionId,latency:e.duration,entries:[e]};gt.set(a.id,a),ut.push(a)}ut.sort(function(e,t){return t.latency-e.latency}),ut.length>10&&ut.splice(10).forEach(function(e){return gt.delete(e.id)})}}},vt=function(e){var t=self.requestIdleCallback||self.setTimeout,s=-1;return e=Je(e),"hidden"===document.visibilityState?e():(s=t(e),Ye(e)),s},bt=[200,500],jt=function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},rt(function(){var s;ht();var a,r=Ve("INP"),n=function(e){vt(function(){e.forEach(ft);var t=function(){var e=Math.min(ut.length-1,Math.floor((xt()-pt)/50));return ut[e]}();t&&t.latency!==r.value&&(r.value=t.latency,r.entries=t.entries,a())})},i=Ge("event",n,{durationThreshold:null!==(s=t.durationThreshold)&&void 0!==s?s:40});a=Qe(e,r,bt,t.reportAllChanges),i&&(i.observe({type:"first-input",buffered:!0}),Ye(function(){n(i.takeRecords()),a(!0)}),He(function(){pt=xt(),ut.length=0,gt.clear(),r=Ve("INP"),a=Qe(e,r,bt,t.reportAllChanges)}))}))},Nt=[],wt=[],kt=0,Ct=new WeakMap,St=new Map,Dt=-1,Tt=function(e){Nt=Nt.concat(e),Et()},Et=function(){Dt<0&&(Dt=vt(It))},It=function(){St.size>10&&St.forEach(function(e,t){gt.has(t)||St.delete(t)});var e=ut.map(function(e){return Ct.get(e.entries[0])}),t=wt.length-50;wt=wt.filter(function(s,a){return a>=t||e.includes(s)});for(var s=new Set,a=0;a<wt.length;a++){var r=wt[a];Pt(r.startTime,r.processingEnd).forEach(function(e){s.add(e)})}var n=Nt.length-1-50;Nt=Nt.filter(function(e,t){return e.startTime>kt&&t>n||s.has(e)}),Dt=-1};yt.push(function(e){e.interactionId&&e.target&&!St.has(e.interactionId)&&St.set(e.interactionId,e.target)},function(e){var t,s=e.startTime+e.duration;kt=Math.max(kt,e.processingEnd);for(var a=wt.length-1;a>=0;a--){var r=wt[a];if(Math.abs(s-r.renderTime)<=8){(t=r).startTime=Math.min(e.startTime,t.startTime),t.processingStart=Math.min(e.processingStart,t.processingStart),t.processingEnd=Math.max(e.processingEnd,t.processingEnd),t.entries.push(e);break}}t||(t={startTime:e.startTime,processingStart:e.processingStart,processingEnd:e.processingEnd,renderTime:s,entries:[e]},wt.push(t)),(e.interactionId||"first-input"===e.entryType)&&Ct.set(e,t),Et()});var Pt=function(e,t){for(var s,a=[],r=0;s=Nt[r];r++)if(!(s.startTime+s.duration<e)){if(s.startTime>t)break;a.push(s)}return a},At=function(e,t){Ue||(Ue=Ge("long-animation-frame",Tt)),jt(function(t){var s=function(e){var t=e.entries[0],s=Ct.get(t),a=t.processingStart,r=s.processingEnd,n=s.entries.sort(function(e,t){return e.processingStart-t.processingStart}),i=Pt(t.startTime,r),l=e.entries.find(function(e){return e.target}),o=l&&l.target||St.get(t.interactionId),c=[t.startTime+t.duration,r].concat(i.map(function(e){return e.startTime+e.duration})),d=Math.max.apply(Math,c),m={interactionTarget:$e(o),interactionTargetElement:o,interactionType:t.name.startsWith("key")?"keyboard":"pointer",interactionTime:t.startTime,nextPaintTime:d,processedEventEntries:n,longAnimationFrameEntries:i,inputDelay:a-t.startTime,processingDuration:r-a,presentationDelay:Math.max(d-r,0),loadState:Oe(t.startTime)};return Object.assign(e,{attribution:m})}(t);e(s)},t)},Rt=[2500,4e3],Mt={},_t=function(e,t){!function(e,t){t=t||{},rt(function(){var s,a=at(),r=Ve("LCP"),n=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach(function(e){e.startTime<a.firstHiddenTime&&(r.value=Math.max(e.startTime-Be(),0),r.entries=[e],s())})},i=Ge("largest-contentful-paint",n);if(i){s=Qe(e,r,Rt,t.reportAllChanges);var l=Je(function(){Mt[r.id]||(n(i.takeRecords()),i.disconnect(),Mt[r.id]=!0,s(!0))});["keydown","click"].forEach(function(e){addEventListener(e,function(){return vt(l)},{once:!0,capture:!0})}),Ye(l),He(function(a){r=Ve("LCP"),s=Qe(e,r,Rt,t.reportAllChanges),Ke(function(){r.value=performance.now()-a.timeStamp,Mt[r.id]=!0,s(!0)})})}})}(function(t){var s=function(e){var t={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:e.value};if(e.entries.length){var s=ze();if(s){var a=s.activationStart||0,r=e.entries[e.entries.length-1],n=r.url&&performance.getEntriesByType("resource").filter(function(e){return e.name===r.url})[0],i=Math.max(0,s.responseStart-a),l=Math.max(i,n?(n.requestStart||n.startTime)-a:0),o=Math.max(l,n?n.responseEnd-a:0),c=Math.max(o,r.startTime-a);t={element:$e(r.element),timeToFirstByte:i,resourceLoadDelay:l-i,resourceLoadDuration:o-l,elementRenderDelay:c-o,navigationEntry:s,lcpEntry:r},r.url&&(t.url=r.url),n&&(t.lcpResourceEntry=n)}}return Object.assign(e,{attribution:t})}(t);e(s)},t)};const Ft="@firebase/performance",Lt="0.7.7",Ut=Lt,zt="FB-PERF-TRACE-MEASURE",Ot="_wt_",Wt="_fcp",$t="_fid",qt="_lcp",Ht="_inp",Bt="_cls",Vt="@firebase/performance/config",Gt="@firebase/performance/configexpire",Qt="Performance",Kt=new L("performance",Qt,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),Yt=new A(Qt);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Jt,Xt,Zt,es;Yt.logLevel=R.INFO;class ts{constructor(e){if(this.window=e,!e)throw Kt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=_t,this.onINP=At,this.onCLS=lt}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,s){this.performance&&this.performance.measure&&this.performance.measure(e,t,s)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&z()?!!O()||(Yt.info("IndexedDB is not supported by current browser"),!1):(Yt.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(e=>{for(const s of e.getEntries())t(s)}).observe({entryTypes:[e]})}static getInstance(){return void 0===Jt&&(Jt=new ts(Xt)),Jt}}function ss(){return Zt}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function as(e,t){const s=e.length-t.length;if(s<0||s>1)throw Kt.create("invalid String merger input");const a=[];for(let r=0;r<e.length;r++)a.push(e.charAt(r)),t.length>r&&a.push(t.charAt(r));return a.join("")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=as("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=as("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===es&&(es=new rs),es}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ns;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}(ns||(ns={}));const is=["firebase_","google_","ga_"],ls=new RegExp("^[a-zA-Z]\\w*$");function os(){const e=ts.getInstance().navigator;return(null==e?void 0:e.serviceWorker)?e.serviceWorker.controller?2:3:1}function cs(){switch(ts.getInstance().document.visibilityState){case"visible":return ns.VISIBLE;case"hidden":return ns.HIDDEN;default:return ns.UNKNOWN}}function ds(){const e=ts.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ms(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.appId;if(!s)throw Kt.create("no app id");return s}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const xs="0.0.1",hs={loggingEnabled:!0},us="FIREBASE_INSTALLATIONS_AUTH";function gs(e,t){const s=function(){const e=ts.getInstance().localStorage;if(!e)return;const t=e.getItem(Gt);if(!(t&&(s=t,Number(s)>Date.now())))return;var s;const a=e.getItem(Vt);if(!a)return;try{return JSON.parse(a)}catch(r){return}}();return s?(ys(s),Promise.resolve()):function(e,t){return function(e){const t=e.getToken();return t.then(e=>{}),t}(e.installations).then(s=>{const a=function(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!s)throw Kt.create("no project id");return s}(e.app),r=function(e){var t;const s=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!s)throw Kt.create("no api key");return s}(e.app),n=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${r}`,{method:"POST",headers:{Authorization:`${us} ${s}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:s,app_id:ms(e.app),app_version:Ut,sdk_version:xs})});return fetch(n).then(e=>{if(e.ok)return e.json();throw Kt.create("RC response not ok")})}).catch(()=>{Yt.info(ps)})}(e,t).then(ys).then(e=>function(e){const t=ts.getInstance().localStorage;if(!e||!t)return;t.setItem(Vt,JSON.stringify(e)),t.setItem(Gt,String(Date.now()+60*rs.getInstance().configTimeToLive*60*1e3))}(e),()=>{})}const ps="Could not fetch config, will use default configs";function ys(e){if(!e)return e;const t=rs.getInstance(),s=e.entries||{};return void 0!==s.fpr_enabled?t.loggingEnabled="true"===String(s.fpr_enabled):t.loggingEnabled=hs.loggingEnabled,s.fpr_log_source?t.logSource=Number(s.fpr_log_source):hs.logSource&&(t.logSource=hs.logSource),s.fpr_log_endpoint_url?t.logEndPointUrl=s.fpr_log_endpoint_url:hs.logEndPointUrl&&(t.logEndPointUrl=hs.logEndPointUrl),s.fpr_log_transport_key?t.transportKey=s.fpr_log_transport_key:hs.transportKey&&(t.transportKey=hs.transportKey),void 0!==s.fpr_vc_network_request_sampling_rate?t.networkRequestsSamplingRate=Number(s.fpr_vc_network_request_sampling_rate):void 0!==hs.networkRequestsSamplingRate&&(t.networkRequestsSamplingRate=hs.networkRequestsSamplingRate),void 0!==s.fpr_vc_trace_sampling_rate?t.tracesSamplingRate=Number(s.fpr_vc_trace_sampling_rate):void 0!==hs.tracesSamplingRate&&(t.tracesSamplingRate=hs.tracesSamplingRate),t.logTraceAfterSampling=fs(t.tracesSamplingRate),t.logNetworkAfterSampling=fs(t.networkRequestsSamplingRate),e}function fs(e){return Math.random()<=e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vs,bs=1;function js(e){return bs=2,vs=vs||function(e){return function(){const e=ts.getInstance().document;return new Promise(t=>{if(e&&"complete"!==e.readyState){const s=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",s),t())};e.addEventListener("readystatechange",s)}else t()})}().then(()=>function(e){const t=e.getId();return t.then(e=>{Zt=e}),t}(e.installations)).then(t=>gs(e,t)).then(()=>Ns(),()=>Ns())}(e),vs}function Ns(){bs=3}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ws,ks=3,Cs=[],Ss=!1;function Ds(e){setTimeout(()=>{ks<=0||(Cs.length>0&&Ts(),Ds(1e4))},e)}function Ts(){const e=Cs.splice(0,1e3),t=e.map(e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)}));(function(e){const t=rs.getInstance().getFlTransportFullUrl(),s=JSON.stringify(e);return navigator.sendBeacon&&navigator.sendBeacon(t,s)?Promise.resolve():fetch(t,{method:"POST",body:s,keepalive:!0}).then()})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:rs.getInstance().logSource,log_event:t}).then(()=>{ks=3}).catch(()=>{Cs=[...e,...Cs],ks--,Yt.info(`Tries left: ${ks}.`),Ds(1e4)})}function Es(e){return(...t)=>{!function(e){if(!e.eventTime||!e.message)throw Kt.create("invalid cc log");Cs=[...Cs,e]}({message:e(...t),eventTime:Date.now()})}}function Is(){for(;Cs.length>0;)Ts()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(e,t){ws||(ws={send:Es(Ms),flush:Is}),ws.send(e,t)}function As(e){const t=rs.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&ts.getInstance().requiredApisAvailable()&&(3===bs?Rs(e):js(e.performanceController).then(()=>Rs(e),()=>Rs(e)))}function Rs(e){if(!ss())return;const t=rs.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&Ps(e,1)}function Ms(e,t){return 0===t?function(e){const t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},s={application_info:_s(e.performanceController.app),network_request_metric:t};return JSON.stringify(s)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);const s=e.getAttributes();0!==Object.keys(s).length&&(t.custom_attributes=s);const a={application_info:_s(e.performanceController.app),trace_metric:t};return JSON.stringify(a)}(e)}function _s(e){return{google_app_id:ms(e),app_instance_id:ss(),web_app_info:{sdk_version:Ut,page_url:ts.getInstance().getUrl(),service_worker_status:os(),visibility_state:cs(),effective_connection_type:ds()},application_process_state:0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(e,t){const s=t;if(!s||void 0===s.responseStart)return;const a=ts.getInstance().getTimeOrigin(),r=Math.floor(1e3*(s.startTime+a)),n=s.responseStart?Math.floor(1e3*(s.responseStart-s.startTime)):void 0,i=Math.floor(1e3*(s.responseEnd-s.startTime));!function(e){const t=rs.getInstance();if(!t.instrumentationEnabled)return;const s=e.url,a=t.logEndPointUrl.split("?")[0],r=t.flTransportEndpointUrl.split("?")[0];s!==a&&s!==r&&t.loggingEnabled&&t.logNetworkAfterSampling&&Ps(e,0)}({performanceController:e,url:s.name&&s.name.split("?")[0],responsePayloadBytes:s.transferSize,startTimeUs:r,timeToResponseInitiatedUs:n,timeToResponseCompletedUs:i})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls=["_fp",Wt,$t,qt,Bt,Ht];
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Us{constructor(e,t,s=!1,a){this.performanceController=e,this.name=t,this.isAuto=s,this.state=1,this.customAttributes={},this.counters={},this.api=ts.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=a||`${zt}-${this.randomId}-${this.name}`,a&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw Kt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw Kt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),As(this)}record(e,t,s){if(e<=0)throw Kt.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw Kt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),s&&s.attributes&&(this.customAttributes=Object.assign({},s.attributes)),s&&s.metrics)for(const a of Object.keys(s.metrics))isNaN(Number(s.metrics[a]))||(this.counters[a]=Math.floor(Number(s.metrics[a])));As(this)}incrementMetric(e,t=1){void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(!function(e,t){return!(0===e.length||e.length>100)&&(t&&t.startsWith(Ot)&&Ls.indexOf(e)>-1||!e.startsWith("_"))}(e,this.name))throw Kt.create("invalid custom metric name",{customMetricName:e});this.counters[e]=function(e){const t=Math.floor(e);return t<e&&Yt.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}(null!=t?t:0)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const s=function(e){return!(0===e.length||e.length>40)&&(!is.some(t=>e.startsWith(t))&&!!e.match(ls))}(e),a=function(e){return 0!==e.length&&e.length<=100}(t);if(s&&a)this.customAttributes[e]=t;else{if(!s)throw Kt.create("invalid attribute name",{attributeName:e});if(!a)throw Kt.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,s,a,r){const n=ts.getInstance().getUrl();if(!n)return;const i=new Us(e,Ot+n,!0),l=Math.floor(1e3*ts.getInstance().getTimeOrigin());i.setStartTime(l),t&&t[0]&&(i.setDuration(Math.floor(1e3*t[0].duration)),i.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),i.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),i.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(s){const e=s.find(e=>"first-paint"===e.name);e&&e.startTime&&i.putMetric("_fp",Math.floor(1e3*e.startTime));const t=s.find(e=>"first-contentful-paint"===e.name);t&&t.startTime&&i.putMetric(Wt,Math.floor(1e3*t.startTime)),r&&i.putMetric($t,Math.floor(1e3*r))}this.addWebVitalMetric(i,qt,"lcp_element",a.lcp),this.addWebVitalMetric(i,Bt,"cls_largestShiftTarget",a.cls),this.addWebVitalMetric(i,Ht,"inp_interactionTarget",a.inp),As(i),ws&&ws.flush()}static addWebVitalMetric(e,t,s,a){a&&(e.putMetric(t,Math.floor(1e3*a.value)),a.elementAttribution&&e.putAttribute(s,a.elementAttribution))}static createUserTimingTrace(e,t){As(new Us(e,t,!1,t))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zs,Os={},Ws=!1;function $s(e){ss()&&(setTimeout(()=>function(e){const t=ts.getInstance();"onpagehide"in window?t.document.addEventListener("pagehide",()=>Hs(e)):t.document.addEventListener("unload",()=>Hs(e));t.document.addEventListener("visibilitychange",()=>{"hidden"===t.document.visibilityState&&Hs(e)}),t.onFirstInputDelay&&t.onFirstInputDelay(e=>{zs=e});t.onLCP(e=>{var t;Os.lcp={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.element}}),t.onCLS(e=>{var t;Os.cls={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.largestShiftTarget}}),t.onINP(e=>{var t;Os.inp={value:e.value,elementAttribution:null===(t=e.attribution)||void 0===t?void 0:t.interactionTarget}})}(e),0),setTimeout(()=>function(e){const t=ts.getInstance(),s=t.getEntriesByType("resource");for(const a of s)Fs(e,a);t.setupObserver("resource",t=>Fs(e,t))}(e),0),setTimeout(()=>function(e){const t=ts.getInstance(),s=t.getEntriesByType("measure");for(const a of s)qs(e,a);t.setupObserver("measure",t=>qs(e,t))}(e),0))}function qs(e,t){const s=t.name;s.substring(0,21)!==zt&&Us.createUserTimingTrace(e,s)}function Hs(e){if(!Ws){Ws=!0;const t=ts.getInstance(),s=t.getEntriesByType("navigation"),a=t.getEntriesByType("paint");setTimeout(()=>{Us.createOobTrace(e,s,a,Os,zs)},0)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),ts.getInstance().requiredApisAvailable()?U().then(e=>{e&&(Ss||(Ds(5500),Ss=!0),js(this).then(()=>$s(this),()=>$s(this)),this.initialized=!0)}).catch(e=>{Yt.info(`Environment doesn't support IndexedDB: ${e}`)}):Yt.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){rs.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return rs.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){rs.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return rs.getInstance().dataCollectionEnabled}}const Vs=(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();if("[DEFAULT]"!==s.name)throw Kt.create("FB not default");if("undefined"==typeof window)throw Kt.create("no window");!function(e){Xt=e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(window);const r=new Bs(s,a);return r._init(t),r};M(new _("performance",Vs,"PUBLIC")),F(Ft,Lt),F(Ft,Lt,"esm2017");let Gs=null,Qs=!1;function Ks(){try{Gs=function(e=W()){return e=$(e),q(e,"performance").getImmediate()}(o),Qs=!0}catch(e){s.error("❌ [PERFORMANCE] Failed to initialize:",e)}}function Ys(e){return Qs&&Gs?function(e,t){return e=$(e),new Us(e,t)}(Gs,e):{start:()=>{},stop:()=>{},putAttribute:()=>{},putMetric:()=>{},incrementMetric:()=>{},getAttribute:()=>null,getMetric:()=>0}}const Js="generate_warning_pdf",Xs=({isOpen:e,onClose:t,warningData:a,deliveryChoice:r,onPDFGenerated:n,showPreview:i=!0,title:o="Warning Document Preview"})=>{const{organization:d}=c(),[m,x]=b.useState(null),[h,u]=b.useState(null),[g,p]=b.useState(""),[y,f]=b.useState(!1),[v,j]=b.useState(null),[N,w]=b.useState(""),[k,C]=b.useState(!1),[S,D]=b.useState(null),[T,E]=b.useState(!1),[I,P]=b.useState(""),A=b.useRef(null),R=b.useMemo(()=>{if(!a)return null;const e=a.wizardState||a,t=e.selectedEmployee||a.selectedEmployee,s=e.selectedCategory||a.selectedCategory,n=e.formData||a.formData||{},i=e.signatures||a.signatures||{},l=e.lraRecommendation||a.lraRecommendation,o=t?{id:t.id,firstName:t.firstName||"Unknown",lastName:t.lastName||"Employee",employeeId:t.employeeId||t.id||"N/A",position:t.position||"Unknown Position",department:t.department||"Unknown Department",email:t.email||"",phone:t.phone||""}:{id:n.employeeId||"unknown",firstName:"Employee",lastName:"Not Selected",employeeId:n.employeeId||"N/A",position:"Unknown Position",department:"Unknown Department",email:"",phone:""},c=s?{id:s.id,name:s.name||"General Misconduct",severity:s.severity||"medium",description:s.description||"",lraSection:s.lraSection||"LRA Section 188"}:{id:n.categoryId||"unknown",name:"Category Not Selected",severity:"medium",description:"Category details not available",lraSection:"LRA Section 188"};return{warningId:`WRN_${Date.now()}`,organizationId:e.organizationId||a.organizationId,employee:o,category:c,isComplete:!(!t||!s),hasEmployee:!!t,hasCategory:!!s,incident:{date:n.incidentDate||(new Date).toISOString().split("T")[0],time:n.incidentTime||"09:00",location:n.incidentLocation||"",description:n.incidentDescription||""},additionalNotes:n.additionalNotes||"",validityPeriod:n.validityPeriod||6,signatures:{manager:i.manager,employee:i.employee},recommendation:l,issueDate:new Date,deliveryMethod:r?.method||"email"}},[a,r]),M=b.useMemo(()=>{if(!R)return"Warning_Document.pdf";const e=`${R.employee.firstName}_${R.employee.lastName}`,t=(new Date).toISOString().split("T")[0];return`Warning_${R.category.name.replace(/\s+/g,"_").substring(0,20)}_${e}_${t}.pdf`},[R]),_=b.useCallback(async()=>{if(!R||!d)return void j("Missing required data for PDF generation");if(!(R.incident.description||R.incident.location||R.additionalNotes))return void j("Insufficient incident data. Please complete the form before generating PDF.");f(!0),j(null);const e=["Preparing warning document data...","Applying organization branding...","Formatting incident details...","Adding legal compliance sections...","Finalizing PDF document..."];try{for(let r=0;r<e.length;r++)w(e[r]),await new Promise(e=>setTimeout(e,600));const t={warningId:R.warningId,issuedDate:R.issueDate,employee:{firstName:R.employee.firstName,lastName:R.employee.lastName,employeeNumber:R.employee.employeeId,department:R.employee.department,position:R.employee.position,email:R.employee.email},warningLevel:R.recommendation?.suggestedLevel||"verbal",category:R.category.name,description:R.incident.description,incidentDate:new Date(R.incident.date),incidentTime:R.incident.time,incidentLocation:R.incident.location,organization:d,signatures:R.signatures,additionalNotes:R.additionalNotes,validityPeriod:R.validityPeriod,legalCompliance:{isCompliant:!0,framework:"LRA Section 188",requirements:R.recommendation?.legalRequirements||[]},disciplineRecommendation:R.recommendation?{suggestedLevel:R.recommendation.suggestedLevel,reason:R.recommendation.reason||"Progressive discipline escalation",warningCount:R.recommendation.warningCount||0,activeWarnings:R.recommendation.previousWarnings||[],legalRequirements:R.recommendation.legalRequirements||[]}:void 0,deliveryChoice:r?{method:r.method,timestamp:new Date,chosenBy:"Manager",contactDetails:r.contactDetails}:void 0},{PDFGenerationService:s}=await B(async()=>{const{PDFGenerationService:e}=await import("./PDFGenerationService-Cg7oHxh4.js");return{PDFGenerationService:e}},__vite__mapDeps([0,1,2,3,4,5])),a=await async function(e,t,s){const a=Ys(e);try{a.start(),s&&Object.entries(s).forEach(([e,t])=>{a.putAttribute(e,t)});const e=await t();return a.stop(),e}catch(v){throw a.putAttribute("error","true"),a.stop(),v}}(Js,()=>s.generateWarningPDF(t),{employee:`${R.employee.firstName} ${R.employee.lastName}`,category:R.category.name});x(a),p(M);const i=URL.createObjectURL(a);u(i),R.employee.firstName,R.employee.lastName,R.category.name,(a.size/1024).toFixed(1),n&&await n(a,M)}catch(t){s.error("❌ PDF generation failed:",t),j(`Failed to generate PDF: ${t instanceof Error?t.message:"Unknown error"}`)}finally{f(!1),w("")}},[R,d,M,r,n]),F=b.useCallback(()=>{if(!m||!g)return;const e=URL.createObjectURL(m),t=document.createElement("a");t.href=e,t.download=g,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e)},[m,g]),L=b.useCallback(async()=>{if(!R||!d)return s.error("❌ [PDFPreviewModal] Missing data for QR generation"),void j("Missing required data for QR code generation");E(!0),P("Generating PDF for QR code...");try{P("Creating PDF document...");const e={warningId:R.warningId,issuedDate:R.issueDate,employee:{firstName:R.employee.firstName,lastName:R.employee.lastName,employeeNumber:R.employee.employeeId,department:R.employee.department,position:R.employee.position,email:R.employee.email},warningLevel:R.recommendation?.suggestedLevel||"verbal",category:R.category.name,description:R.incident.description,incidentDate:new Date(R.incident.date),incidentTime:R.incident.time,incidentLocation:R.incident.location,organization:d,signatures:R.signatures,additionalNotes:R.additionalNotes,validityPeriod:R.validityPeriod,legalCompliance:{isCompliant:!0,framework:"LRA Section 188",requirements:R.recommendation?.legalRequirements||[]},disciplineRecommendation:R.recommendation?{suggestedLevel:R.recommendation.suggestedLevel,reason:R.recommendation.reason||"Progressive discipline escalation",warningCount:R.recommendation.warningCount||0,activeWarnings:R.recommendation.previousWarnings||[],legalRequirements:R.recommendation.legalRequirements||[]}:void 0,deliveryChoice:r?{method:r.method,timestamp:new Date,chosenBy:"Manager",contactDetails:r.contactDetails}:void 0};P("Generating PDF document...");const{PDFGenerationService:t}=await B(async()=>{const{PDFGenerationService:e}=await import("./PDFGenerationService-Cg7oHxh4.js");return{PDFGenerationService:e}},__vite__mapDeps([0,1,2,3,4,5])),s=await t.generateWarningPDF(e);(s.size/1024).toFixed(1),D(s),P("Opening QR code modal..."),C(!0)}catch(e){s.error("❌ QR PDF generation failed:",e),j(`Failed to generate QR code: ${e instanceof Error?e.message:"Unknown error"}`)}finally{E(!1),P("")}},[R,d,M,r]),U=b.useRef(!1);return b.useEffect(()=>{!e||!R||m||y||U.current||(U.current=!0,_()),e||(U.current=!1)},[e,R,m,y,_]),b.useEffect(()=>{if(e){const e=setTimeout(()=>{A.current&&A.current.scrollIntoView({behavior:"smooth",block:"start"}),window.scrollTo({top:0,behavior:"smooth"});const e=document.querySelector(".pdf-preview-modal");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},150);return document.body.style.overflow="hidden",()=>{clearTimeout(e),document.body.style.overflow="unset"}}document.body.style.overflow="unset"},[e]),b.useEffect(()=>()=>{h&&URL.revokeObjectURL(h)},[h]),e?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{ref:A,className:"pdf-preview-modal bg-white rounded-lg shadow-xl max-w-4xl w-full h-[90vh] overflow-hidden flex flex-col border border-gray-200",children:[l.jsx("div",{className:"bg-white border-b border-gray-200 p-6 flex-shrink-0",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center",children:l.jsx(ne,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o}),R&&l.jsxs("p",{className:"text-gray-600 text-sm",children:[R.employee.firstName," ",R.employee.lastName," - ",R.category.name]})]})]}),l.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(G,{className:"w-5 h-5"})})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:l.jsxs("div",{className:"p-6 space-y-6",children:[R&&!R.isComplete&&l.jsx("div",{className:"bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(K,{className:"w-5 h-5 text-amber-400 mr-3"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Incomplete Warning Data"}),l.jsxs("div",{className:"text-sm text-amber-700 mt-1",children:[!R.hasEmployee&&l.jsx("p",{children:"• Employee not selected"}),!R.hasCategory&&l.jsx("p",{children:"• Category not selected"}),!R.incident.description&&l.jsx("p",{children:"• Incident description missing"}),l.jsx("p",{className:"mt-2",children:"PDF can still be generated with available data, but may appear incomplete."})]})]})]})}),v&&l.jsxs("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-r-lg",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(K,{className:"w-5 h-5 text-red-400 mr-3"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-red-800",children:"PDF Generation Error"}),l.jsx("p",{className:"text-sm text-red-700 mt-1",children:v})]})]}),l.jsxs("button",{onClick:_,className:"mt-3 text-sm text-red-700 hover:text-red-900 font-medium flex items-center",children:[l.jsx(Y,{className:"w-4 h-4 mr-1"}),"Retry Generation"]})]}),R&&l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"p-4 rounded-lg "+(R.hasEmployee?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-200"),children:[l.jsxs("h3",{className:"font-semibold text-gray-700 mb-2 flex items-center",children:[l.jsx(ie,{className:"w-4 h-4 mr-2"}),"Employee Details",R.hasEmployee?l.jsx(Z,{className:"w-4 h-4 text-green-500 ml-2"}):l.jsx(K,{className:"w-4 h-4 text-amber-500 ml-2"})]}),l.jsxs("p",{className:"text-sm text-gray-600",children:[R.employee.firstName," ",R.employee.lastName]}),l.jsxs("p",{className:"text-sm text-gray-500",children:[R.employee.position," • ",R.employee.department]}),!R.hasEmployee&&l.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Complete employee selection in wizard"})]}),l.jsxs("div",{className:"p-4 rounded-lg "+(R.hasCategory?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-200"),children:[l.jsxs("h3",{className:"font-semibold text-gray-700 mb-2 flex items-center",children:[l.jsx(le,{className:"w-4 h-4 mr-2"}),"Incident Details",R.incident.description&&R.hasCategory?l.jsx(Z,{className:"w-4 h-4 text-green-500 ml-2"}):l.jsx(K,{className:"w-4 h-4 text-amber-500 ml-2"})]}),l.jsxs("p",{className:"text-sm text-gray-600 flex items-center",children:[l.jsx(re,{className:"w-3 h-3 mr-1"}),R.incident.date," at ",R.incident.time]}),R.incident.location&&l.jsxs("p",{className:"text-sm text-gray-500 flex items-center",children:[l.jsx(oe,{className:"w-3 h-3 mr-1"}),R.incident.location]}),l.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Category: ",R.category.name]}),!R.hasCategory&&l.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Complete category selection in wizard"})]})]}),y&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[l.jsx(ce,{className:"w-6 h-6 text-blue-600 animate-spin"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-800 font-medium",children:"Generating PDF Document"}),N&&l.jsx("p",{className:"text-blue-600 text-sm",children:N})]})]})}),T&&l.jsx("div",{className:"bg-purple-50 border border-purple-200 p-4 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[l.jsx(ce,{className:"w-6 h-6 text-purple-600 animate-spin"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-purple-800 font-medium",children:"Preparing QR Code Download"}),I&&l.jsx("p",{className:"text-purple-600 text-sm",children:I}),l.jsx("p",{className:"text-purple-600 text-xs mt-1",children:"This creates a secure link for mobile devices"})]})]})}),m&&h&&!y&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-100 flex items-center justify-center",children:l.jsx(Z,{className:"w-4 h-4 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-gray-900 font-medium",children:"PDF Generated Successfully"}),l.jsxs("p",{className:"text-gray-600 text-sm",children:[g," • ",(m.size/1024).toFixed(1)," KB"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-3 py-2 bg-white text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:[l.jsx(Q,{className:"w-4 h-4"}),l.jsx("span",{children:"Download"})]}),l.jsx("button",{onClick:L,disabled:T,className:"flex items-center gap-2 px-3 py-2 bg-white text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:T?l.jsxs(l.Fragment,{children:[l.jsx(ce,{className:"w-4 h-4 animate-spin"}),l.jsx("span",{children:"Generating..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(V,{className:"w-4 h-4"}),l.jsx("span",{children:"QR Code"})]})}),l.jsxs("button",{onClick:()=>window.open(h,"_blank"),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[l.jsx(te,{className:"w-4 h-4"}),l.jsx("span",{children:"Open"})]})]})]})}),i&&l.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[l.jsxs("h3",{className:"font-semibold text-gray-700 mb-3 flex items-center",children:[l.jsx(de,{className:"w-4 h-4 mr-2"}),"Document Preview"]}),l.jsx("div",{className:"bg-white border rounded-lg overflow-hidden shadow-inner",style:{height:"500px"},children:l.jsx("iframe",{src:h,className:"w-full h-full border-0",title:"PDF Preview"})})]})]}),R&&!R.isComplete&&!m&&!y&&l.jsxs("div",{className:"text-center py-6 border-t border-gray-200",children:[l.jsx(me,{className:"w-12 h-12 text-blue-400 mx-auto mb-3"}),l.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"Partial Warning Data"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Some information is missing, but you can still generate a draft PDF."}),l.jsxs("div",{className:"flex justify-center space-x-3",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-700 font-medium",children:"Complete Wizard First"}),l.jsxs("button",{onClick:_,className:"flex items-center space-x-2 bg-amber-500 text-white px-6 py-2 rounded-lg hover:bg-amber-600 transition-colors font-medium",children:[l.jsx(de,{className:"w-4 h-4"}),l.jsx("span",{children:"Generate Draft PDF"})]})]})]}),!R&&!y&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx(de,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Warning Data Available"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"No data provided for PDF generation."}),l.jsx("button",{onClick:t,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Return to Wizard"})]})]})}),l.jsx("div",{className:"bg-white border-t border-gray-200 px-6 py-4 flex-shrink-0",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center text-sm text-gray-500 gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(xe,{className:"w-4 h-4 text-red-500"}),l.jsx("span",{children:"Generated by HR System"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(he,{className:"w-4 h-4 text-blue-500"}),l.jsx("span",{children:"LRA Compliant"})]})]}),l.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium transition-colors",children:"Close"}),!m&&!y&&R&&l.jsxs("button",{onClick:_,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[l.jsx(de,{className:"w-4 h-4"}),l.jsx("span",{children:"Generate PDF"})]}),m&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:F,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[l.jsx(Q,{className:"w-4 h-4"}),l.jsx("span",{children:"Download"})]}),l.jsx("button",{onClick:L,disabled:T,className:"flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:T?l.jsxs(l.Fragment,{children:[l.jsx(ce,{className:"w-4 h-4 animate-spin"}),l.jsx("span",{children:"Generating..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(V,{className:"w-4 h-4"}),l.jsx("span",{children:"QR Code"})]})})]})]})]})})]})}),S&&l.jsx(Fe,{isOpen:k,onClose:()=>{C(!1),D(null)},pdfBlob:S,filename:g,employeeId:R?.employee?.id,warningId:R?.warningId,organizationId:R?.organizationId||d?.id,employeeName:R&&`${R.employee.firstName} ${R.employee.lastName}`.trim(),onLinkGenerated:e=>{}})]}):null},Zs=({physicalCopyLocation:e,className:t=""})=>l.jsx(d,{className:`bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-500 ${t}`,children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-amber-500 flex items-center justify-center",children:l.jsx(K,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-base font-semibold text-amber-900 dark:text-amber-100",children:"⚠️ IMPORTANT: Physical Copy Required"}),l.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 mt-1",children:"This warning was entered manually from a physical document"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-amber-300 dark:border-amber-700",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"The system does NOT have:"}),l.jsxs("ul",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),l.jsx("span",{children:"Digital signatures from manager and employee"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),l.jsx("span",{children:"Audio recording of the disciplinary meeting"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-red-500 font-bold",children:"✗"}),l.jsx("span",{children:"PDF document with QR code verification"})]})]})]}),l.jsxs("div",{className:"bg-amber-100 dark:bg-amber-900/40 rounded-lg p-4 border border-amber-400 dark:border-amber-600",children:[l.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[l.jsx(ae,{className:"w-5 h-5 text-amber-700 dark:text-amber-300 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm font-semibold text-amber-900 dark:text-amber-100",children:"Legal Compliance Requirement:"})]}),l.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200 ml-7",children:["You ",l.jsx("strong",{children:"MUST"})," keep the original signed physical document safe and accessible for potential legal proceedings or CCMA hearings. This digital record is supplementary only."]})]}),e&&l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-amber-300 dark:border-amber-700",children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(de,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:"Physical Copy Location:"}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 font-mono bg-gray-50 dark:bg-gray-900 px-3 py-2 rounded border border-gray-200 dark:border-gray-700",children:e})]})]})}),l.jsx("div",{className:"text-xs text-amber-700 dark:text-amber-300 italic border-t border-amber-300 dark:border-amber-700 pt-3",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Note:"})," Historical entries are fully integrated with the escalation system and will count toward the employee's progressive discipline record."]})})]})}),ea=({value:e,onChange:t,min:s,max:a,label:r,className:n=""})=>{const[i,o]=b.useState(!1),c=b.useRef(null);b.useEffect(()=>{if(i&&c.current){const t=c.current,a=48,r=(e-s)*a-t.clientHeight/2+a/2;setTimeout(()=>{t.scrollTo({top:Math.max(0,r),behavior:"smooth"})},100)}},[i,e,s]);const d=(()=>{const e=[];for(let t=s;t<=a;t++)e.push(t);return e})();return l.jsxs("div",{className:`relative ${n}`,children:[l.jsx("div",{onClick:()=>o(!i),className:"w-24 h-20 cursor-pointer border-2 rounded-2xl flex items-center justify-center transition-all duration-200 hover:scale-105",style:{backgroundColor:"var(--color-card-background)",borderColor:i?"var(--color-primary)":"var(--color-border)",boxShadow:i?"0 0 0 3px var(--color-primary-light)":"0 4px 12px rgba(0, 0, 0, 0.08)"},children:l.jsx("span",{className:"text-3xl font-light",style:{color:"var(--color-text)",fontVariantNumeric:"tabular-nums"},children:e.toString().padStart(2,"0")})}),i&&l.jsx("div",{className:"absolute top-full left-0 mt-2 w-24 bg-white border-2 rounded-2xl shadow-lg z-10 overflow-hidden",style:{backgroundColor:"var(--color-card-background)",borderColor:"var(--color-primary)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.15)"},children:l.jsx("div",{ref:c,className:"max-h-48 overflow-y-auto scrollbar-thin",style:{scrollbarWidth:"thin",scrollbarColor:"var(--color-primary) transparent"},children:d.map(s=>l.jsx("button",{onClick:()=>(t(s),void o(!1)),className:"w-full h-12 flex items-center justify-center transition-all duration-150 hover:scale-105",style:{backgroundColor:s===e?"var(--color-primary-light)":"transparent",color:s===e?"var(--color-primary)":"var(--color-text)",fontWeight:s===e?"600":"400",fontVariantNumeric:"tabular-nums"},onMouseEnter:t=>{s!==e&&(t.currentTarget.style.backgroundColor="var(--color-muted)")},onMouseLeave:t=>{s!==e&&(t.currentTarget.style.backgroundColor="transparent")},children:l.jsx("span",{className:"text-lg",children:s.toString().padStart(2,"0")})},s))})}),l.jsx("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2",children:l.jsx("span",{className:"text-xs font-medium tracking-wider uppercase",style:{color:"var(--color-text-tertiary)"},children:r})})]})},ta=({label:e,value:t,onChange:s,type:a="date",icon:r,required:n=!1,disabled:i=!1,error:o,className:c=""})=>{const[d,m]=b.useState(!1),[x,h]=b.useState(t?new Date(t):null),[u,g]=b.useState(new Date),[p,y]=b.useState({hours:t?new Date(`1970-01-01T${t}`).getHours():9,minutes:t?new Date(`1970-01-01T${t}`).getMinutes():0}),f=b.useRef(null),v=b.useRef(null);b.useEffect(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&f.current&&!f.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),b.useEffect(()=>(d?(setTimeout(()=>{const e=v.current;e&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},100),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[d]);const N=e=>{h(e);const t=e.toISOString().split("T")[0];s(t),m(!1)},w=(e,t)=>{y({hours:e,minutes:t});const a=`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;s(a)},k=(()=>{const e=u.getFullYear(),t=u.getMonth(),s=new Date(e,t,1),a=new Date(s);a.setDate(a.getDate()-s.getDay());const r=[];for(let n=0;n<42;n++){const e=new Date(a);e.setDate(a.getDate()+n),r.push(e)}return r})(),C=new Date,S={backgroundColor:o?"var(--color-alert-error-bg)":"var(--color-input-background)",borderColor:o?"var(--color-alert-error-border)":"var(--color-input-border)",color:"var(--color-text)"};return l.jsxs("div",{className:`space-y-2 ${c}`,children:[l.jsxs("label",{className:"block text-xs font-medium",style:{color:"var(--color-text-secondary)"},children:[r&&l.jsx(r,{className:"w-3 h-3 inline mr-1"}),e," ",n&&l.jsx("span",{style:{color:"var(--color-error)"},children:"*"})]}),l.jsxs("div",{className:"relative",ref:f,children:[l.jsxs("div",{onClick:()=>!i&&m(!d),className:"w-full h-11 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm cursor-pointer flex items-center justify-between "+(i?"opacity-50 cursor-not-allowed":""),style:S,children:[l.jsx("span",{style:{color:t?"var(--color-text)":"var(--color-text-tertiary)"},children:"time"===a?t||"Select time...":x?x.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Select date..."}),"date"===a?l.jsx(le,{className:"w-4 h-4",style:{color:"var(--color-primary)"}}):l.jsx(re,{className:"w-4 h-4",style:{color:"var(--color-primary)"}})]}),d&&"undefined"!=typeof document&&j.createPortal(l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[10000]",onClick:()=>m(!1)}),l.jsx("div",{ref:v,className:"fixed inset-0 z-[10001] flex items-center justify-center p-4",children:l.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full max-h-[90vh] overflow-auto",style:{backgroundColor:"var(--color-card-background)",borderColor:"var(--color-border)",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:e=>e.stopPropagation(),children:"date"===a?l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("button",{onClick:()=>g(new Date(u.setMonth(u.getMonth()-1))),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",style:{color:"var(--color-text-secondary)"},children:l.jsx(ue,{className:"w-4 h-4"})}),l.jsx("h3",{className:"font-semibold text-center flex-1",style:{color:"var(--color-text)"},children:u.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),l.jsx("button",{onClick:()=>g(new Date(u.setMonth(u.getMonth()+1))),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",style:{color:"var(--color-text-secondary)"},children:l.jsx(ge,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(e=>l.jsx("div",{className:"text-xs font-medium text-center p-2",style:{color:"var(--color-text-secondary)"},children:e},e))}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:k.map((e,t)=>{const s=e.getMonth()===u.getMonth(),a=e.toDateString()===C.toDateString(),r=x&&e.toDateString()===x.toDateString();return l.jsx("button",{onClick:()=>s&&N(e),disabled:!s,className:"p-2 text-sm rounded-lg transition-all "+(s?"hover:bg-gray-100 cursor-pointer":"opacity-30 cursor-not-allowed"),style:{backgroundColor:r?"var(--color-primary)":a?"var(--color-primary-light)":"transparent",color:r?"white":a?"var(--color-primary)":"var(--color-text)",fontWeight:a||r?"600":"400"},children:e.getDate()},t)})}),l.jsx("div",{className:"mt-4 flex justify-center",children:l.jsx("button",{onClick:()=>N(C),className:"px-4 py-2 text-sm rounded-lg border transition-colors",style:{borderColor:"var(--color-primary)",color:"var(--color-primary)",backgroundColor:"transparent"},children:"Today"})})]}):l.jsxs("div",{className:"p-6",children:[l.jsx("div",{className:"text-center mb-6",children:l.jsx("h3",{className:"text-lg font-light tracking-wide",style:{color:"var(--color-text)",letterSpacing:"0.5px"},children:"Select Time"})}),l.jsxs("div",{className:"flex items-center justify-center gap-6 mb-8",children:[l.jsx(ea,{value:p.hours,onChange:e=>w(e,p.minutes),min:0,max:23,label:"Hours"}),l.jsxs("div",{className:"flex flex-col items-center self-start mt-12",children:[l.jsx("div",{className:"w-3 h-3 rounded-full mb-3",style:{backgroundColor:"var(--color-primary)"}}),l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"var(--color-primary)"}})]}),l.jsx(ea,{value:p.minutes,onChange:e=>w(p.hours,e),min:0,max:59,label:"Minutes"})]}),l.jsx("div",{className:"text-center mb-6",children:l.jsxs("div",{className:"inline-flex items-center px-4 py-2 rounded-full",style:{backgroundColor:"var(--color-muted)"},children:[l.jsx(re,{className:"w-4 h-4 mr-2",style:{color:"var(--color-text-secondary)"}}),l.jsxs("span",{className:"text-lg font-medium tracking-wider",style:{color:"var(--color-text)",fontVariantNumeric:"tabular-nums"},children:[p.hours.toString().padStart(2,"0"),":",p.minutes.toString().padStart(2,"0")]})]})}),l.jsx("div",{className:"flex justify-center",children:l.jsx("button",{onClick:()=>m(!1),className:"px-8 py-3 rounded-xl font-medium tracking-wide transition-all duration-200 transform hover:scale-105 active:scale-95",style:{backgroundColor:"var(--color-primary)",color:"white",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.15)",letterSpacing:"0.5px"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 6px 24px rgba(0, 0, 0, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="0 4px 16px rgba(0, 0, 0, 0.15)"},children:"Done"})})]})})})]}),document.body)]}),o&&l.jsxs("div",{className:"flex items-center gap-1 text-xs",style:{color:"var(--color-error)"},children:[l.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o]})]})},sa=["Select Employee & Category","Enter Dates & Details","Physical Copy Confirmation","Review & Save"],aa={counselling:"Counselling Session",verbal:"Verbal Warning",first_written:"First Written Warning",second_written:"Second Written Warning",final_written:"Final Written Warning"},ra=({isOpen:e,onClose:t,onSuccess:a,employees:r,categories:n,preSelectedEmployeeId:i,currentUserId:o,organizationId:c})=>{const[g,p]=b.useState(0),[y,f]=b.useState(!1),[v,j]=b.useState(null),[N,w]=b.useState({employeeId:i||"",categoryId:"",level:"",incidentDate:null,incidentTime:"09:00",issueDate:null,expiryDate:null,validityPeriod:6,title:"",description:"",incidentLocation:"",additionalNotes:"",hasPhysicalCopy:!1,physicalCopyLocation:"",historicalNotes:""}),k=b.useMemo(()=>r.find(e=>e.id===N.employeeId),[r,N.employeeId]),C=b.useMemo(()=>n.find(e=>e.id===N.categoryId),[n,N.categoryId]),S=b.useMemo(()=>C?.escalationPath?C.escalationPath:["counselling","verbal","first_written","second_written","final_written"],[C]),D=b.useCallback((e,t)=>{if(!e)return null;const s=new Date(e);return s.setMonth(s.getMonth()+t),s},[]),T=b.useCallback((e,t)=>{w(s=>{const a={...s,[e]:t};if("issueDate"===e||"validityPeriod"===e){const r="issueDate"===e?t:s.issueDate,n="validityPeriod"===e?t:s.validityPeriod;a.expiryDate=D(r,n)}return a})},[D]),E=b.useCallback(e=>{switch(e){case 0:return N.employeeId?N.categoryId?N.level?{isValid:!0}:{isValid:!1,error:"Please select a warning level"}:{isValid:!1,error:"Please select a category"}:{isValid:!1,error:"Please select an employee"};case 1:return N.incidentDate?N.issueDate?N.title.trim()?N.description.trim()?N.incidentLocation.trim()?N.issueDate>new Date?{isValid:!1,error:"Issue date cannot be in the future"}:N.expiryDate&&N.expiryDate<=N.issueDate?{isValid:!1,error:"Expiry date must be after issue date"}:{isValid:!0}:{isValid:!1,error:"Please enter incident location"}:{isValid:!1,error:"Please enter incident description"}:{isValid:!1,error:"Please enter a warning title"}:{isValid:!1,error:"Please enter issue date"}:{isValid:!1,error:"Please enter incident date"};case 2:return N.hasPhysicalCopy?{isValid:!0}:{isValid:!1,error:"You must confirm that a physical signed copy exists"};case 3:return{isValid:!0};default:return{isValid:!1}}},[N]),I=b.useCallback(()=>{const e=E(g);e.isValid?(j(null),p(e=>Math.min(e+1,3))):j(e.error||"Please complete all required fields")},[g,E]),P=b.useCallback(()=>{j(null),p(e=>Math.max(e-1,0))},[]),A=b.useCallback(async()=>{const e=E(2);if(e.isValid){f(!0),j(null);try{const{ShardedDataService:e}=await B(async()=>{const{ShardedDataService:e}=await import("./business-owner-dashboard-Cigg9BdB.js").then(e=>e.V);return{ShardedDataService:e}},__vite__mapDeps([2,3,1,4,5])),s={employeeId:N.employeeId,categoryId:N.categoryId,level:N.level,incidentDate:N.incidentDate,incidentTime:N.incidentTime,issueDate:N.issueDate,expiryDate:N.expiryDate,validityPeriod:N.validityPeriod,title:N.title,description:N.description,incidentLocation:N.incidentLocation,additionalNotes:N.additionalNotes,isHistoricalEntry:!0,hasPhysicalCopy:N.hasPhysicalCopy,physicalCopyLocation:N.physicalCopyLocation,historicalNotes:N.historicalNotes,enteredBy:o,enteredAt:new Date,issuedBy:o,status:"issued",isActive:!0,deliveryStatus:"delivered",followUpActions:[]};await e.createWarning(s,c),a(),t()}catch(r){s.error("Error creating historical warning:",r),j(r instanceof Error?r.message:"Failed to create warning")}finally{f(!1)}}else j(e.error||"Please complete all required fields")},[N,o,c,a,t,E]),R=b.useCallback(()=>{y||(p(0),j(null),w({employeeId:i||"",categoryId:"",level:"",incidentDate:null,incidentTime:"09:00",issueDate:null,expiryDate:null,validityPeriod:6,title:"",description:"",incidentLocation:"",additionalNotes:"",hasPhysicalCopy:!1,physicalCopyLocation:"",historicalNotes:""}),t())},[y,t,i]);return l.jsxs(m,{isOpen:e,onClose:R,title:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-amber-100 to-amber-50 dark:from-amber-900/40 dark:to-amber-900/20 flex items-center justify-center shadow-sm",children:l.jsx(de,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"Manual Warning Entry"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:sa[g]})]})]}),size:"lg",children:[l.jsx("div",{className:"flex items-center justify-between mb-4 px-4",children:[0,1,2,3].map(e=>l.jsxs("div",{className:"flex items-center flex-1",children:[l.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-xs font-semibold transition-all duration-200\n                "+(e<=g?"bg-blue-600 text-white shadow-sm":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400"),children:e<g?l.jsx(pe,{className:"w-3.5 h-3.5"}):e+1}),e<3&&l.jsx("div",{className:"flex-1 h-0.5 mx-2 transition-all duration-200\n                  "+(e<g?"bg-blue-600":"bg-gray-200 dark:bg-gray-700")})]},e))}),v&&l.jsx("div",{className:"mb-4 px-4",children:l.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg p-3 flex items-start gap-2",children:[l.jsx(K,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),l.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:v})]})}),l.jsx("div",{className:"px-4 pb-4 max-h-[calc(100vh-300px)] overflow-y-auto",children:(()=>{switch(g){case 0:return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(u,{icon:ie,title:"Select Employee",subtitle:"Choose the employee who received this warning"}),l.jsxs("select",{value:N.employeeId,onChange:e=>T("employeeId",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[l.jsx("option",{value:"",children:"Select an employee..."}),r.map(e=>l.jsxs("option",{value:e.id,children:[e.profile.firstName," ",e.profile.lastName," (",e.profile.employeeNumber,")"]},e.id))]})]}),l.jsxs("div",{children:[l.jsx(u,{icon:ve,title:"Select Category",subtitle:"Choose the violation category"}),l.jsxs("select",{value:N.categoryId,onChange:e=>T("categoryId",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[l.jsx("option",{value:"",children:"Select a category..."}),n.map(e=>l.jsx("option",{value:e.id,children:e.name},e.id))]})]}),N.categoryId&&l.jsxs("div",{children:[l.jsx(u,{icon:K,title:"Warning Level",subtitle:"Select the severity level given in the original warning"}),l.jsxs("select",{value:N.level,onChange:e=>T("level",e.target.value),className:"mt-2 w-full h-11 px-4 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm font-medium transition-all duration-200 hover:border-gray-300 dark:hover:border-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[l.jsx("option",{value:"",children:"Select warning level..."}),S.map(e=>l.jsx("option",{value:e,children:aa[e]||e},e))]})]})]});case 1:return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(ta,{label:"Incident Date",value:N.incidentDate?N.incidentDate.toISOString().split("T")[0]:"",onChange:e=>T("incidentDate",e?new Date(e):null),icon:le,required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When did the incident occur?"})]}),l.jsx(h,{icon:re,label:"Incident Time",type:"time",value:N.incidentTime,onChange:e=>T("incidentTime",e)}),l.jsxs("div",{children:[l.jsx(ta,{label:"Issue Date",value:N.issueDate?N.issueDate.toISOString().split("T")[0]:"",onChange:e=>T("issueDate",e?new Date(e):null),icon:fe,required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When was the warning issued?"})]}),l.jsxs("div",{children:[l.jsx(u,{icon:re,title:"Validity Period",subtitle:"How long is this warning active?"}),l.jsxs("select",{value:N.validityPeriod,onChange:e=>T("validityPeriod",parseInt(e.target.value)),className:"w-full h-11 px-4 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent",children:[l.jsx("option",{value:3,children:"3 months"}),l.jsx("option",{value:6,children:"6 months"}),l.jsx("option",{value:12,children:"12 months"})]}),N.expiryDate&&l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Will expire on: ",N.expiryDate.toLocaleDateString()]})]}),l.jsx(h,{icon:de,label:"Warning Title",placeholder:"Brief summary of the warning",value:N.title,onChange:e=>T("title",e)}),l.jsx(h,{icon:oe,label:"Incident Location",placeholder:"Where did the incident occur?",value:N.incidentLocation,onChange:e=>T("incidentLocation",e)}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Incident Description *"}),l.jsx("textarea",{value:N.description,onChange:e=>T("description",e.target.value),rows:4,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Describe what happened in detail..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Additional Notes (Optional)"}),l.jsx("textarea",{value:N.additionalNotes,onChange:e=>T("additionalNotes",e.target.value),rows:3,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Any additional context or notes..."})]})]});case 2:return l.jsxs("div",{className:"space-y-4",children:[l.jsx(d,{children:l.jsx("div",{className:"space-y-4",children:l.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:N.hasPhysicalCopy,onChange:e=>T("hasPhysicalCopy",e.target.checked),className:"w-5 h-5 mt-0.5 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("span",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:"I confirm the physical signed copy exists"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Required: You must have access to the original signed warning document"})]})]})})}),N.hasPhysicalCopy&&l.jsx(h,{icon:de,label:"Physical Copy Location (Optional)",placeholder:"e.g., Filing Cabinet A3, HR Office",value:N.physicalCopyLocation,onChange:e=>T("physicalCopyLocation",e)}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Historical Entry Notes (Optional)"}),l.jsx("textarea",{value:N.historicalNotes,onChange:e=>T("historicalNotes",e.target.value),rows:3,className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-transparent resize-none",placeholder:"Any additional context about this historical entry..."})]}),l.jsx(Zs,{physicalCopyLocation:N.physicalCopyLocation||void 0})]});case 3:return l.jsxs("div",{className:"space-y-4",children:[l.jsx(d,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2",children:"Warning Summary"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Employee:"}),l.jsxs("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:[k?.profile.firstName," ",k?.profile.lastName]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Category:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:C?.name})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Level:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:aa[N.level]||N.level})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Validity:"}),l.jsxs("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:[N.validityPeriod," months"]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Incident Date:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:N.incidentDate?.toLocaleDateString()})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Issue Date:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:N.issueDate?.toLocaleDateString()})]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Title:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:N.title})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Description:"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-100 mt-1",children:N.description})]})]})]})}),l.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(K,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-semibold text-red-900 dark:text-red-100 mb-1",children:"This warning has NO digital signatures or audio recording"}),l.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:"Ensure the physical signed document is kept safe for legal compliance"})]})]})})]});default:return null}})()}),l.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-4 py-4 flex items-center justify-between",children:[l.jsx(x,{variant:"outline",onClick:0===g?R:P,disabled:y,icon:0===g?G:ue,children:0===g?"Cancel":"Back"}),l.jsx(x,{onClick:3===g?A:I,disabled:y,className:"flex items-center justify-center gap-2",children:y?"Saving...":3===g?l.jsxs(l.Fragment,{children:["Save Historical Warning ",l.jsx(ye,{className:"w-4 h-4"})]}):l.jsxs(l.Fragment,{children:["Next ",l.jsx(ge,{className:"w-4 h-4"})]})})]})]})},na=({notification:e,currentStep:t,onStepComplete:a,onDeliveryComplete:r,isProcessing:n})=>{const[i,o]=b.useState(!1),[c,m]=b.useState(!1),[h,u]=b.useState(!1),[p,y]=b.useState(null),[f,v]=b.useState(null),[j,N]=b.useState(!1),[w,k]=b.useState(!1),C=b.useCallback(()=>{const t=e.contactDetails.phone||e.employeePhone||"",s=t.replace(/[^\d]/g,"");return{message:`Hi ${e.employeeName},\n\nI hope this message finds you well. I'm writing to inform you that we need to discuss a ${e.warningLevel.toLowerCase()} regarding ${e.warningCategory.toLowerCase()}.\n\nI've attached the formal warning document for your review. Please read through it carefully and let me know if you have any questions or would like to schedule a meeting to discuss this matter further.\n\nThis is an important workplace matter that requires your immediate attention. Please confirm receipt of this message and the attached document.\n\nThank you for your cooperation.\n\nBest regards,\nHR Department`,phoneNumber:s,formattedPhone:t}},[e])();return l.jsxs("div",{className:"space-y-6",children:[0===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-green-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(be,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Prepare WhatsApp Message"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Copy the pre-written script and download the PDF attachment"})]})]}),l.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(je,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Employee Phone Number:"})]}),l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:C.formattedPhone||l.jsxs("span",{className:"text-red-500 text-sm",children:[l.jsx(K,{className:"w-4 h-4 inline mr-1"}),"No phone number on file"]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WhatsApp Message Script:"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{value:C.message,readOnly:!0,className:"w-full h-48 p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm font-mono resize-none",style:{color:"var(--color-text)"}}),l.jsx(x,{variant:i?"success":"primary",size:"sm",onClick:async()=>{try{await navigator.clipboard.writeText(C.message),o(!0),setTimeout(()=>o(!1),3e3)}catch(e){s.error("Failed to copy script:",e)}},className:"absolute top-2 right-2",children:i?l.jsxs(l.Fragment,{children:[l.jsx(pe,{className:"w-4 h-4 mr-1"}),"Copied!"]}):l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-1"}),"Copy Script"]})})]})]}),l.jsxs("div",{className:"mb-6 space-y-3",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(x,{variant:"secondary",onClick:()=>{k(!0)},className:"flex items-center gap-2",children:[l.jsx(te,{className:"w-4 h-4"}),"Preview & Download PDF"]}),c&&l.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[l.jsx(Z,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"PDF Downloaded"})]})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"Use the preview to download the PDF, then attach it to your WhatsApp message"})]}),l.jsxs("div",{className:"space-y-2 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm "+(i?"text-green-600":"text-gray-500"),children:[i?l.jsx(Z,{className:"w-4 h-4"}):l.jsx(re,{className:"w-4 h-4"}),"Script copied to clipboard"]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm "+(c?"text-green-600":"text-gray-500"),children:[c?l.jsx(Z,{className:"w-4 h-4"}):l.jsx(re,{className:"w-4 h-4"}),"PDF downloaded for attachment"]})]}),l.jsx(x,{variant:"primary",onClick:()=>{i&&c&&a(0)},disabled:!i||!c,className:"w-full",children:i&&c?l.jsxs(l.Fragment,{children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"Continue to Send Message"]}):l.jsxs(l.Fragment,{children:[l.jsx(re,{className:"w-4 h-4 mr-2"}),"Complete preparation steps above"]})})]}),1===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(Ne,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Send via WhatsApp"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Open WhatsApp Web and send the message with PDF attachment"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(g,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Instructions:"}),l.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[l.jsx("li",{children:'Click "Open WhatsApp Web" below'}),l.jsx("li",{children:"The message will be pre-filled with the script"}),l.jsx("li",{children:"Attach the downloaded PDF file"}),l.jsx("li",{children:"Send the message"}),l.jsx("li",{children:"Wait for delivery confirmation (double blue ticks)"})]})]})}),l.jsxs(x,{variant:"primary",onClick:()=>{const e=encodeURIComponent(C.message),t=`https://web.whatsapp.com/send?phone=${C.phoneNumber}&text=${e}`;window.open(t,"_blank"),u(!0)},disabled:!C.phoneNumber,size:"lg",className:"w-full",children:[l.jsx(Ne,{className:"w-5 h-5 mr-2"}),"Open WhatsApp Web"]}),h&&l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm mb-4",children:[l.jsx(Z,{className:"w-4 h-4"}),"WhatsApp Web opened"]}),l.jsxs(x,{variant:"primary",onClick:()=>{h&&a(1)},className:"w-full",children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"I've sent the message"]})]})]})]}),2===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-green-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(we,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: Confirm Delivery"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Upload screenshot proof of successful delivery"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(g,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Screenshot Requirements:"}),l.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[l.jsx("li",{children:"Show the sent message with timestamp"}),l.jsx("li",{children:"Display delivery confirmation (double blue ticks)"}),l.jsx("li",{children:"Include employee's phone number visible"}),l.jsx("li",{children:"Capture PDF attachment in the message"})]})]})}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[l.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){y(t);const e=new FileReader;e.onload=e=>{v(e.target?.result)},e.readAsDataURL(t)}},className:"hidden",id:"proof-upload"}),l.jsx("label",{htmlFor:"proof-upload",className:"cursor-pointer",children:f?l.jsxs("div",{className:"space-y-3",children:[l.jsx("img",{src:f,alt:"Delivery proof",className:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}),l.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[l.jsx(Z,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Screenshot uploaded"})]})]}):l.jsxs("div",{className:"space-y-3",children:[l.jsx(ke,{className:"w-12 h-12 mx-auto text-gray-400"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-medium text-gray-700",children:"Upload Screenshot"}),l.jsx("div",{className:"text-sm text-gray-500",children:"Click to select image file"})]})]})})]}),l.jsx(x,{variant:"success",onClick:async()=>{if(p){N(!0);try{await r({warningId:e.warningId,deliveryMethod:"whatsapp",deliveredAt:new Date,proofImage:p,phoneNumber:C.formattedPhone})}catch(t){s.error("Failed to complete delivery:",t)}finally{N(!1)}}},disabled:!p||j,size:"lg",className:"w-full",children:j?l.jsxs(l.Fragment,{children:[l.jsx(ce,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Delivery..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"Complete WhatsApp Delivery"]})})]})]}),w&&l.jsx(Xs,{isOpen:w,onClose:()=>k(!1),warningData:{employee:{firstName:e.employeeName.split(" ")[0]||e.employeeName,lastName:e.employeeName.split(" ").slice(1).join(" ")||"",employeeNumber:"EMP001",department:"N/A"},category:e.warningCategory,level:e.warningLevel,description:"Warning document details",incidentDate:new Date,issueDate:new Date},onDownload:()=>{m(!0)}})]})},ia=({notification:e,currentStep:t,onStepComplete:a,onDeliveryComplete:r,isProcessing:n})=>{const[i,o]=b.useState(!1),[c,m]=b.useState(!1),[h,u]=b.useState(!1),[p,y]=b.useState(null),[f,v]=b.useState(null),[j,N]=b.useState(!1),[w,k]=b.useState(!1),C=b.useCallback(()=>{const t=e.contactDetails.email||e.employeeEmail||"";return{subject:`Important: ${e.warningLevel} - ${e.warningCategory}`,body:`Dear ${e.employeeName},\n\nI hope this email finds you well. I am writing to formally notify you of a disciplinary matter that requires your immediate attention.\n\nSubject: ${e.warningLevel}\nCategory: ${e.warningCategory}\n\nPlease find attached the formal warning document that outlines the details of this matter. It is crucial that you review this document thoroughly and understand its contents.\n\nKey Points:\n• This is a formal disciplinary action\n• Please read the attached document carefully\n• You have the right to respond or appeal this decision\n• Further incidents may result in additional disciplinary action\n\nIf you have any questions or wish to discuss this matter, please do not hesitate to contact me or schedule a meeting with HR.\n\nPlease confirm receipt of this email and the attached document by replying to this message.\n\nThank you for your attention to this matter.\n\nBest regards,\n${e.createdByName||"HR Department"}\nHuman Resources Department`,to:t}},[e])();return l.jsxs("div",{className:"space-y-6",children:[0===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(Ce,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Prepare Email"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Copy the professional email template and download the PDF attachment"})]})]}),l.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(ie,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Employee Email:"})]}),l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:C.to||l.jsxs("span",{className:"text-red-500 text-sm",children:[l.jsx(K,{className:"w-4 h-4 inline mr-1"}),"No email address on file"]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Subject:"}),l.jsx("div",{className:"relative",children:l.jsx("input",{value:C.subject,readOnly:!0,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm font-medium",style:{color:"var(--color-text)"}})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Message Template:"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{value:C.body,readOnly:!0,className:"w-full h-64 p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm resize-none",style:{color:"var(--color-text)"}}),l.jsxs("div",{className:"absolute top-2 right-2 space-x-2",children:[l.jsx(x,{variant:i?"success":"primary",size:"sm",onClick:async()=>{try{const e=`To: ${C.to}\nSubject: ${C.subject}\n\n${C.body}`;await navigator.clipboard.writeText(e),o(!0),setTimeout(()=>o(!1),3e3)}catch(e){s.error("Failed to copy template:",e)}},children:i?l.jsxs(l.Fragment,{children:[l.jsx(pe,{className:"w-4 h-4 mr-1"}),"Copied!"]}):l.jsxs(l.Fragment,{children:[l.jsx(ee,{className:"w-4 h-4 mr-1"}),"Copy Full Email"]})}),l.jsxs(x,{variant:"secondary",size:"sm",onClick:async()=>{try{await navigator.clipboard.writeText(C.body),o(!0),setTimeout(()=>o(!1),3e3)}catch(e){s.error("Failed to copy email body:",e)}},children:[l.jsx(ee,{className:"w-4 h-4 mr-1"}),"Body Only"]})]})]})]}),l.jsxs("div",{className:"mb-6 space-y-3",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(x,{variant:"secondary",onClick:()=>{k(!0)},className:"flex items-center gap-2",children:[l.jsx(te,{className:"w-4 h-4"}),"Preview & Download PDF"]}),c&&l.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[l.jsx(Z,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"PDF Downloaded"})]})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"Use the preview to download the PDF, then attach it to your email"})]}),l.jsxs("div",{className:"space-y-2 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm "+(i?"text-green-600":"text-gray-500"),children:[i?l.jsx(Z,{className:"w-4 h-4"}):l.jsx(re,{className:"w-4 h-4"}),"Email template copied to clipboard"]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm "+(c?"text-green-600":"text-gray-500"),children:[c?l.jsx(Z,{className:"w-4 h-4"}):l.jsx(re,{className:"w-4 h-4"}),"PDF downloaded for attachment"]})]}),l.jsx(x,{variant:"primary",onClick:()=>{i&&c&&a(0)},disabled:!i||!c,className:"w-full",children:i&&c?l.jsxs(l.Fragment,{children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"Continue to Send Email"]}):l.jsxs(l.Fragment,{children:[l.jsx(re,{className:"w-4 h-4 mr-2"}),"Complete preparation steps above"]})})]}),1===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-green-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(Se,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Send Email"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Open your email client and send the message with PDF attachment"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(g,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Instructions:"}),l.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[l.jsx("li",{children:'Click "Open Email Client" below'}),l.jsx("li",{children:"Your default email application will open with pre-filled content"}),l.jsx("li",{children:"Attach the downloaded PDF file"}),l.jsx("li",{children:"Review the email content and recipient"}),l.jsx("li",{children:"Send the email"}),l.jsx("li",{children:"Wait for delivery confirmation if available"})]})]})}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"font-medium text-gray-700",children:"To:"}),l.jsx("span",{className:"text-gray-900",children:C.to})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("span",{className:"font-medium text-gray-700",children:"Subject:"}),l.jsx("span",{className:"text-gray-900",children:C.subject})]})]}),l.jsxs(x,{variant:"primary",onClick:()=>{const e=encodeURIComponent(C.subject),t=encodeURIComponent(C.body),s=`mailto:${encodeURIComponent(C.to)}?subject=${e}&body=${t}`;window.location.href=s,u(!0)},disabled:!C.to,size:"lg",className:"w-full",children:[l.jsx(Ne,{className:"w-5 h-5 mr-2"}),"Open Email Client"]}),h&&l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm mb-4",children:[l.jsx(Z,{className:"w-4 h-4"}),"Email client opened"]}),l.jsxs(x,{variant:"primary",onClick:()=>{h&&a(1)},className:"w-full",children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"I've sent the email"]})]})]})]}),2===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-purple-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:l.jsx(we,{className:"w-5 h-5 text-purple-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: Confirm Delivery"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Upload screenshot proof of successful email delivery"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(g,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Screenshot Requirements:"}),l.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[l.jsx("li",{children:'Show the sent email in your "Sent" folder'}),l.jsx("li",{children:"Display recipient email address clearly"}),l.jsx("li",{children:"Include timestamp/date sent"}),l.jsx("li",{children:"Show PDF attachment in the email"}),l.jsx("li",{children:"Capture any delivery confirmation if available"})]})]})}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[l.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){y(t);const e=new FileReader;e.onload=e=>{v(e.target?.result)},e.readAsDataURL(t)}},className:"hidden",id:"proof-upload"}),l.jsx("label",{htmlFor:"proof-upload",className:"cursor-pointer",children:f?l.jsxs("div",{className:"space-y-3",children:[l.jsx("img",{src:f,alt:"Delivery proof",className:"max-w-full max-h-64 mx-auto rounded-lg shadow-sm"}),l.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[l.jsx(Z,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Screenshot uploaded"})]})]}):l.jsxs("div",{className:"space-y-3",children:[l.jsx(ke,{className:"w-12 h-12 mx-auto text-gray-400"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-medium text-gray-700",children:"Upload Screenshot"}),l.jsx("div",{className:"text-sm text-gray-500",children:"Click to select image file"})]})]})})]}),l.jsx(x,{variant:"success",onClick:async()=>{if(p){N(!0);try{await r({warningId:e.warningId,deliveryMethod:"email",deliveredAt:new Date,proofImage:p,emailAddress:C.to})}catch(t){s.error("Failed to complete delivery:",t)}finally{N(!1)}}},disabled:!p||j,size:"lg",className:"w-full",children:j?l.jsxs(l.Fragment,{children:[l.jsx(ce,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Delivery..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"Complete Email Delivery"]})})]})]}),w&&l.jsx(Xs,{isOpen:w,onClose:()=>k(!1),warningData:{employee:{firstName:e.employeeName.split(" ")[0]||e.employeeName,lastName:e.employeeName.split(" ").slice(1).join(" ")||"",employeeNumber:"EMP001",department:"N/A"},category:e.warningCategory,level:e.warningLevel,description:"Warning document details",incidentDate:new Date,issueDate:new Date},onDownload:()=>{m(!0)}})]})},la=({notification:e,currentStep:t,onStepComplete:a,onDeliveryComplete:r,isProcessing:n})=>{const[i,o]=b.useState(!1),[c,m]=b.useState(!1),[h,u]=b.useState([{id:"hand_delivered",label:"Hand delivered to employee",completed:!1,required:!0,description:"Personally delivered the printed warning to the employee"},{id:"employee_present",label:"Employee was present during delivery",completed:!1,required:!0,description:"Confirmed employee identity and presence during delivery"},{id:"signature_obtained",label:"Employee signature obtained",completed:!1,required:!0,description:"Employee signed acknowledgment of receipt on physical document"},{id:"copy_filed",label:"Signed copy filed in employee records",completed:!1,required:!0,description:"Filed the signed physical copy in the employee's personnel file"}]),[p,y]=b.useState([{id:"original_filed",label:"Original signed document filed",completed:!1,required:!0,description:"Original signed warning document placed in employee's personnel file"},{id:"copy_retained",label:"Copy retained by HR",completed:!1,required:!0,description:"Photocopy of signed document retained in HR files"},{id:"system_updated",label:"Digital system updated",completed:!1,required:!0,description:"Employee record system updated to reflect warning delivery"}]),[f,v]=b.useState({deliveryDate:(new Date).toISOString().split("T")[0],deliveryTime:(new Date).toTimeString().split(" ")[0].slice(0,5),deliveryLocation:"",witnessName:"",additionalNotes:""}),j=b.useCallback(()=>{if(e.pdfUrl){const t=window.open(e.pdfUrl,"_blank");t&&(t.onload=()=>{t.print(),o(!0)})}else m(!0)},[e.pdfUrl]),N=(e,t)=>{"delivery"===e?u(e=>e.map(e=>e.id===t?{...e,completed:!e.completed}:e)):y(e=>e.map(e=>e.id===t?{...e,completed:!e.completed}:e))},w=h.filter(e=>e.required).every(e=>e.completed),k=p.filter(e=>e.required).every(e=>e.completed);return l.jsxs("div",{className:"space-y-6",children:[0===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-purple-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:l.jsx(De,{className:"w-5 h-5 text-purple-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 1: Print Warning Document"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Print the official warning document for hand delivery"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(g,{variant:"info",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Printing Requirements:"}),l.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[l.jsx("li",{children:"Print on official company letterhead if available"}),l.jsx("li",{children:"Use high-quality paper (minimum 80gsm)"}),l.jsx("li",{children:"Ensure all text is clearly legible"}),l.jsx("li",{children:"Print multiple copies (original + HR copy)"})]})]})}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(ie,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Employee:"}),l.jsx("span",{children:e.employeeName})]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(de,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Warning Type:"}),l.jsx("span",{children:e.warningLevel})]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(le,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Issue Date:"}),l.jsx("span",{children:e.createdAt.toLocaleDateString()})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(x,{variant:"secondary",onClick:()=>{m(!0)},className:"flex items-center gap-2",children:[l.jsx(te,{className:"w-4 h-4"}),"Preview Document"]}),l.jsxs(x,{variant:"primary",onClick:j,className:"flex items-center gap-2",children:[l.jsx(De,{className:"w-4 h-4"}),"Print Document"]})]}),i&&l.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[l.jsx(Z,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Document printed successfully"})]})]}),l.jsx(x,{variant:"primary",onClick:()=>{i&&a(0)},disabled:!i,className:"w-full",children:i?l.jsxs(l.Fragment,{children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"Continue to Hand Delivery"]}):l.jsxs(l.Fragment,{children:[l.jsx(re,{className:"w-4 h-4 mr-2"}),"Print document to continue"]})})]})]}),1===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-green-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(ie,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 2: Hand Delivery to Employee"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Deliver the printed document and obtain employee acknowledgment"})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Date"}),l.jsx("input",{type:"date",value:f.deliveryDate,onChange:e=>v(t=>({...t,deliveryDate:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Time"}),l.jsx("input",{type:"time",value:f.deliveryTime,onChange:e=>v(t=>({...t,deliveryTime:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Location"}),l.jsx("input",{type:"text",placeholder:"e.g., Employee's office, HR meeting room",value:f.deliveryLocation,onChange:e=>v(t=>({...t,deliveryLocation:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Witness Name (Optional)"}),l.jsx("input",{type:"text",placeholder:"Name of witness present during delivery",value:f.witnessName,onChange:e=>v(t=>({...t,witnessName:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]})]}),l.jsxs("div",{children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(Z,{className:"w-5 h-5 text-green-600"}),"Delivery Checklist"]}),l.jsx("div",{className:"space-y-3",children:h.map(e=>l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>N("delivery",e.id),className:"mt-1 w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"font-medium "+(e.completed?"text-green-600":"text-gray-900"),children:[e.label,e.required&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsx("div",{className:"text-sm text-gray-600",children:e.description})]}),e.completed&&l.jsx(Z,{className:"w-5 h-5 text-green-600 mt-1"})]},e.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),l.jsx("textarea",{rows:3,placeholder:"Any additional notes about the delivery process...",value:f.additionalNotes,onChange:e=>v(t=>({...t,additionalNotes:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),l.jsx(x,{variant:"primary",onClick:()=>{w&&a(1)},disabled:!w,className:"w-full",children:w?l.jsxs(l.Fragment,{children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"Continue to Filing"]}):l.jsxs(l.Fragment,{children:[l.jsx(re,{className:"w-4 h-4 mr-2"}),"Complete all required items above"]})})]})]}),2===t&&l.jsxs(d,{padding:"lg",className:"border-l-4 border-l-blue-500",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(Te,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--color-text)"},children:"Step 3: File Documentation"}),l.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"File the signed documents and complete the delivery process"})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(g,{variant:"warning",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Important:"})," Proper filing is crucial for legal compliance and audit purposes. Ensure all documents are filed in the correct employee personnel file."]})}),l.jsxs("div",{children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(Te,{className:"w-5 h-5 text-blue-600"}),"Filing Checklist"]}),l.jsx("div",{className:"space-y-3",children:p.map(e=>l.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx("input",{type:"checkbox",checked:e.completed,onChange:()=>N("filing",e.id),className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"font-medium "+(e.completed?"text-blue-600":"text-gray-900"),children:[e.label,e.required&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsx("div",{className:"text-sm text-gray-600",children:e.description})]}),e.completed&&l.jsx(Z,{className:"w-5 h-5 text-blue-600 mt-1"})]},e.id))})]}),l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("h5",{className:"font-semibold text-blue-900 mb-2",children:"Delivery Summary"}),l.jsxs("div",{className:"space-y-1 text-sm text-blue-800",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Employee:"})," ",e.employeeName]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Warning Type:"})," ",e.warningLevel]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Delivery Date:"})," ",f.deliveryDate," at ",f.deliveryTime]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Location:"})," ",f.deliveryLocation||"Not specified"]}),f.witnessName&&l.jsxs("div",{children:[l.jsx("strong",{children:"Witness:"})," ",f.witnessName]})]})]}),l.jsx(x,{variant:"success",onClick:async()=>{if(k)try{await r({warningId:e.warningId,deliveryMethod:"printed",deliveredAt:new Date(`${f.deliveryDate}T${f.deliveryTime}`),deliveryLocation:f.deliveryLocation,witnessName:f.witnessName,additionalNotes:f.additionalNotes,deliveryChecklist:h,filingChecklist:p})}catch(t){s.error("Failed to complete delivery:",t)}},disabled:!k||n,size:"lg",className:"w-full",children:n?l.jsxs(l.Fragment,{children:[l.jsx(ce,{className:"w-4 h-4 mr-2 animate-spin"}),"Completing Process..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Z,{className:"w-4 h-4 mr-2"}),"Complete Print Delivery Process"]})})]})]}),c&&l.jsx(Xs,{isOpen:c,onClose:()=>m(!1),warningData:{employee:{firstName:e.employeeName.split(" ")[0]||e.employeeName,lastName:e.employeeName.split(" ").slice(1).join(" ")||"",employeeNumber:"EMP001",department:"N/A"},category:e.warningCategory,level:e.warningLevel,description:"Warning document details",incidentDate:new Date,issueDate:new Date},onDownload:()=>{o(!0)},showPrintButton:!0})]})},oa=({notification:e,onDeliveryComplete:t,onClose:s,isOpen:a})=>{const[r,n]=b.useState(0),[i,o]=b.useState([]),[c,d]=b.useState(!1),[m,h]=b.useState(null);b.useEffect(()=>{o((()=>{switch(e.deliveryMethod){case"whatsapp":return[{id:"prepare",label:"Prepare Message",completed:!1,inProgress:!0,description:"Copy pre-written script and download PDF"},{id:"send",label:"Send via WhatsApp",completed:!1,inProgress:!1,description:"Open WhatsApp and send message with attachment"},{id:"confirm",label:"Confirm Delivery",completed:!1,inProgress:!1,description:"Upload screenshot proof and complete delivery"}];case"email":return[{id:"prepare",label:"Prepare Email",completed:!1,inProgress:!0,description:"Copy email template and download PDF attachment"},{id:"send",label:"Send Email",completed:!1,inProgress:!1,description:"Open email client and send message"},{id:"confirm",label:"Confirm Delivery",completed:!1,inProgress:!1,description:"Upload screenshot proof and complete delivery"}];case"printed":return[{id:"print",label:"Print Document",completed:!1,inProgress:!0,description:"Print warning PDF document"},{id:"deliver",label:"Hand Deliver",completed:!1,inProgress:!1,description:"Deliver to employee and obtain signature"},{id:"file",label:"File Documentation",completed:!1,inProgress:!1,description:"File signed copy and confirm completion"}];default:return[]}})())},[e.deliveryMethod]);const u=(()=>{switch(e.deliveryMethod){case"whatsapp":return{icon:be,name:"WhatsApp Business",color:"green",bgClass:"bg-green-50 border-green-200",textClass:"text-green-700"};case"email":return{icon:Ce,name:"Email",color:"blue",bgClass:"bg-blue-50 border-blue-200",textClass:"text-blue-700"};case"printed":return{icon:De,name:"Print & Hand Delivery",color:"purple",bgClass:"bg-purple-50 border-purple-200",textClass:"text-purple-700"};default:return{icon:de,name:"Unknown",color:"gray",bgClass:"bg-gray-50 border-gray-200",textClass:"text-gray-700"}}})(),y=e=>{o(t=>t.map((t,s)=>s===e?{...t,completed:!0,inProgress:!1}:s===e+1?{...t,inProgress:!0}:t)),e<i.length-1&&n(e+1)},f=async a=>{d(!0);try{await t(e.id,{...a,deliveryMethod:e.deliveryMethod,completedAt:new Date,steps:i}),s()}catch(r){h("Failed to complete delivery. Please try again.")}finally{d(!1)}};return a?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[95vh] flex flex-col shadow-2xl",children:[l.jsx("div",{className:`p-6 border-b flex-shrink-0 ${u.bgClass}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"p-3 rounded-xl bg-white shadow-sm",children:l.jsx(u.icon,{className:`w-6 h-6 ${u.textClass}`})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-bold",style:{color:"var(--color-text)"},children:[u.name," Delivery"]}),l.jsxs("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:["Guided delivery workflow for ",e.employeeName]})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(p,{variant:e.priority,size:"sm",children:e.priority.toUpperCase()}),l.jsx(x,{variant:"ghost",size:"sm",onClick:s,children:l.jsx(G,{className:"w-4 h-4"})})]})]})}),l.jsxs("div",{className:"p-4 bg-gray-50 border-b flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ie,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-semibold text-gray-900",children:e.employeeName})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ae,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-600",children:e.warningLevel})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(de,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-600",children:e.warningCategory})]})]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[l.jsx(le,{className:"w-4 h-4"}),e.createdAt.toLocaleDateString()]})]}),(e.contactDetails.email||e.contactDetails.phone)&&l.jsxs("div",{className:"mt-3 flex items-center gap-4",children:[e.contactDetails.email&&l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(Ce,{className:"w-4 h-4 text-gray-400"}),l.jsx("span",{className:"text-gray-600",children:e.contactDetails.email})]}),e.contactDetails.phone&&l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(je,{className:"w-4 h-4 text-gray-400"}),l.jsx("span",{className:"text-gray-600",children:e.contactDetails.phone})]})]})]}),l.jsx("div",{className:"p-6 border-b bg-white flex-shrink-0",children:l.jsx("div",{className:"flex items-center justify-between",children:i.map((e,t)=>l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`\n                    w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium transition-all\n                    ${e.completed?"bg-green-500 text-white":e.inProgress?"bg-blue-500 text-white animate-pulse":"bg-gray-200 text-gray-500"}\n                  `,children:e.completed?l.jsx(Z,{className:"w-5 h-5"}):e.inProgress?l.jsx(re,{className:"w-5 h-5"}):t+1}),l.jsxs("div",{className:"mt-2 text-center",children:[l.jsx("div",{className:"text-sm font-medium "+(e.completed||e.inProgress?"text-gray-900":"text-gray-500"),children:e.label}),l.jsx("div",{className:"text-xs text-gray-500 mt-1 max-w-32",children:e.description})]})]}),t<i.length-1&&l.jsx(Ee,{className:"w-5 h-5 mx-4 "+(e.completed?"text-green-500":"text-gray-300")})]},e.id))})}),m&&l.jsx("div",{className:"p-4 flex-shrink-0",children:l.jsx(g,{variant:"error",children:m})}),l.jsxs("div",{className:"p-6 flex-1 overflow-y-auto min-h-0",children:["whatsapp"===e.deliveryMethod&&l.jsx(na,{notification:e,currentStep:r,onStepComplete:y,onDeliveryComplete:f,isProcessing:c}),"email"===e.deliveryMethod&&l.jsx(ia,{notification:e,currentStep:r,onStepComplete:y,onDeliveryComplete:f,isProcessing:c}),"printed"===e.deliveryMethod&&l.jsx(la,{notification:e,currentStep:r,onStepComplete:y,onDeliveryComplete:f,isProcessing:c})]}),l.jsxs("div",{className:"p-4 border-t bg-gray-50 flex items-center justify-between flex-shrink-0",children:[l.jsxs("div",{className:"text-sm text-gray-500",children:["Step ",r+1," of ",i.length]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(x,{variant:"ghost",size:"sm",onClick:s,children:"Cancel"}),c&&l.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[l.jsx(Y,{className:"w-4 h-4 animate-spin"}),"Processing..."]})]})]})]})}):null},ca=b.memo(({className:n=""})=>{const i=N(),{user:o}=e(),{organization:m,categories:h}=c(),u=(e=>{const[t,s]=b.useState(window.innerWidth>e),a=b.useCallback(()=>s(window.innerWidth>e),[e]);return b.useEffect(()=>(window.addEventListener("resize",a),a(),()=>window.removeEventListener("resize",a)),[a]),t})(768),[p,j]=b.useState(null),{employees:D,warnings:T,error:E,refreshData:I}=y({role:"hr"}),{hrReportsCount:P,hrCountsLoading:A,hrCountsError:R}=(()=>{const{user:r}=e(),{canManageHR:n}=t(),[i,l]=b.useState({absenceReports:{unread:0,total:0},hrMeetings:{unread:0,total:0},correctiveCounselling:{unread:0,total:0}}),[o,c]=b.useState(!0),[d,m]=b.useState(null),[x,h]=b.useState(null),u=b.useRef([]),g=b.useRef(!0),p=b.useRef(!1),y=b.useCallback(async()=>{r?.organizationId&&n()&&(m(null),h(new Date))},[r?.organizationId,n]);return b.useEffect(()=>{if(!p.current){if(g.current=!0,!n()||!r?.organizationId)return c(!1),void(p.current=!0);c(!0),m(null),u.current.forEach(e=>{try{e()}catch(t){s.warn("⚠️ Error unsubscribing:",t)}}),u.current=[];try{const e=w(k(a,`organizations/${r.organizationId}/reports`),C("absenceDate","desc")),t=S(e,e=>{if(!g.current)return;const t=e.docs.filter(e=>"_metadata"!==e.id).map(e=>({id:e.id,...e.data()})),s=t.filter(e=>!e.hrReviewed).length;l(e=>({...e,absenceReports:{unread:s,total:t.length}})),h(new Date),t.length},e=>{s.error("❌ Absence reports listener error:",e),g.current&&m("Failed to load absence reports")});u.current.push(t);const n=w(k(a,`organizations/${r.organizationId}/meetings`),C("createdAt","desc")),i=S(n,e=>{if(!g.current)return;const t=e.docs.filter(e=>"_metadata"!==e.id).map(e=>({id:e.id,...e.data()})),s=t.filter(e=>"pending"===e.status).length;l(e=>({...e,hrMeetings:{unread:s,total:t.length}})),h(new Date),t.length},e=>{s.error("❌ HR meetings listener error:",e),g.current&&m("Failed to load HR meetings")});u.current.push(i);const o=w(k(a,`organizations/${r.organizationId}/corrective_counselling`),C("dateCreated","desc")),d=S(o,e=>{if(!g.current)return;const t=e.docs.filter(e=>"_metadata"!==e.id).map(e=>({id:e.id,...e.data()})),s=t.filter(e=>new Date(e.dateCreated)>new Date(Date.now()-6048e5)&&!e.hrReviewed).length;l(e=>({...e,correctiveCounselling:{unread:s,total:t.length}})),h(new Date),t.length},e=>{s.error("❌ Corrective counselling listener error:",e),g.current&&m("Failed to load counselling records")});u.current.push(d),setTimeout(()=>{g.current&&c(!1)},1e3)}catch(e){s.error("❌ Error setting up listeners:",e),m("Failed to initialize real-time data"),c(!1)}return p.current=!0,()=>{g.current=!1,u.current.forEach(t=>{try{t()}catch(e){s.warn("⚠️ Error during cleanup:",e)}}),u.current=[],p.current=!1}}},[]),b.useEffect(()=>{n()&&r?.organizationId||(l({absenceReports:{unread:0,total:0},hrMeetings:{unread:0,total:0}}),c(!1),m(null),h(null),p.current=!1)},[n(),r?.organizationId]),{hrReportsCount:i,hrCountsLoading:o,hrCountsError:d,refreshHRCounts:y,lastUpdated:x}})(),[M,_]=b.useState(!1),[F,L]=b.useState(!1),[U,z]=b.useState(null),[O,W]=b.useState(!1),$=((e,t,a)=>{const[n,i]=b.useState(!0),[l,o]=b.useState(null),[c,d]=b.useState(null);b.useEffect(()=>{(async()=>{if(e&&t)try{i(!0);const n=await r.getDocument(t,"users",e);if(!n)return s.error("User document not found for countdown feature"),void i(!1);const l=n?.features?.historicalWarningEntry;if(l?.firstAccessedAt){const e=l.firstAccessedAt.toDate?l.firstAccessedAt.toDate():new Date(l.firstAccessedAt),t=l.expiresAt.toDate?l.expiresAt.toDate():new Date(l.expiresAt);o({firstAccessedAt:e,expiresAt:t}),Math.ceil((t.getTime()-Date.now())/864e5)}else if(a){const s=new Date,a=new Date(s.getTime()+5184e6),n={"features.historicalWarningEntry":{firstAccessedAt:s,expiresAt:a}};await r.updateDocument(t,"users",e,n),o({firstAccessedAt:s,expiresAt:a})}}catch(n){s.error("Failed to initialize historical warning countdown:",n)}finally{i(!1)}else i(!1)})()},[e,t,a]),b.useEffect(()=>{if(!l)return void d(null);const e=()=>{const e=Date.now(),t=l.expiresAt.getTime()-e,s=Math.floor(t/864e5);d(Math.max(0,s))};e();const t=setInterval(e,36e5);return()=>clearInterval(t)},[l]);const{level:m,text:x}=null!==c&&l?0===c?{level:"urgent",text:"Enter Historical Warning (Last day!)"}:1===c?{level:"urgent",text:"Enter Historical Warning (1 day left!)"}:c<=7?{level:"warning",text:`Enter Historical Warning (${c} days left - Hurry!)`}:c<=14?{level:"warning",text:`Enter Historical Warning (${c} days left)`}:{level:"normal",text:`Enter Historical Warning (${c} days left)`}:{level:"normal",text:"Enter Historical Warning"},h=null!==c&&c<=0;return{daysRemaining:c,isExpired:h,isActive:!h&&null!==l,loading:n,urgencyLevel:m,displayText:x}})(o?.uid,m?.id,"warnings"===p),q={totalActive:T?.length||0,undelivered:T?.filter(e=>!e.delivered&&"expired"!==e.status)?.length||0,highSeverity:T?.filter(e=>("high"===e.severity||"gross_misconduct"===e.category?.severity)&&"expired"!==e.status)?.length||0},B={totalEmployees:D?.length||0,activeEmployees:D?.filter(e=>!1!==e.isActive)?.length||0,newEmployees:D?.filter(e=>new Date(e.createdAt||e.metadata?.createdAt||0)>new Date(Date.now()-2592e6))?.length||0};return u?l.jsxs("div",{className:`${n}`,children:[l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-3 mb-6",children:[l.jsx(d,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/absence-reports"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-error), var(--color-error))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ie,{className:"w-8 h-8",style:{opacity:.7}}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Absence Reports"}),l.jsx("div",{className:"text-2xl font-bold",children:P.absenceReports.unread}),l.jsxs("div",{className:"text-xs mt-0.5",style:{opacity:.8},children:[P.absenceReports.total," total"]})]})]})}),l.jsx(d,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/meeting-requests"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-accent), var(--color-accent))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Pe,{className:"w-8 h-8",style:{opacity:.7}}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Meeting Requests"}),l.jsx("div",{className:"text-2xl font-bold",children:P.hrMeetings.unread}),l.jsxs("div",{className:"text-xs mt-0.5",style:{opacity:.8},children:[P.hrMeetings.total," total"]})]})]})}),l.jsx(d,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/corrective-counselling"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-primary), var(--color-primary))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ae,{className:"w-8 h-8",style:{opacity:.7}}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Counselling"}),l.jsx("div",{className:"text-2xl font-bold",children:P.correctiveCounselling.unread}),l.jsxs("div",{className:"text-xs mt-0.5",style:{opacity:.8},children:[P.correctiveCounselling.total," total"]})]})]})}),l.jsx(d,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>j("warnings"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-warning), var(--color-warning))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(ae,{className:"w-8 h-8",style:{opacity:.7}}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Active Warnings"}),l.jsx("div",{className:"text-2xl font-bold",children:q.totalActive}),l.jsxs("div",{className:"text-xs mt-0.5",style:{opacity:.8},children:[q.undelivered," undelivered"]})]})]})})]}),(E||R)&&l.jsx(g,{variant:"error",className:"mb-4",children:l.jsxs("div",{className:"text-sm",children:["Failed to load dashboard data: ",E||R]})}),l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"flex space-x-6 px-4",children:[{id:"urgent",label:"Urgent Tasks",icon:K,count:P.absenceReports.unread+P.hrMeetings.unread+q.undelivered},{id:"warnings",label:"Warnings",icon:ae},{id:"employees",label:"Employees",icon:Re}].map(e=>l.jsxs("button",{onClick:()=>j(e.id),className:"flex items-center gap-2 py-3 px-1 border-b-2 text-sm font-medium transition-colors relative "+(p===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[l.jsx(e.icon,{className:"w-4 h-4"}),e.label,e.count&&e.count>0&&l.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center ml-1",children:e.count})]},e.id))})}),l.jsxs("div",{className:"p-4",children:["urgent"===p&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-white rounded-lg border border-red-200 shadow-sm",children:[l.jsxs("div",{className:"p-4 border-b border-red-100 bg-red-50",children:[l.jsxs("h3",{className:"text-lg font-semibold text-red-900 flex items-center gap-2",children:[l.jsx(K,{className:"w-5 h-5"}),"Urgent Tasks Requiring Immediate Attention"]}),l.jsx("p",{className:"text-sm text-red-700 mt-1",children:"These items need your immediate review and action"})]}),l.jsxs("div",{className:"divide-y divide-gray-100",children:[P.absenceReports.unread>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>i("/hr/absence-reports"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[P.absenceReports.unread," Unread Absence Reports"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Employees reporting absences requiring approval"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full font-medium",children:[P.absenceReports.unread," pending"]}),l.jsx(Ie,{className:"w-4 h-4 text-gray-400"})]})]})}),P.hrMeetings.unread>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>i("/hr/meeting-requests"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[P.hrMeetings.unread," New Meeting Requests"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Employees requesting HR consultations"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full font-medium",children:[P.hrMeetings.unread," requests"]}),l.jsx(Pe,{className:"w-4 h-4 text-gray-400"})]})]})}),q.undelivered>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>j("warnings"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[q.undelivered," Undelivered Warnings"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Warning documents pending delivery to employees"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full font-medium",children:"Urgent"}),l.jsx(K,{className:"w-4 h-4 text-gray-400"})]})]})}),q.highSeverity>0&&l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>j("warnings"),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 bg-red-600 rounded-full"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-semibold text-gray-900",children:[q.highSeverity," High Priority Cases"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Final warnings and dismissal cases requiring oversight"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full font-medium",children:"Critical"}),l.jsx(K,{className:"w-4 h-4 text-gray-400"})]})]})}),0===P.absenceReports.unread&&0===P.hrMeetings.unread&&0===q.undelivered&&0===q.highSeverity&&l.jsxs("div",{className:"p-8 text-center text-gray-500",children:[l.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:l.jsx(ae,{className:"w-8 h-8 text-green-600"})}),l.jsx("div",{className:"font-medium text-gray-700",children:"All caught up!"}),l.jsx("div",{className:"text-sm",children:"No urgent tasks requiring immediate attention"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(re,{className:"w-4 h-4 text-gray-600"}),"Today's Activity"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"New Reports"}),l.jsx("span",{className:"font-medium text-gray-900",children:P.absenceReports.unread})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Meetings"}),l.jsx("span",{className:"font-medium text-gray-900",children:P.hrMeetings.unread})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Counselling"}),l.jsx("span",{className:"font-medium text-gray-900",children:P.correctiveCounselling.unread})]})]})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(Me,{className:"w-4 h-4 text-blue-600"}),"Team Status"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Total Employees"}),l.jsx("span",{className:"font-medium text-gray-900",children:B.totalEmployees})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Active"}),l.jsx("span",{className:"font-medium text-green-600",children:B.activeEmployees})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"New This Month"}),l.jsx("span",{className:"font-medium text-blue-600",children:B.newEmployees})]})]})]}),l.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[l.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l.jsx(ae,{className:"w-4 h-4 text-orange-600"}),"Warning Overview"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Active"}),l.jsx("span",{className:"font-medium text-gray-900",children:q.totalActive})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Undelivered"}),l.jsx("span",{className:"font-medium text-orange-600",children:q.undelivered})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"High Priority"}),l.jsx("span",{className:"font-medium text-red-600",children:q.highSeverity})]})]})]})]})]}),"warnings"===p&&l.jsxs("div",{className:"space-y-4",children:[!$.isExpired&&l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Warnings Management"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Digital and historical warning records"})]}),l.jsx(x,{variant:"outline",size:"md",icon:de,onClick:()=>_(!0),className:""+("urgent"===$.urgencyLevel?"border-red-500 text-red-700 hover:bg-red-50 font-semibold animate-pulse":"warning"===$.urgencyLevel?"border-orange-500 text-orange-700 hover:bg-orange-50 font-semibold":"border-amber-500 text-amber-700 hover:bg-amber-50"),children:$.loading?"Enter Historical Warning":$.displayText})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsx("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(K,{className:"w-8 h-8 text-orange-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:q.undelivered}),l.jsx("div",{className:"text-sm text-orange-700",children:"Undelivered Warnings"}),l.jsx("div",{className:"text-xs text-orange-600",children:"Require immediate attention"})]})]})}),l.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(ae,{className:"w-8 h-8 text-red-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:q.highSeverity}),l.jsx("div",{className:"text-sm text-red-700",children:"High Severity"}),l.jsx("div",{className:"text-xs text-red-600",children:"Final warnings & dismissals"})]})]})}),l.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(de,{className:"w-8 h-8 text-blue-600"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:q.totalActive}),l.jsx("div",{className:"text-sm text-blue-700",children:"Total Active"}),l.jsx("div",{className:"text-xs text-blue-600",children:"All current warnings"})]})]})})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200",children:l.jsx(H,{})})]}),"employees"===p&&l.jsx("div",{className:"space-y-4",children:l.jsx(f,{})})]})]}),M&&o&&m&&l.jsx(ra,{isOpen:M,onClose:()=>_(!1),onSuccess:()=>{_(!1),I()},employees:D||[],categories:h||[],currentUserId:o.uid,organizationId:m.id}),F&&m&&l.jsx(v,{isOpen:F,onClose:()=>L(!1),organizationId:m.id}),O&&U&&l.jsx(oa,{isOpen:O,notification:U,onDeliveryComplete:async(e,t)=>{try{W(!1),z(null),I()}catch(a){s.error("Failed to complete delivery:",a)}},onClose:()=>{W(!1),z(null)}})]}):l.jsxs("div",{className:`space-y-6 ${n}`,children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[l.jsx(d,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/absence-reports"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-error), var(--color-error))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex flex-col items-center gap-1.5 py-1",children:[l.jsx(Ie,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium text-xs text-center leading-tight",children:"Absence Reports"}),A?l.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current"}):l.jsx("span",{className:"text-lg font-bold",children:P.absenceReports.unread})]})}),l.jsx(d,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/meeting-requests"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-accent), var(--color-accent))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex flex-col items-center gap-1.5 py-1",children:[l.jsx(Pe,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium text-xs text-center leading-tight",children:"HR Meetings"}),A?l.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current"}):l.jsx("span",{className:"text-lg font-bold",children:P.hrMeetings.unread})]})}),l.jsx(d,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>i("/hr/corrective-counselling"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-primary), var(--color-primary))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex flex-col items-center gap-1.5 py-1",children:[l.jsx(Ae,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium text-xs text-center leading-tight",children:"Counselling"}),A?l.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current"}):l.jsx("span",{className:"text-lg font-bold",children:P.correctiveCounselling.unread})]})}),l.jsx(d,{padding:"sm",shadow:"lg",hover:!0,onClick:()=>j("warnings"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{background:"linear-gradient(135deg, var(--color-warning), var(--color-warning))",color:"var(--color-text-inverse)",minHeight:"80px",willChange:"transform"},children:l.jsxs("div",{className:"flex flex-col items-center gap-1.5 py-1",children:[l.jsx(ae,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium text-xs text-center leading-tight",children:"Active Warnings"}),l.jsx("span",{className:"text-lg font-bold",children:q.totalActive})]})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx(d,{padding:"md",shadow:"sm",hover:!0,onClick:()=>j("urgent"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{minHeight:"64px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(K,{className:"w-5 h-5",style:{color:"var(--color-error)"}}),l.jsx("span",{className:"font-semibold",style:{color:"var(--color-text)"},children:"Urgent Tasks"})]}),l.jsx(ge,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})]})}),l.jsx(d,{padding:"md",shadow:"sm",hover:!0,onClick:()=>j("warnings"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{minHeight:"64px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(ae,{className:"w-5 h-5",style:{color:"var(--color-warning)"}}),l.jsx("span",{className:"font-semibold",style:{color:"var(--color-text)"},children:"Warnings"})]}),l.jsx(ge,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})]})}),l.jsx(d,{padding:"md",shadow:"sm",hover:!0,onClick:()=>j("employees"),className:"cursor-pointer transition-all duration-200 active:scale-95",style:{minHeight:"64px",willChange:"transform"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Re,{className:"w-5 h-5",style:{color:"var(--color-success)"}}),l.jsx("span",{className:"font-semibold",style:{color:"var(--color-text)"},children:"Employees"})]}),l.jsx(ge,{className:"w-5 h-5",style:{color:"var(--color-text-secondary)"}})]})})]}),"urgent"===p&&l.jsx("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-50 p-4",style:{backgroundColor:"var(--color-overlay)"},children:l.jsxs(d,{padding:"none",className:"max-w-7xl w-full max-h-[90vh] overflow-hidden",shadow:"xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-4",style:{borderBottom:"1px solid var(--color-border)"},children:[l.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--color-text)"},children:"Urgent Tasks"}),l.jsx(x,{variant:"ghost",size:"sm",onClick:()=>j(null),children:"×"})]}),l.jsx("div",{className:"overflow-y-auto p-4",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx(d,{padding:"md",shadow:"sm",hover:!0,onClick:()=>i("/hr/absence-reports"),className:"cursor-pointer",style:{background:"linear-gradient(135deg, var(--color-error), var(--color-error))",color:"var(--color-text-inverse)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Absence Reports"}),l.jsx("div",{className:"text-2xl font-bold",children:P.absenceReports.unread})]}),l.jsx(Ie,{className:"w-8 h-8",style:{opacity:.7}})]})}),l.jsx(d,{padding:"md",shadow:"sm",hover:!0,onClick:()=>i("/hr/meeting-requests"),className:"cursor-pointer",style:{background:"linear-gradient(135deg, var(--color-accent), var(--color-accent))",color:"var(--color-text-inverse)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Meeting Requests"}),l.jsx("div",{className:"text-2xl font-bold",children:P.hrMeetings.unread})]}),l.jsx(Pe,{className:"w-8 h-8",style:{opacity:.7}})]})}),l.jsx(d,{padding:"md",shadow:"sm",hover:!0,onClick:()=>i("/hr/corrective-counselling"),className:"cursor-pointer",style:{background:"linear-gradient(135deg, var(--color-primary), var(--color-primary))",color:"var(--color-text-inverse)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm",style:{opacity:.8},children:"Counselling"}),l.jsx("div",{className:"text-2xl font-bold",children:P.correctiveCounselling.unread})]}),l.jsx(Ae,{className:"w-8 h-8",style:{opacity:.7}})]})})]})})]})}),"warnings"===p&&l.jsx("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-50 p-4",style:{backgroundColor:"var(--color-overlay)"},children:l.jsxs(d,{padding:"none",className:"max-w-7xl w-full max-h-[90vh] overflow-hidden",shadow:"xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-4",style:{borderBottom:"1px solid var(--color-border)"},children:[l.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--color-text)"},children:"Warnings Overview"}),l.jsx(x,{variant:"ghost",size:"sm",onClick:()=>j(null),children:"×"})]}),l.jsx("div",{className:"overflow-y-auto p-4",children:l.jsx(H,{})})]})}),"employees"===p&&l.jsx("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center z-50 p-4",style:{backgroundColor:"var(--color-overlay)"},children:l.jsxs(d,{padding:"none",className:"max-w-7xl w-full max-h-[90vh] overflow-hidden",shadow:"xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-4",style:{borderBottom:"1px solid var(--color-border)"},children:[l.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--color-text)"},children:"Employees"}),l.jsx(x,{variant:"ghost",size:"sm",onClick:()=>j(null),children:"×"})]}),l.jsx("div",{className:"overflow-y-auto",children:l.jsx(f,{})})]})})]})});ca.displayName="HRDashboardSection";export{ta as C,ca as H,Xs as P,Ks as i};
